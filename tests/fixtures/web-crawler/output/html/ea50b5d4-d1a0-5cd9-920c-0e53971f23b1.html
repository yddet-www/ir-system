<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-1 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-sticky-header-enabled vector-toc-not-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>MediaWiki:FileUploadWizard.js - Wikipedia</title>
<script>(function(){var className="client-js vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-1 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-sticky-header-enabled vector-toc-not-available";var cookie=document.cookie.match(/(?:^|; )enwikimwclientpreferences=([^;]+)/);if(cookie){cookie[1].split('%2C').forEach(function(pref){className=className.replace(new RegExp('(^| )'+pref.replace(/-clientpref-\w+$|[^\w-]+/g,'')+'-clientpref-\\w+( |$)'),'$1'+pref+'$2');});}document.documentElement.className=className;}());RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"cf59c26c-7b63-4520-9ab4-305b19fa09c1","wgCanonicalNamespace":"MediaWiki","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":8,"wgPageName":"MediaWiki:FileUploadWizard.js","wgTitle":"FileUploadWizard.js","wgCurRevisionId":1237294272,"wgRevisionId":1237294272,"wgArticleId":34401692,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageViewLanguage":"en","wgPageContentLanguage":"en","wgPageContentModel":"javascript","wgRelevantPageName":"MediaWiki:FileUploadWizard.js","wgRelevantArticleId":34401692,"wgTempUserName":null,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgNoticeProject":"wikipedia","wgFlaggedRevsParams":{"tags":{"status":{"levels":1}}},"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgPopupsFlags":0,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":true,"watchlist":true,"tagline":false,"nearby":true},"wgWMESchemaEditAttemptStepOversample":false,"wgWMEPageLength":100000,"wgEditSubmitButtonLabelPublish":true,"wgULSPosition":"interlanguage","wgULSisCompactLinksEnabled":false,"wgVector2022LanguageInHeader":true,"wgULSisLanguageSelectorEmpty":false,"wgCheckUserClientHintsHeadersJsApi":["brands","architecture","bitness","fullVersionList","mobile","model","platform","platformVersion"],"GEHomepageSuggestedEditsEnableTopics":true,"wgGESuggestedEditsTaskTypes":{"taskTypes":["copyedit","link-recommendation"],"unavailableTaskTypes":[]},"wgGETopicsMatchModeEnabled":false,"wgGELevelingUpEnabledForUser":false,"wgGEUseMetricsPlatformExtension":true,"wgMetricsPlatformUserExperiments":{"active_experiments":[],"overrides":[],"enrolled":[],"assigned":[],"subject_ids":[],"sampling_units":[],"coordinator":[]}};
RLSTATE={"ext.globalCssJs.user.styles":"ready","site.styles":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","user":"ready","user.options":"loading","ext.wikimediamessages.styles":"ready","mediawiki.action.styles":"ready","ext.pygments":"ready","skins.vector.search.codex.styles":"ready","skins.vector.styles":"ready","skins.vector.icons":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready"};RLPAGEMODULES=["ext.pygments.view","site","mediawiki.page.ready","skins.vector.js","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.gadget.ReferenceTooltips","ext.gadget.switcher","ext.urlShortener.toolbar","ext.centralauth.centralautologin","mmv.bootstrap","ext.popups","ext.visualEditor.desktopArticleTarget.init","ext.echo.centralauth","ext.eventLogging","ext.wikimediaEvents","ext.navigationTiming","ext.uls.interface","ext.cx.eventlogging.campaigns","wikibase.databox.fromWikidata","ext.checkUser.clientHints","ext.xLab"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.impl(function(){return["user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
}];});});</script>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.pygments%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cext.wikimediamessages.styles%7Cmediawiki.action.styles%7Cskins.vector.icons%2Cstyles%7Cskins.vector.search.codex.styles&amp;only=styles&amp;skin=vector-2022">
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector-2022"></script>
<meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector-2022">
<meta name="generator" content="MediaWiki 1.46.0-wmf.5">
<meta name="referrer" content="origin">
<meta name="referrer" content="origin-when-cross-origin">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=1120">
<meta property="og:title" content="MediaWiki:FileUploadWizard.js - Wikipedia">
<meta property="og:type" content="website">
<link rel="preconnect" href="//upload.wikimedia.org">
<link rel="apple-touch-icon" href="/static/apple-touch/wikipedia.png">
<link rel="icon" href="/static/favicon/wikipedia.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/w/rest.php/v1/search" title="Wikipedia (en)">
<link rel="EditURI" type="application/rsd+xml" href="//en.wikipedia.org/w/api.php?action=rsd">
<link rel="canonical" href="https://en.wikipedia.org/wiki/MediaWiki:FileUploadWizard.js">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">
<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="dns-prefetch" href="//meta.wikimedia.org" />
<link rel="dns-prefetch" href="auth.wikimedia.org">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-8 ns-subject page-MediaWiki_FileUploadWizard_js rootpage-MediaWiki_FileUploadWizard_js skin-vector-2022 action-view">
<div id="mw-aria-live-region" class="mw-aria-live-region" aria-live="polite"></div><a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	<header class="vector-header mw-header no-font-mode-scale">
		<div class="vector-header-start">
			<nav class="vector-main-menu-landmark" aria-label="Site">
				
<div id="vector-main-menu-dropdown" class="vector-dropdown vector-main-menu-dropdown vector-button-flush-left vector-button-flush-right"  title="Main menu" >
	<input type="checkbox" id="vector-main-menu-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-main-menu-dropdown" class="vector-dropdown-checkbox "  aria-label="Main menu"  >
	<label id="vector-main-menu-dropdown-label" for="vector-main-menu-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-menu mw-ui-icon-wikimedia-menu"></span>

<span class="vector-dropdown-label-text">Main menu</span>
	</label>
	<div class="vector-dropdown-content">


				<div id="vector-main-menu-unpinned-container" class="vector-unpinned-container">
		
<div id="vector-main-menu" class="vector-main-menu vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-main-menu-pinnable-header vector-pinnable-header-unpinned"
	data-feature-name="main-menu-pinned"
	data-pinnable-element-id="vector-main-menu"
	data-pinned-container-id="vector-main-menu-pinned-container"
	data-unpinned-container-id="vector-main-menu-unpinned-container"
>
	<div class="vector-pinnable-header-label">Main menu</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-main-menu.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-main-menu.unpin">hide</button>
</div>

	
<div id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation"  >
	<div class="vector-menu-heading">
		Navigation
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-mainpage-description" class="mw-list-item"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li><li id="n-contents" class="mw-list-item"><a href="/wiki/Wikipedia:Contents" title="Guides to browsing Wikipedia"><span>Contents</span></a></li><li id="n-currentevents" class="mw-list-item"><a href="/wiki/Portal:Current_events" title="Articles related to current events"><span>Current events</span></a></li><li id="n-randompage" class="mw-list-item"><a href="/wiki/Special:Random" title="Visit a randomly selected article [x]" accesskey="x"><span>Random article</span></a></li><li id="n-aboutsite" class="mw-list-item"><a href="/wiki/Wikipedia:About" title="Learn about Wikipedia and how it works"><span>About Wikipedia</span></a></li><li id="n-contactpage" class="mw-list-item"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia"><span>Contact us</span></a></li>
		</ul>
		
	</div>
</div>

	
<div id="p-interaction" class="vector-menu mw-portlet mw-portlet-interaction"  >
	<div class="vector-menu-heading">
		Contribute
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-help" class="mw-list-item"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia"><span>Help</span></a></li><li id="n-introduction" class="mw-list-item"><a href="/wiki/Help:Introduction" title="Learn how to edit Wikipedia"><span>Learn to edit</span></a></li><li id="n-portal" class="mw-list-item"><a href="/wiki/Wikipedia:Community_portal" title="The hub for editors"><span>Community portal</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" title="A list of recent changes to Wikipedia [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-upload" class="mw-list-item"><a href="/wiki/Wikipedia:File_upload_wizard" title="Add images or other media for use on Wikipedia"><span>Upload file</span></a></li><li id="n-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages"><span>Special pages</span></a></li>
		</ul>
		
	</div>
</div>

</div>

				</div>

	</div>
</div>

		</nav>
			
<a href="/wiki/Main_Page" class="mw-logo">
	<img class="mw-logo-icon" src="/static/images/icons/wikipedia.png" alt="" aria-hidden="true" height="50" width="50">
	<span class="mw-logo-container skin-invert">
		<img class="mw-logo-wordmark" alt="Wikipedia" src="/static/images/mobile/copyright/wikipedia-wordmark-en.svg" style="width: 7.5em; height: 1.125em;">
		<img class="mw-logo-tagline" alt="The Free Encyclopedia" src="/static/images/mobile/copyright/wikipedia-tagline-en.svg" width="117" height="13" style="width: 7.3125em; height: 0.8125em;">
	</span>
</a>

		</div>
		<div class="vector-header-end">
			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-collapses vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<a href="/wiki/Special:Search" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only search-toggle" title="Search Wikipedia [f]" accesskey="f"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
	</a>
	<div class="vector-typeahead-search-container">
		<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail cdx-typeahead-search--auto-expand-width">
			<form action="/w/index.php" id="searchform" class="cdx-search-input cdx-search-input--has-end-button">
				<div id="simpleSearch" class="cdx-search-input__input-wrapper"  data-search-loc="header-moved">
					<div class="cdx-text-input cdx-text-input--has-start-icon">
						<input
							class="cdx-text-input__input mw-searchInput" autocomplete="off"
							 type="search" name="search" placeholder="Search Wikipedia" aria-label="Search Wikipedia" autocapitalize="sentences" spellcheck="false" title="Search Wikipedia [f]" accesskey="f" id="searchInput"
							>
						<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
					</div>
					<input type="hidden" name="title" value="Special:Search">
				</div>
				<button class="cdx-button cdx-search-input__end-button">Search</button>
			</form>
		</div>
	</div>
</div>

			<nav class="vector-user-links vector-user-links-wide" aria-label="Personal tools">
	<div class="vector-user-links-main">
	
<div id="p-vector-user-menu-preferences" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-userpage" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	<nav class="vector-appearance-landmark" aria-label="Appearance">
		
<div id="vector-appearance-dropdown" class="vector-dropdown "  title="Change the appearance of the page&#039;s font size, width, and color" >
	<input type="checkbox" id="vector-appearance-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-appearance-dropdown" class="vector-dropdown-checkbox "  aria-label="Appearance"  >
	<label id="vector-appearance-dropdown-label" for="vector-appearance-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-appearance mw-ui-icon-wikimedia-appearance"></span>

<span class="vector-dropdown-label-text">Appearance</span>
	</label>
	<div class="vector-dropdown-content">


			<div id="vector-appearance-unpinned-container" class="vector-unpinned-container">
				
			</div>
		
	</div>
</div>

	</nav>
	
<div id="p-vector-user-menu-notifications" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-overflow" class="vector-menu mw-portlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			<li id="pt-sitesupport-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw-interface  href="https://donate.wikimedia.org/?wmf_source=donate&amp;wmf_medium=sidebar&amp;wmf_campaign=en.wikipedia.org&amp;uselang=en" class=""><span>Donate</span></a>
</li>
<li id="pt-createaccount-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw-interface  href="/w/index.php?title=Special:CreateAccount&amp;returnto=MediaWiki%3AFileUploadWizard.js" title="You are encouraged to create an account and log in; however, it is not mandatory" class=""><span>Create account</span></a>
</li>
<li id="pt-login-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw-interface  href="/w/index.php?title=Special:UserLogin&amp;returnto=MediaWiki%3AFileUploadWizard.js" title="You&#039;re encouraged to log in; however, it&#039;s not mandatory. [o]" accesskey="o" class=""><span>Log in</span></a>
</li>

			
		</ul>
		
	</div>
</div>

	</div>
	
<div id="vector-user-links-dropdown" class="vector-dropdown vector-user-menu vector-button-flush-right vector-user-menu-logged-out user-links-collapsible-item"  title="Log in and more options" >
	<input type="checkbox" id="vector-user-links-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-user-links-dropdown" class="vector-dropdown-checkbox "  aria-label="Personal tools"  >
	<label id="vector-user-links-dropdown-label" for="vector-user-links-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-ellipsis mw-ui-icon-wikimedia-ellipsis"></span>

<span class="vector-dropdown-label-text">Personal tools</span>
	</label>
	<div class="vector-dropdown-content">


		
<div id="p-personal" class="vector-menu mw-portlet mw-portlet-personal user-links-collapsible-item"  title="User menu" >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-sitesupport" class="user-links-collapsible-item mw-list-item"><a href="https://donate.wikimedia.org/?wmf_source=donate&amp;wmf_medium=sidebar&amp;wmf_campaign=en.wikipedia.org&amp;uselang=en"><span>Donate</span></a></li><li id="pt-createaccount" class="user-links-collapsible-item mw-list-item"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=MediaWiki%3AFileUploadWizard.js" title="You are encouraged to create an account and log in; however, it is not mandatory"><span class="vector-icon mw-ui-icon-userAdd mw-ui-icon-wikimedia-userAdd"></span> <span>Create account</span></a></li><li id="pt-login" class="user-links-collapsible-item mw-list-item"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=MediaWiki%3AFileUploadWizard.js" title="You&#039;re encouraged to log in; however, it&#039;s not mandatory. [o]" accesskey="o"><span class="vector-icon mw-ui-icon-logIn mw-ui-icon-wikimedia-logIn"></span> <span>Log in</span></a></li>
		</ul>
		
	</div>
</div>

	
	</div>
</div>

</nav>

		</div>
	</header>
</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-sitenotice-container">
			<div id="siteNotice"><!-- CentralNotice --></div>
		</div>
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		<div id="mw-navigation">
			<nav id="mw-panel" class="vector-main-menu-landmark" aria-label="Site">
				<div id="vector-main-menu-pinned-container" class="vector-pinned-container">
				
				</div>
		</nav>
		</div>
	</div>
</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-namespace">MediaWiki</span><span class="mw-page-title-separator">:</span><span class="mw-page-title-main">FileUploadWizard.js</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang"  >
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="This article is only available in this language. Add the article for other languages"   >
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-0" aria-hidden="true"  ><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">Add languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				
			</ul>
			<div class="after-portlet after-portlet-lang"><span class="uls-after-portlet-link"></span></div>
		</div>

	</div>
</div>
</header>
				<div class="vector-page-toolbar vector-feature-custom-font-size-clientpref--excluded">
					<div class="vector-page-toolbar-container">
						<div id="left-navigation">
							<nav aria-label="Namespaces">
								
<div id="p-associated-pages" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-associated-pages"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-mediawiki" class="selected vector-tab-noicon mw-list-item"><a href="/wiki/MediaWiki:FileUploadWizard.js" title="View the system message [c]" accesskey="c"><span>Interface page</span></a></li><li id="ca-talk" class="vector-tab-noicon mw-list-item"><a href="/wiki/MediaWiki_talk:FileUploadWizard.js" rel="discussion" class="mw-redirect" title="Discuss improvements to the content page [t]" accesskey="t"><span>Talk</span></a></li>
		</ul>
		
	</div>
</div>

								
<div id="vector-variants-dropdown" class="vector-dropdown emptyPortlet"  >
	<input type="checkbox" id="vector-variants-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-variants-dropdown" class="vector-dropdown-checkbox " aria-label="Change language variant"   >
	<label id="vector-variants-dropdown-label" for="vector-variants-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"  ><span class="vector-dropdown-label-text">English</span>
	</label>
	<div class="vector-dropdown-content">


					
<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

				
	</div>
</div>

							</nav>
						</div>
						<div id="right-navigation" class="vector-collapsible">
							<nav aria-label="Views">
								
<div id="p-views" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-views"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected vector-tab-noicon mw-list-item"><a href="/wiki/MediaWiki:FileUploadWizard.js"><span>Read</span></a></li><li id="ca-viewsource" class="vector-tab-noicon mw-list-item"><a href="/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="vector-tab-noicon mw-list-item"><a href="/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

							</nav>
				
							<nav class="vector-page-tools-landmark" aria-label="Page tools">
								
<div id="vector-page-tools-dropdown" class="vector-dropdown vector-page-tools-dropdown"  >
	<input type="checkbox" id="vector-page-tools-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-tools-dropdown" class="vector-dropdown-checkbox "  aria-label="Tools"  >
	<label id="vector-page-tools-dropdown-label" for="vector-page-tools-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"  ><span class="vector-dropdown-label-text">Tools</span>
	</label>
	<div class="vector-dropdown-content">


									<div id="vector-page-tools-unpinned-container" class="vector-unpinned-container">
						
<div id="vector-page-tools" class="vector-page-tools vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-page-tools-pinnable-header vector-pinnable-header-unpinned"
	data-feature-name="page-tools-pinned"
	data-pinnable-element-id="vector-page-tools"
	data-pinned-container-id="vector-page-tools-pinned-container"
	data-unpinned-container-id="vector-page-tools-unpinned-container"
>
	<div class="vector-pinnable-header-label">Tools</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-page-tools.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-page-tools.unpin">hide</button>
</div>

	
<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-has-collapsible-items"  title="More options" >
	<div class="vector-menu-heading">
		Actions
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="/wiki/MediaWiki:FileUploadWizard.js"><span>Read</span></a></li><li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;action=edit"><span>View source</span></a></li><li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;action=history"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-tb" class="vector-menu mw-portlet mw-portlet-tb"  >
	<div class="vector-menu-heading">
		General
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/MediaWiki:FileUploadWizard.js" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/MediaWiki:FileUploadWizard.js" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-upload" class="mw-list-item"><a href="//en.wikipedia.org/wiki/Wikipedia:File_Upload_Wizard" title="Upload files [u]" accesskey="u"><span>Upload file</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;oldid=1237294272" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;action=info" title="More information about this page"><span>Page information</span></a></li><li id="t-urlshortener" class="mw-list-item"><a href="/w/index.php?title=Special:UrlShortener&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMediaWiki%3AFileUploadWizard.js"><span>Get shortened URL</span></a></li><li id="t-urlshortener-qrcode" class="mw-list-item"><a href="/w/index.php?title=Special:QrCode&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMediaWiki%3AFileUploadWizard.js"><span>Download QR code</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-coll-print_export" class="vector-menu mw-portlet mw-portlet-coll-print_export"  >
	<div class="vector-menu-heading">
		Print/export
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="coll-download-as-rl" class="mw-list-item"><a href="/w/index.php?title=Special:DownloadAsPdf&amp;page=MediaWiki%3AFileUploadWizard.js&amp;action=show-download-screen" title="Download this page as a PDF file"><span>Download as PDF</span></a></li><li id="t-print" class="mw-list-item"><a href="/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;printable=yes" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-wikibase-otherprojects" class="vector-menu mw-portlet mw-portlet-wikibase-otherprojects emptyPortlet"  >
	<div class="vector-menu-heading">
		In other projects
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

</div>

									</div>
				
	</div>
</div>

							</nav>
						</div>
					</div>
				</div>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned"
	data-feature-name="appearance-pinned"
	data-pinnable-element-id="vector-appearance"
	data-pinned-container-id="vector-appearance-pinned-container"
	data-unpinned-container-id="vector-appearance-unpinned-container"
>
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From Wikipedia, the free encyclopedia</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content"><div id="mw-clearyourcache" lang="en" dir="ltr" class="mw-content-ltr">
<div class="mw-parser-output"><span id="clearprefcache"><b>Note:</b> After saving, you have to bypass your browser's cache to see the changes. <b>Google Chrome</b>, <b>Firefox</b>, <b>Microsoft Edge</b> and <b>Safari</b>: Hold down the <style data-mw-deduplicate="TemplateStyles:r1249182868">.mw-parser-output .keyboard-key{border:1px solid #aaa;border-radius:0.2em;box-shadow:0.1em 0.1em 0.2em rgba(0,0,0,0.1);background-color:var(--background-color-neutral-subtle,#f8f9fa);background-image:linear-gradient(to bottom,var(--background-color-neutral,#eaecf0),var(--background-color-neutral-subtle,#f8f9fa),var(--background-color-neutral,#eaecf0));color:var(--color-base,#202122);padding:0.1em 0.3em;font-family:inherit;font-size:0.85em}</style><kbd class="keyboard-key nowrap">â‡§ Shift</kbd> key and click the <i>Reload</i> toolbar button. For details and instructions about other browsers, see <a href="/wiki/Wikipedia:Bypass_your_cache" title="Wikipedia:Bypass your cache">Wikipedia:Bypass your cache</a>.</span></div>
</div><div class="mw-highlight mw-highlight-lang-javascript mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos" data-line="1"></span></a><span class="cm">/*</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos" data-line="2"></span></a><span class="cm">* ===============================================================</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos" data-line="3"></span></a><span class="cm">*                    FileUploadWizard.js</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos" data-line="4"></span></a><span class="cm">* Script for uploading files through a dynamic questionnaire.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos" data-line="5"></span></a><span class="cm">* This is the code to accompany [[Wikipedia:File Upload Wizard]].</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos" data-line="6"></span></a><span class="cm">* ===============================================================</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos" data-line="7"></span></a><span class="cm">*/</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos" data-line="8"></span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos" data-line="9"></span></a><span class="kd">var</span><span class="w"> </span><span class="nx">fuwTesting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos" data-line="10"></span></a><span class="kd">var</span><span class="w"> </span><span class="nx">fuwDefaultTextboxLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">60</span><span class="p">;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos" data-line="11"></span></a><span class="kd">var</span><span class="w"> </span><span class="nx">fuwDefaultTextareaWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;90%&#39;</span><span class="p">;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos" data-line="12"></span></a><span class="kd">var</span><span class="w"> </span><span class="nx">fuwDefaultTextareaLines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos" data-line="13"></span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos" data-line="14"></span></a><span class="c1">// ================================================================</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos" data-line="15"></span></a><span class="c1">// Constructor function of global fuw (= File Upload Wizard) object</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos" data-line="16"></span></a><span class="c1">// ================================================================</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos" data-line="17"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwGlobal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos" data-line="18"></span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos" data-line="19"></span></a><span class="w">   </span><span class="c1">// see if user is logged in, autoconfirmed, experienced etc.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos" data-line="20"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">getUserStatus</span><span class="p">();</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos" data-line="21"></span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos" data-line="22"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningLoggedOut&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;anon&#39;</span><span class="p">));</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos" data-line="23"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningNotConfirmed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;notAutoconfirmed&#39;</span><span class="p">));</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos" data-line="24"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;anon&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;notAutoconfirmed&#39;</span><span class="p">);</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos" data-line="25"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">disabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos" data-line="26"></span></a><span class="w">      </span><span class="k">return</span><span class="p">;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos" data-line="27"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos" data-line="28"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;fuwStartScriptLink&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos" data-line="29"></span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos" data-line="30"></span></a><span class="w">   </span><span class="c1">// create the form element to wrap the main ScriptForm area</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos" data-line="31"></span></a><span class="w">   </span><span class="c1">// containing input elements of Step2 and Step3</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos" data-line="32"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">frm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;fuwScriptForm&#39;</span><span class="p">);</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos" data-line="33"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="nx">frm</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos" data-line="34"></span></a><span class="w">      </span><span class="nx">frm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">);</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos" data-line="35"></span></a><span class="w">      </span><span class="nx">frm</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;fuwScriptForm&quot;</span><span class="p">;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos" data-line="36"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;placeholderScriptForm&#39;</span><span class="p">);</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos" data-line="37"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">area</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos" data-line="38"></span></a><span class="w">      </span><span class="nx">parent</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">frm</span><span class="p">,</span><span class="w"> </span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos" data-line="39"></span></a><span class="w">      </span><span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos" data-line="40"></span></a><span class="w">      </span><span class="nx">frm</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos" data-line="41"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos" data-line="42"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">frm</span><span class="p">;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos" data-line="43"></span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos" data-line="44"></span></a><span class="w">   </span><span class="c1">// create the TargetForm element that contains the file selector</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos" data-line="45"></span></a><span class="w">   </span><span class="nx">frm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;TargetForm&#39;</span><span class="p">);</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos" data-line="46"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="nx">frm</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos" data-line="47"></span></a><span class="w">      </span><span class="nx">frm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">);</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos" data-line="48"></span></a><span class="w">      </span><span class="nx">frm</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;TargetForm&quot;</span><span class="p">;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos" data-line="49"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;placeholderTargetForm&#39;</span><span class="p">);</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos" data-line="50"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">area</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos" data-line="51"></span></a><span class="w">      </span><span class="nx">parent</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">frm</span><span class="p">,</span><span class="w"> </span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos" data-line="52"></span></a><span class="w">      </span><span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos" data-line="53"></span></a><span class="w">      </span><span class="nx">frm</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos" data-line="54"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos" data-line="55"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">TargetForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">frm</span><span class="p">;</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos" data-line="56"></span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos" data-line="57"></span></a><span class="w">   </span><span class="c1">// For the testing version, create a third form that will display</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos" data-line="58"></span></a><span class="w">   </span><span class="c1">// the contents to be submitted, at the bottom of the page</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos" data-line="59"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos" data-line="60"></span></a><span class="w">      </span><span class="nx">frm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;fuwTestForm&#39;</span><span class="p">);</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos" data-line="61"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="nx">frm</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos" data-line="62"></span></a><span class="w">         </span><span class="nx">frm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">);</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos" data-line="63"></span></a><span class="w">         </span><span class="nx">frm</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;fuwTestForm&quot;</span><span class="p">;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos" data-line="64"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;placeholderTestForm&#39;</span><span class="p">);</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos" data-line="65"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">area</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos" data-line="66"></span></a><span class="w">         </span><span class="nx">parent</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">frm</span><span class="p">,</span><span class="w"> </span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos" data-line="67"></span></a><span class="w">         </span><span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos" data-line="68"></span></a><span class="w">         </span><span class="nx">frm</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">area</span><span class="p">);</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos" data-line="69"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos" data-line="70"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">TestForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">frm</span><span class="p">;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos" data-line="71"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos" data-line="72"></span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos" data-line="73"></span></a><span class="w">   </span><span class="c1">// objects to hold cached results during validation and processing</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos" data-line="74"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos" data-line="75"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos" data-line="76"></span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos" data-line="77"></span></a><span class="w">   </span><span class="c1">// create the input filename box</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos" data-line="78"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">filebox</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos" data-line="79"></span></a><span class="w">   </span><span class="nx">filebox</span><span class="p">.</span><span class="nx">id</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;file&#39;</span><span class="p">;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos" data-line="80"></span></a><span class="w">   </span><span class="nx">filebox</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;file&#39;</span><span class="p">;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos" data-line="81"></span></a><span class="w">   </span><span class="nx">filebox</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;file&#39;</span><span class="p">;</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos" data-line="82"></span></a><span class="w">   </span><span class="nx">filebox</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwDefaultTextboxLength</span><span class="p">;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos" data-line="83"></span></a><span class="w">   </span><span class="nx">filebox</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwValidateFile</span><span class="p">;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos" data-line="84"></span></a><span class="w">   </span><span class="nx">filebox</span><span class="p">.</span><span class="nx">accept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;image/png,image/jpeg,image/gif,image/svg+xml,image/tiff,image/x-xcf,application/pdf,image/vnd.djvu,audio/ogg,video/ogg,audio/rtp-midi,audio/mp3,image/webp,video/webm,audio/opus,video/mpeg,audio/wav,audio/flac&#39;</span><span class="p">;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos" data-line="85"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">filebox</span><span class="p">);</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos" data-line="86"></span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos" data-line="87"></span></a><span class="w">   </span><span class="c1">// Default values for API call parameters</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos" data-line="88"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">UploadOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos" data-line="89"></span></a><span class="w">      </span><span class="nx">filename</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos" data-line="90"></span></a><span class="w">      </span><span class="nx">text</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos" data-line="91"></span></a><span class="w">      </span><span class="nx">comment</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos" data-line="92"></span></a><span class="w">      </span><span class="nx">ignorewarnings</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos" data-line="93"></span></a><span class="w">      </span><span class="nx">watch</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos" data-line="94"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos" data-line="95"></span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos" data-line="96"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos" data-line="97"></span></a><span class="w">      </span><span class="nx">fuwMakeHiddenfield</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgPageName&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/sandbox&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SandboxTitle&#39;</span><span class="p">);</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos" data-line="98"></span></a><span class="w">      </span><span class="nx">fuwMakeHiddenfield</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;csrfToken&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;SandboxToken&#39;</span><span class="p">);</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos" data-line="99"></span></a><span class="w">      </span><span class="nx">fuwMakeHiddenfield</span><span class="p">(</span><span class="s1">&#39;recreate&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SandboxRecreate&#39;</span><span class="p">);</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos" data-line="100"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos" data-line="101"></span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos" data-line="102"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos" data-line="103"></span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos" data-line="104"></span></a><span class="w">      </span><span class="c1">// create the sandbox submit button</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos" data-line="105"></span></a><span class="w">      </span><span class="nx">btn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos" data-line="106"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SandboxButton&#39;</span><span class="p">;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos" data-line="107"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Sandbox&#39;</span><span class="p">;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos" data-line="108"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Sandbox&#39;</span><span class="p">;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos" data-line="109"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos" data-line="110"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;button&#39;</span><span class="p">;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos" data-line="111"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;12em&#39;</span><span class="p">;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos" data-line="112"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwSubmitSandbox</span><span class="p">;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos" data-line="113"></span></a><span class="w">      </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="s1">&#39;SandboxButton&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">btn</span><span class="p">);</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos" data-line="114"></span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos" data-line="115"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos" data-line="116"></span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos" data-line="117"></span></a><span class="w">   </span><span class="c1">// create the real submit button</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos" data-line="118"></span></a><span class="w">   </span><span class="nx">btn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos" data-line="119"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;SubmitButton&quot;</span><span class="p">;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos" data-line="120"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Upload&quot;</span><span class="p">;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos" data-line="121"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Upload&quot;</span><span class="p">;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos" data-line="122"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos" data-line="123"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;button&quot;</span><span class="p">;</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos" data-line="124"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwSubmitUpload</span><span class="p">;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos" data-line="125"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;12em&#39;</span><span class="p">;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos" data-line="126"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="s1">&#39;SubmitButton&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">btn</span><span class="p">);</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos" data-line="127"></span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos" data-line="128"></span></a><span class="w">   </span><span class="c1">// create the Commons submit button</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos" data-line="129"></span></a><span class="w">   </span><span class="nx">btn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos" data-line="130"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;CommonsButton&quot;</span><span class="p">;</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos" data-line="131"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Upload on Commons&quot;</span><span class="p">;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos" data-line="132"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Upload_on_Commons&quot;</span><span class="p">;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos" data-line="133"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos" data-line="134"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;button&quot;</span><span class="p">;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos" data-line="135"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwSubmitCommons</span><span class="p">;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos" data-line="136"></span></a><span class="w">   </span><span class="nx">btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;12em&#39;</span><span class="p">;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos" data-line="137"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="s1">&#39;CommonsButton&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">btn</span><span class="p">);</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos" data-line="138"></span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos" data-line="139"></span></a><span class="w">   </span><span class="c1">// create reset buttons</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos" data-line="140"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;=</span><span class="mf">2</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos" data-line="141"></span></a><span class="w">      </span><span class="nx">btn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos" data-line="142"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ResetButton&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos" data-line="143"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Reset form&quot;</span><span class="p">;</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos" data-line="144"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Reset form&quot;</span><span class="p">;</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos" data-line="145"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">type</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;button&quot;</span><span class="p">;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos" data-line="146"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwReset</span><span class="p">;</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos" data-line="147"></span></a><span class="w">      </span><span class="nx">btn</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;12em&#39;</span><span class="p">;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos" data-line="148"></span></a><span class="w">      </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="s1">&#39;ResetButton&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">btn</span><span class="p">);</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos" data-line="149"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos" data-line="150"></span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos" data-line="151"></span></a><span class="w">   </span><span class="c1">// names of radio button fields</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos" data-line="152"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">optionRadioButtons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos" data-line="153"></span></a><span class="w">      </span><span class="c1">// top-level copyright status choice</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos" data-line="154"></span></a><span class="w">      </span><span class="s1">&#39;FreeOrNonFree&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;OptionFree&#39;</span><span class="p">,</span><span class="s1">&#39;OptionNonFree&#39;</span><span class="p">,</span><span class="s1">&#39;OptionNoGood&#39;</span><span class="p">],</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos" data-line="155"></span></a><span class="w">      </span><span class="c1">// main subsections under OptionFree</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos" data-line="156"></span></a><span class="w">      </span><span class="s1">&#39;FreeOptions&#39;</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;OptionOwnWork&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OptionThirdParty&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OptionFreeWebsite&#39;</span><span class="p">,</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos" data-line="157"></span></a><span class="w">                         </span><span class="s1">&#39;OptionPDOld&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OptionPDOther&#39;</span><span class="p">],</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos" data-line="158"></span></a><span class="w">      </span><span class="c1">// main subsections under OptionNonFree</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos" data-line="159"></span></a><span class="w">      </span><span class="s1">&#39;NonFreeOptions&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;OptionNFSubject&#39;</span><span class="p">,</span><span class="s1">&#39;OptionNF3D&#39;</span><span class="p">,</span><span class="s1">&#39;OptionNFExcerpt&#39;</span><span class="p">,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos" data-line="160"></span></a><span class="w">                         </span><span class="s1">&#39;OptionNFCover&#39;</span><span class="p">,</span><span class="s1">&#39;OptionNFLogo&#39;</span><span class="p">,</span><span class="s1">&#39;OptionNFPortrait&#39;</span><span class="p">,</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos" data-line="161"></span></a><span class="w">                         </span><span class="s1">&#39;OptionNFMisc&#39;</span><span class="p">],</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos" data-line="162"></span></a><span class="w">      </span><span class="c1">// response options inside warningFileExists</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos" data-line="163"></span></a><span class="w">      </span><span class="s1">&#39;FileExistsOptions&#39;</span><span class="o">:</span><span class="w"> </span>
</span><span id="L-164"><a href="#L-164"><span class="linenos" data-line="164"></span></a><span class="w">                        </span><span class="p">[</span><span class="s1">&#39;NoOverwrite&#39;</span><span class="p">,</span><span class="s1">&#39;OverwriteSame&#39;</span><span class="p">,</span><span class="s1">&#39;OverwriteDifferent&#39;</span><span class="p">],</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos" data-line="165"></span></a><span class="w">      </span><span class="c1">// choice of evidence in OptionThirdParty subsection</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos" data-line="166"></span></a><span class="w">      </span><span class="s1">&#39;ThirdPartyEvidenceOptions&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>
</span><span id="L-167"><a href="#L-167"><span class="linenos" data-line="167"></span></a><span class="w">                        </span><span class="p">[</span><span class="s1">&#39;ThirdPartyEvidenceOptionLink&#39;</span><span class="p">,</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos" data-line="168"></span></a><span class="w">                         </span><span class="s1">&#39;ThirdPartyEvidenceOptionOTRS&#39;</span><span class="p">,</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos" data-line="169"></span></a><span class="w">                         </span><span class="s1">&#39;ThirdPartyEvidenceOptionOTRSForthcoming&#39;</span><span class="p">,</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos" data-line="170"></span></a><span class="w">                         </span><span class="s1">&#39;ThirdPartyEvidenceOptionNone&#39;</span><span class="p">],</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos" data-line="171"></span></a><span class="w">      </span><span class="c1">// choice of PD status in OptionPDOld subsection</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos" data-line="172"></span></a><span class="w">      </span><span class="s1">&#39;PDOldOptions&#39;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;PDUSExpired&#39;</span><span class="p">,</span><span class="s1">&#39;PDURAA&#39;</span><span class="p">,</span><span class="s1">&#39;PDFormality&#39;</span><span class="p">,</span><span class="s1">&#39;PDOldOther&#39;</span><span class="p">],</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos" data-line="173"></span></a><span class="w">      </span><span class="c1">// choice of PD status in OptionPDOther subsection</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos" data-line="174"></span></a><span class="w">      </span><span class="s1">&#39;PDOtherOptions&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;PDOtherUSGov&#39;</span><span class="p">,</span><span class="s1">&#39;PDOtherOfficial&#39;</span><span class="p">,</span><span class="s1">&#39;PDOtherSimple&#39;</span><span class="p">,</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos" data-line="175"></span></a><span class="w">                         </span><span class="s1">&#39;PDOtherOther&#39;</span><span class="p">],</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos" data-line="176"></span></a><span class="w">      </span><span class="c1">// whether target article is wholly or only partly dedicated to discussing non-free work:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos" data-line="177"></span></a><span class="w">      </span><span class="s1">&#39;NFSubjectCheck&#39;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;NFSubjectCheckDedicated&#39;</span><span class="p">,</span><span class="s1">&#39;NFSubjectCheckDiscussed&#39;</span><span class="p">],</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos" data-line="178"></span></a><span class="w">      </span><span class="s1">&#39;NF3DCheck&#39;</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;NF3DCheckDedicated&#39;</span><span class="p">,</span><span class="s1">&#39;NF3DCheckDiscussed&#39;</span><span class="p">],</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos" data-line="179"></span></a><span class="w">      </span><span class="c1">// choice about copyright status of photograph in OptionNF3D</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos" data-line="180"></span></a><span class="w">      </span><span class="s1">&#39;NF3DOptions&#39;</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;NF3DOptionFree&#39;</span><span class="p">,</span><span class="s1">&#39;NF3DOptionSame&#39;</span><span class="p">]</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos" data-line="181"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos" data-line="182"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">optionRadioButtons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos" data-line="183"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">op</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">optionRadioButtons</span><span class="p">[</span><span class="nx">group</span><span class="p">];</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos" data-line="184"></span></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">op</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos" data-line="185"></span></a><span class="w">         </span><span class="nx">fuwMakeRadiobutton</span><span class="p">(</span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">op</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos" data-line="186"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos" data-line="187"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos" data-line="188"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">NoOverwrite</span><span class="p">.</span><span class="nx">checked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos" data-line="189"></span></a><span class="w">   </span>
</span><span id="L-190"><a href="#L-190"><span class="linenos" data-line="190"></span></a><span class="w">   </span><span class="c1">// input fields that trigger special</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos" data-line="191"></span></a><span class="w">   </span><span class="c1">// onchange() event handlers for validation:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos" data-line="192"></span></a><span class="w">   </span><span class="nx">fuwMakeTextfield</span><span class="p">(</span><span class="s1">&#39;InputName&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">fuwValidateFilename</span><span class="p">);</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos" data-line="193"></span></a><span class="w">   </span><span class="nx">fuwMakeTextfield</span><span class="p">(</span><span class="s1">&#39;NFArticle&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">fuwValidateNFArticle</span><span class="p">);</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos" data-line="194"></span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos" data-line="195"></span></a><span class="w">   </span><span class="c1">// names of input fields that trigger normal</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos" data-line="196"></span></a><span class="w">   </span><span class="c1">// validation event handler</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos" data-line="197"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">activeTextfields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos" data-line="198"></span></a><span class="w">      </span><span class="s1">&#39;Artist3D&#39;</span><span class="p">,</span><span class="s1">&#39;Country3D&#39;</span><span class="p">,</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos" data-line="199"></span></a><span class="w">      </span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="s1">&#39;OwnWorkCreation&#39;</span><span class="p">,</span><span class="s1">&#39;OwnWorkPublication&#39;</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos" data-line="200"></span></a><span class="w">      </span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos" data-line="201"></span></a><span class="w">      </span><span class="s1">&#39;Permission&#39;</span><span class="p">,</span><span class="s1">&#39;ThirdPartyOtherLicense&#39;</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos" data-line="202"></span></a><span class="w">      </span><span class="s1">&#39;ThirdPartyEvidenceLink&#39;</span><span class="p">,</span><span class="s1">&#39;ThirdPartyOTRSTicket&#39;</span><span class="p">,</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos" data-line="203"></span></a><span class="w">      </span><span class="s1">&#39;FreeWebsiteOtherLicense&#39;</span><span class="p">,</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos" data-line="204"></span></a><span class="w">      </span><span class="s1">&#39;PDOldAuthorLifetime&#39;</span><span class="p">,</span><span class="s1">&#39;Publication&#39;</span><span class="p">,</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos" data-line="205"></span></a><span class="w">      </span><span class="s1">&#39;PDOldCountry&#39;</span><span class="p">,</span><span class="s1">&#39;PDOldPermission&#39;</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos" data-line="206"></span></a><span class="w">      </span><span class="s1">&#39;PDOfficialPermission&#39;</span><span class="p">,</span><span class="s1">&#39;PDOtherPermission&#39;</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos" data-line="207"></span></a><span class="w">      </span><span class="s1">&#39;NFSubjectPurpose&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NF3DOrigDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NF3DPurpose&#39;</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos" data-line="208"></span></a><span class="w">      </span><span class="s1">&#39;NF3DCreator&#39;</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos" data-line="209"></span></a><span class="w">      </span><span class="s1">&#39;NFPortraitDeceased&#39;</span><span class="p">,</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos" data-line="210"></span></a><span class="w">      </span><span class="s1">&#39;EditSummary&#39;</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos" data-line="211"></span></a><span class="w">   </span><span class="p">];</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos" data-line="212"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">activeTextfields</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos" data-line="213"></span></a><span class="w">      </span><span class="nx">fuwMakeTextfield</span><span class="p">(</span><span class="nx">activeTextfields</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos" data-line="214"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos" data-line="215"></span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos" data-line="216"></span></a><span class="w">   </span><span class="c1">// names of multiline textareas</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos" data-line="217"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">activeTextareas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos" data-line="218"></span></a><span class="w">      </span><span class="s1">&#39;InputDesc&#39;</span><span class="p">,</span><span class="s1">&#39;NF3DPermission&#39;</span><span class="p">,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos" data-line="219"></span></a><span class="w">      </span><span class="s1">&#39;NFCommercial&#39;</span><span class="p">,</span><span class="s1">&#39;NFPurpose&#39;</span><span class="p">,</span><span class="s1">&#39;NFReplaceableText&#39;</span><span class="p">,</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos" data-line="220"></span></a><span class="w">      </span><span class="s1">&#39;NFReplaceable&#39;</span><span class="p">,</span><span class="s1">&#39;NFCommercial&#39;</span><span class="p">,</span><span class="s1">&#39;NFMinimality&#39;</span><span class="p">,</span><span class="s1">&#39;AnyOther&#39;</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos" data-line="221"></span></a><span class="w">   </span><span class="p">];</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos" data-line="222"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">activeTextareas</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos" data-line="223"></span></a><span class="w">      </span><span class="nx">fuwMakeTextarea</span><span class="p">(</span><span class="nx">activeTextareas</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos" data-line="224"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos" data-line="225"></span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos" data-line="226"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">checkboxes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos" data-line="227"></span></a><span class="w">      </span><span class="s1">&#39;NFCoverCheckDedicated&#39;</span><span class="p">,</span><span class="s1">&#39;NFLogoCheckDedicated&#39;</span><span class="p">,</span><span class="s1">&#39;NFPortraitCheckDedicated&#39;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos" data-line="228"></span></a><span class="w">   </span><span class="p">];</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos" data-line="229"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">checkboxes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos" data-line="230"></span></a><span class="w">      </span><span class="nx">fuwMakeCheckbox</span><span class="p">(</span><span class="nx">checkboxes</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos" data-line="231"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos" data-line="232"></span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos" data-line="233"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">licenseLists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos" data-line="234"></span></a><span class="w">      </span><span class="s1">&#39;OwnWorkLicense&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>
</span><span id="L-235"><a href="#L-235"><span class="linenos" data-line="235"></span></a><span class="w">        </span><span class="c1">// array structure as expected for input to fuwMakeSelection() function.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos" data-line="236"></span></a><span class="w">        </span><span class="c1">// any entry that is a two-element array will be turned into an option</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos" data-line="237"></span></a><span class="w">        </span><span class="c1">// (first element is the value, second element is the display string).</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos" data-line="238"></span></a><span class="w">        </span><span class="c1">// Entries that are one-element arrays will be the label of an option group.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos" data-line="239"></span></a><span class="w">        </span><span class="c1">// Zero-element arrays mark the end of an option group.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos" data-line="240"></span></a><span class="w">        </span><span class="p">[</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos" data-line="241"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;Allow all use as long as others credit you and share it under similar conditions&#39;</span><span class="p">],</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos" data-line="242"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;self|GFDL|cc-by-sa-4.0|migration=redundant&#39;</span><span class="p">,</span><span class="w"> </span>
</span><span id="L-243"><a href="#L-243"><span class="linenos" data-line="243"></span></a><span class="w">         </span><span class="s1">&#39;Creative Commons Attribution-Share Alike 4.0 + GFDL (recommended)&#39;</span><span class="p">,</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos" data-line="244"></span></a><span class="w">         </span><span class="kc">true</span><span class="p">],</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos" data-line="245"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;self|cc-by-sa-4.0&#39;</span><span class="p">,</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos" data-line="246"></span></a><span class="w">         </span><span class="s1">&#39;Creative Commons Attribution-Share Alike 4.0&#39;</span><span class="p">],</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos" data-line="247"></span></a><span class="w">        </span><span class="p">[],</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos" data-line="248"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;Allow all use as long as others credit you&#39;</span><span class="p">],</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos" data-line="249"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;self|cc-by-4.0&#39;</span><span class="p">,</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos" data-line="250"></span></a><span class="w">         </span><span class="s1">&#39;Creative Commons Attribution 4.0&#39;</span><span class="p">],</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos" data-line="251"></span></a><span class="w">        </span><span class="p">[],</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos" data-line="252"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;Reserve no rights&#39;</span><span class="p">],</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos" data-line="253"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;self|cc0&#39;</span><span class="p">,</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos" data-line="254"></span></a><span class="w">         </span><span class="s1">&#39;CC0 Universal Public Domain Dedication&#39;</span><span class="p">],</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos" data-line="255"></span></a><span class="w">        </span><span class="p">[]</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos" data-line="256"></span></a><span class="w">        </span><span class="p">],</span><span class="w">   </span>
</span><span id="L-257"><a href="#L-257"><span class="linenos" data-line="257"></span></a><span class="w">      </span><span class="s1">&#39;ThirdPartyLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos" data-line="258"></span></a><span class="w">        </span><span class="p">[</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos" data-line="259"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;please select the correct license...&#39;</span><span class="p">],</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos" data-line="260"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;Freely licensed:&#39;</span><span class="p">],</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos" data-line="261"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;cc-by-sa-4.0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Creative Commons Attribution-Share Alike (cc-by-sa-4.0)&#39;</span><span class="p">],</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos" data-line="262"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;cc-by-4.0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Creative Commons Attribution (cc-by-4.0)&#39;</span><span class="p">],</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos" data-line="263"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;GFDL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GNU Free Documentation License (GFDL)&#39;</span><span class="p">],</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos" data-line="264"></span></a><span class="w">        </span><span class="p">[],</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos" data-line="265"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;No rights reserved:&#39;</span><span class="p">],</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos" data-line="266"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;PD-author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Public domain&#39;</span><span class="p">],</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos" data-line="267"></span></a><span class="w">        </span><span class="p">[],</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos" data-line="268"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;Other (see below)&#39;</span><span class="p">],</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos" data-line="269"></span></a><span class="w">        </span><span class="p">[]</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos" data-line="270"></span></a><span class="w">        </span><span class="p">],</span><span class="w">   </span>
</span><span id="L-271"><a href="#L-271"><span class="linenos" data-line="271"></span></a><span class="w">      </span><span class="s1">&#39;FreeWebsiteLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos" data-line="272"></span></a><span class="w">        </span><span class="p">[</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos" data-line="273"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;please select the correct license...&#39;</span><span class="p">],</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos" data-line="274"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;Freely licensed:&#39;</span><span class="p">],</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos" data-line="275"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;cc-by-sa-4.0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Creative Commons Attribution-Share Alike (cc-by-sa-4.0)&#39;</span><span class="p">],</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos" data-line="276"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;cc-by-4.0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Creative Commons Attribution (cc-by-4.0)&#39;</span><span class="p">],</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos" data-line="277"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;GFDL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GNU Free Documentation License (GFDL)&#39;</span><span class="p">],</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos" data-line="278"></span></a><span class="w">        </span><span class="p">[],</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos" data-line="279"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;No rights reserved:&#39;</span><span class="p">],</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos" data-line="280"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;PD-author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Public domain&#39;</span><span class="p">],</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos" data-line="281"></span></a><span class="w">        </span><span class="p">[],</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos" data-line="282"></span></a><span class="w">        </span><span class="p">[</span><span class="s1">&#39;Other (see below)&#39;</span><span class="p">],</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos" data-line="283"></span></a><span class="w">        </span><span class="p">[]</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos" data-line="284"></span></a><span class="w">        </span><span class="p">],</span><span class="w">   </span>
</span><span id="L-285"><a href="#L-285"><span class="linenos" data-line="285"></span></a><span class="w">      </span><span class="s1">&#39;USGovLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos" data-line="286"></span></a><span class="w">       </span><span class="p">[</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos" data-line="287"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-USGov&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;US Federal Government&#39;</span><span class="p">],</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos" data-line="288"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-USGov-NASA&#39;</span><span class="p">,</span><span class="s1">&#39;NASA&#39;</span><span class="p">],</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos" data-line="289"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-USGov-Military-Navy&#39;</span><span class="p">,</span><span class="s1">&#39;US Navy&#39;</span><span class="p">],</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos" data-line="290"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-USGov-DOC-NOAA&#39;</span><span class="p">,</span><span class="s1">&#39;US National Oceanic and Atmospheric Administration&#39;</span><span class="p">],</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos" data-line="291"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-USGov-Military-Air_Force&#39;</span><span class="p">,</span><span class="s1">&#39;US Air Force&#39;</span><span class="p">],</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos" data-line="292"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-USGov-Military-Army&#39;</span><span class="p">,</span><span class="s1">&#39;US Army&#39;</span><span class="p">],</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos" data-line="293"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-USGov-Interior-USGS&#39;</span><span class="p">,</span><span class="s1">&#39;United States Geological Survey&#39;</span><span class="p">]</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos" data-line="294"></span></a><span class="w">       </span><span class="p">],</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos" data-line="295"></span></a><span class="w">      </span><span class="s1">&#39;IneligibleLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos" data-line="296"></span></a><span class="w">       </span><span class="p">[</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos" data-line="297"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;please select one...&#39;</span><span class="p">],</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos" data-line="298"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-shape&#39;</span><span class="p">,</span><span class="s1">&#39;Item consists solely of simple geometric shapes&#39;</span><span class="p">],</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos" data-line="299"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-simple&#39;</span><span class="p">,</span><span class="s1">&#39;Item consists solely of a few individual words or letters&#39;</span><span class="p">],</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos" data-line="300"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-textlogo&#39;</span><span class="p">,</span><span class="s1">&#39;Logo or similar item consisting solely of letters and simple geometric shapes&#39;</span><span class="p">],</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos" data-line="301"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-chem&#39;</span><span class="p">,</span><span class="s1">&#39;Chemical structural formula&#39;</span><span class="p">],</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos" data-line="302"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;PD-ineligible&#39;</span><span class="p">,</span><span class="s1">&#39;Other kind of item that contains no original authorship&#39;</span><span class="p">]</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos" data-line="303"></span></a><span class="w">       </span><span class="p">],</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos" data-line="304"></span></a><span class="w">      </span><span class="s1">&#39;NFSubjectLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos" data-line="305"></span></a><span class="w">       </span><span class="p">[</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos" data-line="306"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;please select one...&#39;</span><span class="p">],</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos" data-line="307"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;Non-free 2D art&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2-dimensional artwork (painting, drawing etc.)&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-308"><a href="#L-308"><span class="linenos" data-line="308"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;Non-free historic image&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unique historic photograph&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-309"><a href="#L-309"><span class="linenos" data-line="309"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;Non-free fair use&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;something else (please describe in description field on top)&#39;</span><span class="p">]</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos" data-line="310"></span></a><span class="w">       </span><span class="p">],</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos" data-line="311"></span></a><span class="w">      </span><span class="s1">&#39;NF3DLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos" data-line="312"></span></a><span class="w">       </span><span class="p">[</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos" data-line="313"></span></a><span class="w">       </span><span class="p">[,</span><span class="w"> </span><span class="s1">&#39;please select one...&#39;</span><span class="p">],</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos" data-line="314"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;Non-free proposed architecture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Architectural proposal (not yet completed)&#39;</span><span class="p">],</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos" data-line="315"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;Non-free destroyed architecture&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Destroyed (or unrecognizably altered) architecture&#39;</span><span class="p">],</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos" data-line="316"></span></a><span class="w">       </span><span class="p">[</span><span class="s1">&#39;Non-free 3D art&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Other 3-dimensional creative work (sculpture etc.)&#39;</span><span class="p">]</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos" data-line="317"></span></a><span class="w">       </span><span class="p">],</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos" data-line="318"></span></a><span class="w">      </span><span class="s1">&#39;NFCoverLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos" data-line="319"></span></a><span class="w">         </span><span class="p">[</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos" data-line="320"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;please select one...&#39;</span><span class="p">],</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos" data-line="321"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free book cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover page of a book&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-322"><a href="#L-322"><span class="linenos" data-line="322"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free album cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a sound recording (album, single, song, CD)&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-323"><a href="#L-323"><span class="linenos" data-line="323"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video game cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a video/computer game&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-324"><a href="#L-324"><span class="linenos" data-line="324"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free magazine cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover page of a magazine&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-325"><a href="#L-325"><span class="linenos" data-line="325"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a video&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-326"><a href="#L-326"><span class="linenos" data-line="326"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free software cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a software product&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-327"><a href="#L-327"><span class="linenos" data-line="327"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free product cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of some commercial product&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-328"><a href="#L-328"><span class="linenos" data-line="328"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free title-card&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Title screen of a TV programme&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-329"><a href="#L-329"><span class="linenos" data-line="329"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free film poster&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Film poster&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-330"><a href="#L-330"><span class="linenos" data-line="330"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free poster&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Official poster of an event&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-331"><a href="#L-331"><span class="linenos" data-line="331"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free fair use&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;something else (please describe in description field on top)&#39;</span><span class="p">]</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos" data-line="332"></span></a><span class="w">         </span><span class="p">],</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos" data-line="333"></span></a><span class="w">      </span><span class="s1">&#39;NFExcerptLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos" data-line="334"></span></a><span class="w">         </span><span class="p">[</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos" data-line="335"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;please select one...&#39;</span><span class="p">],</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos" data-line="336"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free television screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Television screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-337"><a href="#L-337"><span class="linenos" data-line="337"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free film screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Movie screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-338"><a href="#L-338"><span class="linenos" data-line="338"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video game screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Video game screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-339"><a href="#L-339"><span class="linenos" data-line="339"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Video screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-340"><a href="#L-340"><span class="linenos" data-line="340"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free music video screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Music video screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-341"><a href="#L-341"><span class="linenos" data-line="341"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free software screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Software screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-342"><a href="#L-342"><span class="linenos" data-line="342"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free web screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Website screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-343"><a href="#L-343"><span class="linenos" data-line="343"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free speech&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Audio excerpt from a speech&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-344"><a href="#L-344"><span class="linenos" data-line="344"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free audio sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sound sample of an audio recording&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-345"><a href="#L-345"><span class="linenos" data-line="345"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sample extract from a video&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-346"><a href="#L-346"><span class="linenos" data-line="346"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free sheet music&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sheet music representing a musical piece&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-347"><a href="#L-347"><span class="linenos" data-line="347"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free comic&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Panel from a comic, graphic novel, manga etc.&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-348"><a href="#L-348"><span class="linenos" data-line="348"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free computer icon&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Computer icon&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-349"><a href="#L-349"><span class="linenos" data-line="349"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free newspaper image&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Page from a newspaper&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-350"><a href="#L-350"><span class="linenos" data-line="350"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free fair use&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;something else (please describe in description field on top)&#39;</span><span class="p">]</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos" data-line="351"></span></a><span class="w">         </span><span class="p">],</span><span class="w">      </span>
</span><span id="L-352"><a href="#L-352"><span class="linenos" data-line="352"></span></a><span class="w">      </span><span class="s1">&#39;NFLogoLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos" data-line="353"></span></a><span class="w">         </span><span class="p">[</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos" data-line="354"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free logo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Logo of a company, organization etc.&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-355"><a href="#L-355"><span class="linenos" data-line="355"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free seal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Official seal, coat of arms etc&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-356"><a href="#L-356"><span class="linenos" data-line="356"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free symbol&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Other official symbol&#39;</span><span class="p">]</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos" data-line="357"></span></a><span class="w">         </span><span class="p">],</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos" data-line="358"></span></a><span class="w">      </span><span class="s1">&#39;NFMiscLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos" data-line="359"></span></a><span class="w">         </span><span class="p">[</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos" data-line="360"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free fair use in&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;something else (please describe in description field on top)&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-361"><a href="#L-361"><span class="linenos" data-line="361"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free historic image&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Historic photograph&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-362"><a href="#L-362"><span class="linenos" data-line="362"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free 2D art&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2-dimensional artwork (painting, drawing etc.)&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-363"><a href="#L-363"><span class="linenos" data-line="363"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free currency&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Depiction of currency (banknotes, coins etc.)&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-364"><a href="#L-364"><span class="linenos" data-line="364"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free architectural work&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Architectural work&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-365"><a href="#L-365"><span class="linenos" data-line="365"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free 3D art&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Other 3-dimensional creative work (sculpture etc.)&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-366"><a href="#L-366"><span class="linenos" data-line="366"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free book cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover page of a book&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-367"><a href="#L-367"><span class="linenos" data-line="367"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free album cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a sound recording(album, single, song, CD)&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-368"><a href="#L-368"><span class="linenos" data-line="368"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free game cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a video/computer game&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-369"><a href="#L-369"><span class="linenos" data-line="369"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free magazine cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover page of a magazine&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-370"><a href="#L-370"><span class="linenos" data-line="370"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a video&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-371"><a href="#L-371"><span class="linenos" data-line="371"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free software cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of a software product&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-372"><a href="#L-372"><span class="linenos" data-line="372"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free product cover&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Cover of some commercial product&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-373"><a href="#L-373"><span class="linenos" data-line="373"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free title-card&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Title screen of a TV programme&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-374"><a href="#L-374"><span class="linenos" data-line="374"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free movie poster&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Movie poster&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-375"><a href="#L-375"><span class="linenos" data-line="375"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free poster&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Official poster of an event&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-376"><a href="#L-376"><span class="linenos" data-line="376"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free television screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Television screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-377"><a href="#L-377"><span class="linenos" data-line="377"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free film screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Movie screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-378"><a href="#L-378"><span class="linenos" data-line="378"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free game screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Game screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-379"><a href="#L-379"><span class="linenos" data-line="379"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Video screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-380"><a href="#L-380"><span class="linenos" data-line="380"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free music video screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Music video screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-381"><a href="#L-381"><span class="linenos" data-line="381"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free software screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Software screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-382"><a href="#L-382"><span class="linenos" data-line="382"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free web screenshot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Website screenshot&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-383"><a href="#L-383"><span class="linenos" data-line="383"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free speech&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Audio excerpt from a speech&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-384"><a href="#L-384"><span class="linenos" data-line="384"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free audio sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sound sample of an audio recording&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-385"><a href="#L-385"><span class="linenos" data-line="385"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free video sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sample extract from a video&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-386"><a href="#L-386"><span class="linenos" data-line="386"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free sheet music&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sheet music representing a musical piece&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-387"><a href="#L-387"><span class="linenos" data-line="387"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free comic&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Panel from a comic, graphic novel, manga etc.&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-388"><a href="#L-388"><span class="linenos" data-line="388"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free computer icon&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Computer icon&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-389"><a href="#L-389"><span class="linenos" data-line="389"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free newspaper image&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Page from a newspaper&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-390"><a href="#L-390"><span class="linenos" data-line="390"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free logo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Logo of a company, organization etc.&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-391"><a href="#L-391"><span class="linenos" data-line="391"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free seal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Official seal, coat of arms etc&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-392"><a href="#L-392"><span class="linenos" data-line="392"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free symbol&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Other official symbol&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-393"><a href="#L-393"><span class="linenos" data-line="393"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free sports uniform&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sports uniform&#39;</span><span class="p">],</span><span class="w"> </span>
</span><span id="L-394"><a href="#L-394"><span class="linenos" data-line="394"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free stamp&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Stamp&#39;</span><span class="p">]</span><span class="w"> </span>
</span><span id="L-395"><a href="#L-395"><span class="linenos" data-line="395"></span></a><span class="w">         </span><span class="p">],</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos" data-line="396"></span></a><span class="w">      </span><span class="s1">&#39;NFExtraLicense&#39;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos" data-line="397"></span></a><span class="w">         </span><span class="p">[</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos" data-line="398"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;none&#39;</span><span class="p">],</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos" data-line="399"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Crown copyright and other governmental sources&#39;</span><span class="p">],</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos" data-line="400"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free Crown copyright&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;UK Crown Copyright&#39;</span><span class="p">],</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos" data-line="401"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free New Zealand Crown Copyright&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NZ Crown Copyright&#39;</span><span class="p">],</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos" data-line="402"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free Canadian Crown Copyright&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Canadian Crown Copyright&#39;</span><span class="p">],</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos" data-line="403"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free AUSPIC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;AUSPIC (Australian Parliament image database)&#39;</span><span class="p">],</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos" data-line="404"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free Philippines government&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Philippines government&#39;</span><span class="p">],</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos" data-line="405"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free Finnish Defence Forces&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Finnish Defence Forces&#39;</span><span class="p">],</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos" data-line="406"></span></a><span class="w">         </span><span class="p">[],</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos" data-line="407"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Other individual sources&#39;</span><span class="p">],</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos" data-line="408"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free Denver Public Library image&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Denver Public Library&#39;</span><span class="p">],</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos" data-line="409"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free ESA media&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ESA (European Space Agency)&#39;</span><span class="p">],</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos" data-line="410"></span></a><span class="w">         </span><span class="p">[],</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos" data-line="411"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Possibly public domain in other countries&#39;</span><span class="p">],</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos" data-line="412"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free Old-50&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Author died more than 50 years ago.&#39;</span><span class="p">],</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos" data-line="413"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free Old-70&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Author died more than 70 years ago.&#39;</span><span class="p">],</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos" data-line="414"></span></a><span class="w">         </span><span class="p">[],</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos" data-line="415"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Some permissions granted, but not completely free&#39;</span><span class="p">],</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos" data-line="416"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free promotional&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;From promotional press kit&#39;</span><span class="p">],</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos" data-line="417"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free file with no commercial use license&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Permission granted, but only for educational and/or non-commercial purposes&#39;</span><span class="p">],</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos" data-line="418"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free file with no derivative works license&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Permission granted, but no derivative works allowed&#39;</span><span class="p">],</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos" data-line="419"></span></a><span class="w">         </span><span class="p">[</span><span class="s1">&#39;Non-free with permission&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Permission granted, but only for Wikipedia&#39;</span><span class="p">],</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos" data-line="420"></span></a><span class="w">         </span><span class="p">[]</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos" data-line="421"></span></a><span class="w">         </span><span class="p">]</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos" data-line="422"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos" data-line="423"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">licenseLists</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos" data-line="424"></span></a><span class="w">      </span><span class="nx">fuwMakeSelection</span><span class="p">(</span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">licenseLists</span><span class="p">[</span><span class="nx">group</span><span class="p">]);</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos" data-line="425"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos" data-line="426"></span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos" data-line="427"></span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos" data-line="428"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">knownCommonsLicenses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos" data-line="429"></span></a><span class="w">      </span><span class="s1">&#39;self|GFDL|cc-by-sa-all|migration=redundant&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos" data-line="430"></span></a><span class="w">      </span><span class="s1">&#39;self|Cc-zero&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos" data-line="431"></span></a><span class="w">      </span><span class="s1">&#39;PD-self&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos" data-line="432"></span></a><span class="w">      </span><span class="s1">&#39;self|GFDL|cc-by-sa-4.0|migration=redundant&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos" data-line="433"></span></a><span class="w">      </span><span class="s1">&#39;self|GFDL|cc-by-4.0|migration=redundant&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos" data-line="434"></span></a><span class="w">      </span><span class="s1">&#39;self|GFDL|cc-by-sa-3.0|migration=redundant&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos" data-line="435"></span></a><span class="w">      </span><span class="s1">&#39;self|GFDL|cc-by-3.0|migration=redundant&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos" data-line="436"></span></a><span class="w">      </span><span class="s1">&#39;self|cc-by-sa-4.0&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos" data-line="437"></span></a><span class="w">      </span><span class="s1">&#39;self|cc-by-sa-3.0&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos" data-line="438"></span></a><span class="w">      </span><span class="s1">&#39;cc-by-sa-4.0&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos" data-line="439"></span></a><span class="w">      </span><span class="s1">&#39;cc-by-sa-3.0&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos" data-line="440"></span></a><span class="w">      </span><span class="s1">&#39;cc-by-sa-2.5&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos" data-line="441"></span></a><span class="w">      </span><span class="s1">&#39;cc-by-4.0&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos" data-line="442"></span></a><span class="w">      </span><span class="s1">&#39;cc-by-3.0&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos" data-line="443"></span></a><span class="w">      </span><span class="s1">&#39;cc-by-2.5&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos" data-line="444"></span></a><span class="w">      </span><span class="s1">&#39;FAL&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos" data-line="445"></span></a><span class="w">      </span><span class="s1">&#39;PD-old-100&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos" data-line="446"></span></a><span class="w">      </span><span class="s1">&#39;PD-old&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos" data-line="447"></span></a><span class="w">      </span><span class="s1">&#39;PD-Art&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos" data-line="448"></span></a><span class="w">      </span><span class="s1">&#39;PD-US&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos" data-line="449"></span></a><span class="w">      </span><span class="s1">&#39;PD-USGov&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos" data-line="450"></span></a><span class="w">      </span><span class="s1">&#39;PD-USGov-NASA&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos" data-line="451"></span></a><span class="w">      </span><span class="s1">&#39;PD-USGov-Military-Navy&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos" data-line="452"></span></a><span class="w">      </span><span class="s1">&#39;PD-ineligible&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos" data-line="453"></span></a><span class="w">      </span><span class="s1">&#39;Attribution&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos" data-line="454"></span></a><span class="w">      </span><span class="s1">&#39;Copyrighted free use&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos" data-line="455"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos" data-line="456"></span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos" data-line="457"></span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos" data-line="458"></span></a><span class="w">   </span><span class="c1">// textfields that don&#39;t react directly</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos" data-line="459"></span></a><span class="w">   </span><span class="c1">// to user input and are used only for assembling stuff:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos" data-line="460"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos" data-line="461"></span></a><span class="w">      </span><span class="nx">fuwMakeTextfield</span><span class="p">(</span><span class="s1">&#39;SandboxSummary&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span><span class="ow">void</span><span class="p">(</span><span class="mf">0</span><span class="p">);});</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos" data-line="462"></span></a><span class="w">      </span><span class="nx">fuwMakeTextarea</span><span class="p">(</span><span class="s1">&#39;SandboxText&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span><span class="ow">void</span><span class="p">(</span><span class="mf">0</span><span class="p">);});</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos" data-line="463"></span></a><span class="w">      </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;SandboxSummary&#39;</span><span class="p">).</span><span class="nx">disabled</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">;</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos" data-line="464"></span></a><span class="w">      </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;SandboxText&#39;</span><span class="p">).</span><span class="nx">disabled</span><span class="o">=</span><span class="s2">&quot;disabled&quot;</span><span class="p">;</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos" data-line="465"></span></a><span class="w">      </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;SandboxText&#39;</span><span class="p">).</span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">12</span><span class="p">;</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos" data-line="466"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos" data-line="467"></span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos" data-line="468"></span></a><span class="w">   </span><span class="c1">// set links to &quot;_blank&quot; target, so we don&#39;t accidentally leave the page,</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos" data-line="469"></span></a><span class="w">   </span><span class="c1">// because on some browsers that would destroy all the input the user has already entered</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos" data-line="470"></span></a><span class="w">   </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.fuwOutLink a&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos" data-line="471"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;_blank&#39;</span><span class="p">;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos" data-line="472"></span></a><span class="w">   </span><span class="p">});</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos" data-line="473"></span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos" data-line="474"></span></a><span class="w">   </span><span class="c1">// make main area visible</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos" data-line="475"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;UploadScriptArea&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos" data-line="476"></span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos" data-line="477"></span></a><span class="p">}</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos" data-line="478"></span></a><span class="c1">// ====================================== </span>
</span><span id="L-479"><a href="#L-479"><span class="linenos" data-line="479"></span></a><span class="c1">// end of fuwGlobal constructor function</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos" data-line="480"></span></a><span class="c1">// ======================================</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos" data-line="481"></span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos" data-line="482"></span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos" data-line="483"></span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos" data-line="484"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwRadioClick</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos" data-line="485"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">ev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">event</span><span class="p">;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos" data-line="486"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">ev</span><span class="p">.</span><span class="nx">srcElement</span><span class="p">;</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos" data-line="487"></span></a><span class="w">   </span><span class="c1">//alert(&#39;onclick event from &#39; + src + &#39; (&#39; + src.value + &#39;)&#39;);</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos" data-line="488"></span></a><span class="w">   </span><span class="nx">fuwUpdateOptions</span><span class="p">();</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos" data-line="489"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos" data-line="490"></span></a><span class="p">}</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos" data-line="491"></span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos" data-line="492"></span></a><span class="cm">/* </span>
</span><span id="L-493"><a href="#L-493"><span class="linenos" data-line="493"></span></a><span class="cm">* =============================================================</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos" data-line="494"></span></a><span class="cm">* function fuwUpdateOptions</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos" data-line="495"></span></a><span class="cm">* =============================================================</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos" data-line="496"></span></a><span class="cm">* This is the onchange event handler for most of the input</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos" data-line="497"></span></a><span class="cm">* elements in the main form. It changes visibility and disabled</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos" data-line="498"></span></a><span class="cm">* status for the various sections of the input form in response</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos" data-line="499"></span></a><span class="cm">* to which options are chosen.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos" data-line="500"></span></a><span class="cm">*/</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos" data-line="501"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwUpdateOptions</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos" data-line="502"></span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos" data-line="503"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">fuw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">;</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos" data-line="504"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">warn</span><span class="p">;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos" data-line="505"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos" data-line="506"></span></a><span class="w">   </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputFilename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#TargetForm input#file&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos" data-line="507"></span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos" data-line="508"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">widgets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">elements</span><span class="p">;</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos" data-line="509"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">widgets</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos" data-line="510"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">widgets</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos" data-line="511"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;radio&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos" data-line="512"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos" data-line="513"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos" data-line="514"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">vl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">checked</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nx">w</span><span class="p">.</span><span class="nx">disabled</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">fuwIsVisible</span><span class="p">(</span><span class="nx">w</span><span class="p">);</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos" data-line="515"></span></a><span class="w">         </span><span class="nx">opts</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">vl</span><span class="p">;</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos" data-line="516"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">vl</span><span class="p">)</span><span class="w"> </span><span class="nx">opts</span><span class="p">[</span><span class="nx">nm</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">id</span><span class="p">;</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos" data-line="517"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos" data-line="518"></span></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos" data-line="519"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos" data-line="520"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="nx">w</span><span class="p">.</span><span class="nx">disabled</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">fuwIsVisible</span><span class="p">(</span><span class="nx">w</span><span class="p">);</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos" data-line="521"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">active</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos" data-line="522"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="nx">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;checkbox&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">checked</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos" data-line="523"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span><span class="w">         </span>
</span><span id="L-524"><a href="#L-524"><span class="linenos" data-line="524"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos" data-line="525"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos" data-line="526"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos" data-line="527"></span></a><span class="w">   </span><span class="nx">opts</span><span class="p">.</span><span class="nx">MainOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">FreeOptions</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NonFreeOptions</span><span class="p">;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos" data-line="528"></span></a><span class="w">   </span>
</span><span id="L-529"><a href="#L-529"><span class="linenos" data-line="529"></span></a><span class="w">   </span><span class="c1">// some parts of the input form are re-used across sections</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos" data-line="530"></span></a><span class="w">   </span><span class="c1">// and must be moved into the currently active input section:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos" data-line="531"></span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos" data-line="532"></span></a><span class="w">   </span><span class="c1">// minimality section is shared between all NF sections</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos" data-line="533"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFMinimalitySection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFSubject&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos" data-line="534"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFMinimalitySection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNF3D&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos" data-line="535"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFMinimalitySection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFExcerpt&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos" data-line="536"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFMinimalitySection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFCover&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos" data-line="537"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFMinimalitySection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFLogo&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos" data-line="538"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFMinimalitySection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFPortrait&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos" data-line="539"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFMinimalitySection&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFMisc&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos" data-line="540"></span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos" data-line="541"></span></a><span class="w">   </span><span class="c1">// AnyOtherInfo section is shared between all</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos" data-line="542"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsOwnWork&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionOwnWork</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos" data-line="543"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsThirdParty&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos" data-line="544"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsFreeWebsite&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos" data-line="545"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsPDOld&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos" data-line="546"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsPDOther&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos" data-line="547"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFSubject&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos" data-line="548"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNF3D&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos" data-line="549"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFExcerpt&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos" data-line="550"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFCover&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos" data-line="551"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFLogo&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos" data-line="552"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFPortrait&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos" data-line="553"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;AnyOtherInfo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFMisc&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="p">);</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos" data-line="554"></span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos" data-line="555"></span></a><span class="w">   </span><span class="c1">// author input field is shared between all sections except &quot;Own Work&quot;.</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos" data-line="556"></span></a><span class="w">   </span><span class="c1">// (will serve for the immediate/photographic author, in those cases where there</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos" data-line="557"></span></a><span class="w">   </span><span class="c1">// are two author fields)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos" data-line="558"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderFreeWebsiteAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos" data-line="559"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPDOldAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos" data-line="560"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPDOtherAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos" data-line="561"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFSubjectAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos" data-line="562"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNF3DAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos" data-line="563"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFExcerptAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos" data-line="564"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFCoverAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos" data-line="565"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFPortraitAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos" data-line="566"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFMiscAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos" data-line="567"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderAuthor&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos" data-line="568"></span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos" data-line="569"></span></a><span class="w">   </span><span class="c1">// source input field is shared between all sections except &quot;Own Work&quot;.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos" data-line="570"></span></a><span class="w">   </span><span class="c1">// (will serve for immediate/web source, in those cases where there are two</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos" data-line="571"></span></a><span class="w">   </span><span class="c1">// source fields involved)</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos" data-line="572"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderFreeWebsiteSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos" data-line="573"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPDOldSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos" data-line="574"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPDOtherSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos" data-line="575"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFSubjectSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos" data-line="576"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNF3DSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos" data-line="577"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFExcerptSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos" data-line="578"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFCoverSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos" data-line="579"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFLogoSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos" data-line="580"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFPortraitSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos" data-line="581"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFMiscSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos" data-line="582"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderSource&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos" data-line="583"></span></a>
</span><span id="L-584"><a href="#L-584"><span class="linenos" data-line="584"></span></a><span class="w">   </span><span class="c1">// date input field is shared between all sections except &quot;Logo&quot;, which doesn&#39;t need it.</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos" data-line="585"></span></a><span class="w">   </span><span class="c1">// will serve for derived/photographic date in the case of 3D items</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos" data-line="586"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderFreeWebsiteDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos" data-line="587"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderThirdPartyDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos" data-line="588"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPDOldDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos" data-line="589"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPDOtherDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos" data-line="590"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFSubjectDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos" data-line="591"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNF3DDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos" data-line="592"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFExcerptDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos" data-line="593"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFCoverDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos" data-line="594"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFPortraitDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos" data-line="595"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFMiscDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos" data-line="596"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderDate&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos" data-line="597"></span></a><span class="w">   </span>
</span><span id="L-598"><a href="#L-598"><span class="linenos" data-line="598"></span></a><span class="w">   </span><span class="c1">// permission field is shared between ThirdParty and FreeWebsite sections</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos" data-line="599"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Permission&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderFreeWebsitePermission&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos" data-line="600"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Permission&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPermission&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos" data-line="601"></span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos" data-line="602"></span></a><span class="w">   </span><span class="c1">// publication field is shared between PDOld, NFPortrait and NFMisc</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos" data-line="603"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Publication&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFPortraitPublication&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos" data-line="604"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Publication&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFMiscPublication&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos" data-line="605"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;Publication&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderPublication&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos" data-line="606"></span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos" data-line="607"></span></a><span class="w">   </span><span class="c1">// Purpose, Commercial, Replaceable and ReplaceableText FUR fields are shared</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos" data-line="608"></span></a><span class="w">   </span><span class="c1">// between some but not all of the non-free sections</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos" data-line="609"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFPurpose&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFExcerptPurpose&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos" data-line="610"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFPurpose&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFPurpose&#39;</span><span class="p">);</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos" data-line="611"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFCommercial&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFPortraitCommercial&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos" data-line="612"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFCommercial&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFCommercial&#39;</span><span class="p">);</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos" data-line="613"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFReplaceable&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFPortraitReplaceable&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos" data-line="614"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFReplaceable&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFReplaceable&#39;</span><span class="p">);</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos" data-line="615"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFReplaceableText&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFExcerptReplaceable&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos" data-line="616"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;NFReplaceableText&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;placeholderNFReplaceableText&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos" data-line="617"></span></a>
</span><span id="L-618"><a href="#L-618"><span class="linenos" data-line="618"></span></a><span class="w">   </span><span class="c1">// submit button goes to Step1 if user has chosen a plain overwrite of an existing file,</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos" data-line="619"></span></a><span class="w">   </span><span class="c1">// and to the active section of Step3 if otherwise</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos" data-line="620"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;UploadScriptStep1&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageExists</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteSame</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos" data-line="621"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsOwnWork&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionOwnWork</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos" data-line="622"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsThirdParty&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos" data-line="623"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsFreeWebsite&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos" data-line="624"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsPDOld&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos" data-line="625"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsPDOther&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos" data-line="626"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFSubject&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos" data-line="627"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNF3D&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos" data-line="628"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFExcerpt&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos" data-line="629"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFCover&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos" data-line="630"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFLogo&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos" data-line="631"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;detailsNFPortrait&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos" data-line="632"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;fuwSubmit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;fuwSubmitHost&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos" data-line="633"></span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos" data-line="634"></span></a>
</span><span id="L-635"><a href="#L-635"><span class="linenos" data-line="635"></span></a><span class="w">   </span><span class="c1">// Show and hide warnings:</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos" data-line="636"></span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos" data-line="637"></span></a><span class="w">   </span><span class="c1">// filename-related warnings:</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos" data-line="638"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningIllegalChars&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">IllegalChars</span><span class="p">);</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos" data-line="639"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningBadFilename&#39;</span><span class="p">,</span><span class="w">  </span><span class="nx">warn</span><span class="p">.</span><span class="nx">BadFilename</span><span class="p">);</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos" data-line="640"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningImageOnCommons&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageOnCommons</span><span class="p">);</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos" data-line="641"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningImageExists&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageExists</span><span class="p">);</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos" data-line="642"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;warningImageThumb&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;warningImageOnCommons&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageOnCommons</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos" data-line="643"></span></a><span class="w">   </span><span class="nx">fuwMove</span><span class="p">(</span><span class="s1">&#39;warningImageThumb&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;warningImageExists&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos" data-line="644"></span></a>
</span><span id="L-645"><a href="#L-645"><span class="linenos" data-line="645"></span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos" data-line="646"></span></a><span class="w">   </span><span class="c1">// notices related to the top-level options:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos" data-line="647"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningWhyNotCommons&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFree</span><span class="p">);</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos" data-line="648"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningNF&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNonFree</span><span class="p">);</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos" data-line="649"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningNoGood&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNoGood</span><span class="p">);</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos" data-line="650"></span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos" data-line="651"></span></a><span class="w">   </span><span class="c1">// warnings related to non-free &quot;used in&quot; article</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos" data-line="652"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningNFArticleNotFound&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotFound</span><span class="p">);</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos" data-line="653"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningNFArticleNotMainspace&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotMainspace</span><span class="p">);</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos" data-line="654"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningUserspaceDraft&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">UserspaceDraft</span><span class="p">);</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos" data-line="655"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningNFArticleDab&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleDab</span><span class="p">);</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos" data-line="656"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;NFArticleOK&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleOK</span><span class="p">);</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos" data-line="657"></span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos" data-line="658"></span></a><span class="w">   </span><span class="c1">// warnings depending on user status:</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos" data-line="659"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">userStatus</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/problem|newbie|notAutoconfirmed/</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos" data-line="660"></span></a><span class="w">      </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningFreeWebsite&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">);</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos" data-line="661"></span></a><span class="w">      </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningOwnWork&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionOwnWork</span><span class="p">);</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos" data-line="662"></span></a><span class="w">      </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningPDOther&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="p">);</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos" data-line="663"></span></a><span class="w">      </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;warningNFSubject&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">);</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos" data-line="664"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos" data-line="665"></span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos" data-line="666"></span></a><span class="w">   </span><span class="c1">// hide main sections in case of intended plain overwrite:   </span>
</span><span id="L-667"><a href="#L-667"><span class="linenos" data-line="667"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;UploadScriptStep2&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageExists</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteSame</span><span class="p">));</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos" data-line="668"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;UploadScriptStep3&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageExists</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteSame</span><span class="p">));</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos" data-line="669"></span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos" data-line="670"></span></a><span class="w">   </span><span class="c1">// show/hide top-level options</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos" data-line="671"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsFreeStatus&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFree</span><span class="p">);</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos" data-line="672"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;sendToCommons&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFree</span><span class="p">);</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos" data-line="673"></span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos" data-line="674"></span></a><span class="w">   </span><span class="c1">// show/hide details sections</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos" data-line="675"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFArticle&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNonFree</span><span class="p">);</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos" data-line="676"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFWorkType&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNonFree</span><span class="p">);</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos" data-line="677"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsOwnWork&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionOwnWork</span><span class="p">);</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos" data-line="678"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsThirdParty&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="p">);</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos" data-line="679"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsFreeWebsite&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">);</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos" data-line="680"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsPDOld&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="p">);</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos" data-line="681"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsPDOther&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="p">);</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos" data-line="682"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFSubject&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="p">);</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos" data-line="683"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNF3D&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">);</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos" data-line="684"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFExcerpt&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="p">);</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos" data-line="685"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFCover&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="p">);</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos" data-line="686"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFLogo&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="p">);</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos" data-line="687"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFPortrait&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="p">);</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos" data-line="688"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;detailsNFMisc&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="p">);</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos" data-line="689"></span></a>
</span><span id="L-690"><a href="#L-690"><span class="linenos" data-line="690"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;EditSummaryDiv&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteSame</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteDifferent</span><span class="p">);</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos" data-line="691"></span></a>
</span><span id="L-692"><a href="#L-692"><span class="linenos" data-line="692"></span></a><span class="w">   </span><span class="c1">// set enabled/disabled</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos" data-line="693"></span></a><span class="w">   </span><span class="c1">// It might be useful to adapt this to be more liberal about</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos" data-line="694"></span></a><span class="w">   </span><span class="c1">// the order of input, at least for experienced users.</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos" data-line="695"></span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos" data-line="696"></span></a><span class="w">   </span><span class="c1">//fuwSetEnabled(&#39;Artist3D&#39;, opts.PD3D);</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos" data-line="697"></span></a><span class="w">   </span><span class="c1">//fuwSetEnabled(&#39;Country3D&#39;, opts.FOP3D);</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos" data-line="698"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;ThirdPartyEvidenceLink&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionLink</span><span class="p">);</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos" data-line="699"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;ThirdPartyOTRSTicket&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionOTRS</span><span class="p">);</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos" data-line="700"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;NFSubjectPurpose&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectCheckDiscussed</span><span class="p">);</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos" data-line="701"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;NF3DPurpose&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DCheckDiscussed</span><span class="p">);</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos" data-line="702"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;NF3DPermission&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DOptionFree</span><span class="p">);</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos" data-line="703"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;USGovLicense&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherUSGov</span><span class="p">);</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos" data-line="704"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;PDOfficialPermission&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOfficial</span><span class="p">);</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos" data-line="705"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;IneligibleLicense&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherSimple</span><span class="p">);</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos" data-line="706"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;PDOtherPermission&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOther</span><span class="p">);</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos" data-line="707"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;AnyOther&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos" data-line="708"></span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos" data-line="709"></span></a><span class="w">   </span><span class="c1">// need to re-collect the remaining (non-radiobutton) input into the opts object again,</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos" data-line="710"></span></a><span class="w">   </span><span class="c1">// preparing for validation:</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos" data-line="711"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">widgets</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos" data-line="712"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">widgets</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos" data-line="713"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos" data-line="714"></span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos" data-line="715"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;radio&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos" data-line="716"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos" data-line="717"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="nx">w</span><span class="p">.</span><span class="nx">disabled</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">fuwIsVisible</span><span class="p">(</span><span class="nx">w</span><span class="p">);</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos" data-line="718"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">active</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos" data-line="719"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="nx">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;checkbox&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">checked</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">w</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos" data-line="720"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span><span class="w">         </span>
</span><span id="L-721"><a href="#L-721"><span class="linenos" data-line="721"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos" data-line="722"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos" data-line="723"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos" data-line="724"></span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos" data-line="725"></span></a><span class="w">   </span><span class="c1">// final step of validation: check if input is sufficient for</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos" data-line="726"></span></a><span class="w">   </span><span class="c1">// setting the submit buttons active</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos" data-line="727"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">validateInput</span><span class="p">();</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos" data-line="728"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">validForCommons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFree</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteSame</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteDifferent</span><span class="p">)</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos" data-line="729"></span></a><span class="w">         </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionNone</span><span class="p">;</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos" data-line="730"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;sendToCommons&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFree</span><span class="p">);</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos" data-line="731"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;CommonsButton&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">validForCommons</span><span class="p">);</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos" data-line="732"></span></a><span class="w">   </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;fuwSubmitText&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFree</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-733"><a href="#L-733"><span class="linenos" data-line="733"></span></a><span class="w">         </span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;No&lt;/b&gt;, I want to upload this file here on this wiki only.&lt;br/&gt;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-734"><a href="#L-734"><span class="linenos" data-line="734"></span></a><span class="w">          </span><span class="s2">&quot;&lt;small&gt;This way it can be used only on the English Wikipedia. However, somebody &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos" data-line="735"></span></a><span class="w">          </span><span class="s2">&quot;else might still decide to copy it to Commons or use it elsewhere later. If you &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos" data-line="736"></span></a><span class="w">          </span><span class="s2">&quot;do not want your file to be copied to Commons and deleted locally, consider adding &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos" data-line="737"></span></a><span class="w">          </span><span class="s2">&quot;{{tl|Keep local}}.&lt;/small&gt;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos" data-line="738"></span></a><span class="w">         </span><span class="s2">&quot;Upload this file.&quot;</span><span class="p">;</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos" data-line="739"></span></a><span class="w">   </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;SubmitButton&#39;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">validForCommons</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;Upload locally&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Upload&quot;</span><span class="p">;</span><span class="w">   </span>
</span><span id="L-740"><a href="#L-740"><span class="linenos" data-line="740"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;EditSummary&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos" data-line="741"></span></a><span class="w">   </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;SubmitButton&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;notAutoconfirmed&#39;</span><span class="p">));</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos" data-line="742"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos" data-line="743"></span></a><span class="w">      </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="s1">&#39;SandboxButton&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">valid</span><span class="p">);</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos" data-line="744"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos" data-line="745"></span></a>
</span><span id="L-746"><a href="#L-746"><span class="linenos" data-line="746"></span></a><span class="w">   </span><span class="c1">// if we&#39;re in testing mode, update the Sandbox display fields</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos" data-line="747"></span></a><span class="w">   </span><span class="c1">// after each input change. In normal mode, collectInput() will</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos" data-line="748"></span></a><span class="w">   </span><span class="c1">// only be needed on submit.</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos" data-line="749"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos" data-line="750"></span></a><span class="w">      </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">collectInput</span><span class="p">();</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos" data-line="751"></span></a><span class="w">      </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">formatOutput</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos" data-line="752"></span></a><span class="w">      </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;placeholderTestForm&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos" data-line="753"></span></a><span class="w">   </span><span class="p">}</span><span class="w">  </span>
</span><span id="L-754"><a href="#L-754"><span class="linenos" data-line="754"></span></a><span class="p">}</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos" data-line="755"></span></a>
</span><span id="L-756"><a href="#L-756"><span class="linenos" data-line="756"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos" data-line="757"></span></a><span class="c1">// methods of the global fuw object</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos" data-line="758"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos" data-line="759"></span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos" data-line="760"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos" data-line="761"></span></a><span class="c1">// report validation status of filename information</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos" data-line="762"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos" data-line="763"></span></a><span class="c1">// This is called from within fuw.validateInput(), i.e. every</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos" data-line="764"></span></a><span class="c1">// time anything in the whole form is changed. It only reports</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos" data-line="765"></span></a><span class="c1">// results that have previously been cached in the opts and warn</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos" data-line="766"></span></a><span class="c1">// objects. The actual checking is done in the event handler</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos" data-line="767"></span></a><span class="c1">// of the file input boxes.</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos" data-line="768"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasValidFilename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos" data-line="769"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos" data-line="770"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">warn</span><span class="p">;</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos" data-line="771"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">=</span><span class="w">   </span>
</span><span id="L-772"><a href="#L-772"><span class="linenos" data-line="772"></span></a><span class="w">      </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputName</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos" data-line="773"></span></a><span class="w">      </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputFilename</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos" data-line="774"></span></a><span class="w">      </span><span class="o">!</span><span class="nx">warn</span><span class="p">.</span><span class="nx">BadFilename</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos" data-line="775"></span></a><span class="w">      </span><span class="o">!</span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageOnCommons</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos" data-line="776"></span></a><span class="w">      </span><span class="c1">// if image exists on enwiki, accept only if user has confirmed overwrite:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos" data-line="777"></span></a><span class="w">      </span><span class="o">!</span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageExists</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteSame</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteDifferent</span><span class="p">));</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos" data-line="778"></span></a><span class="w">   </span><span class="c1">//alert(&quot;HasValidFilename: &quot; + valid);</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos" data-line="779"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">valid</span><span class="p">;</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos" data-line="780"></span></a><span class="p">};</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos" data-line="781"></span></a>
</span><span id="L-782"><a href="#L-782"><span class="linenos" data-line="782"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos" data-line="783"></span></a><span class="c1">// validation status for common input elements for all free</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos" data-line="784"></span></a><span class="c1">// options</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos" data-line="785"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos" data-line="786"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasValidCommonFreeInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos" data-line="787"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos" data-line="788"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">warn</span><span class="p">;</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos" data-line="789"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputDesc</span><span class="p">;</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos" data-line="790"></span></a><span class="w">   </span><span class="c1">//alert(&quot;HasValidCommonFreeInput: &quot; + valid);</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos" data-line="791"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">valid</span><span class="p">;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos" data-line="792"></span></a><span class="p">};</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos" data-line="793"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos" data-line="794"></span></a><span class="c1">// validation status for common input elements for all non-free</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos" data-line="795"></span></a><span class="c1">// options</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos" data-line="796"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos" data-line="797"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasValidCommonNFInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos" data-line="798"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos" data-line="799"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">warn</span><span class="p">;</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos" data-line="800"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">=</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos" data-line="801"></span></a><span class="w">      </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNonFree</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos" data-line="802"></span></a><span class="w">      </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputDesc</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
</span><span id="L-803"><a href="#L-803"><span class="linenos" data-line="803"></span></a><span class="w">      </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFArticle</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos" data-line="804"></span></a><span class="w">      </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos" data-line="805"></span></a><span class="w">      </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFMinimality</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos" data-line="806"></span></a><span class="w">      </span><span class="o">!</span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotFound</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos" data-line="807"></span></a><span class="w">      </span><span class="o">!</span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotMainspace</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos" data-line="808"></span></a><span class="w">      </span><span class="o">!</span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleDab</span><span class="p">;</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos" data-line="809"></span></a><span class="w">   </span><span class="c1">//alert(&quot;hasValidCommonNFInput: &quot; + valid);</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos" data-line="810"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">valid</span><span class="p">;</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos" data-line="811"></span></a><span class="p">};</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos" data-line="812"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos" data-line="813"></span></a><span class="c1">// Main validation routine. Modify this to tweak which fields</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos" data-line="814"></span></a><span class="c1">// are to be considered obligatory for each case group</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos" data-line="815"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos" data-line="816"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">validateInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos" data-line="817"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos" data-line="818"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">warn</span><span class="p">;</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos" data-line="819"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos" data-line="820"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">hasValidFilename</span><span class="p">()</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos" data-line="821"></span></a><span class="w">      </span><span class="o">&amp;&amp;</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos" data-line="822"></span></a><span class="w">      </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteDifferent</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">EditSummary</span><span class="p">))</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos" data-line="823"></span></a><span class="w">      </span><span class="o">&amp;&amp;</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos" data-line="824"></span></a><span class="w">      </span><span class="p">(</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos" data-line="825"></span></a><span class="w">       </span><span class="p">(</span><span class="w"> </span><span class="c1">// overwriting is okay if there is an edit summary</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos" data-line="826"></span></a><span class="w">        </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteSame</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">EditSummary</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos" data-line="827"></span></a><span class="w">       </span><span class="p">)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos" data-line="828"></span></a><span class="w">       </span><span class="o">||</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos" data-line="829"></span></a><span class="w">       </span><span class="p">(</span><span class="w"> </span><span class="c1">// free options</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos" data-line="830"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">hasValidCommonFreeInput</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos" data-line="831"></span></a><span class="w">         </span><span class="p">(</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos" data-line="832"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionOwnWork</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos" data-line="833"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nb">Date</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos" data-line="834"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OwnWorkLicense</span><span class="p">)</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos" data-line="835"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos" data-line="836"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos" data-line="837"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos" data-line="838"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos" data-line="839"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Permission</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos" data-line="840"></span></a><span class="w">           </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyOtherLicense</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyLicense</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos" data-line="841"></span></a><span class="w">           </span><span class="p">((</span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionLink</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceLink</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos" data-line="842"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionOTRS</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos" data-line="843"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionOTRSForthcoming</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos" data-line="844"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionNone</span><span class="p">))</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos" data-line="845"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos" data-line="846"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos" data-line="847"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos" data-line="848"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos" data-line="849"></span></a><span class="w">           </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">FreeWebsiteOtherLicense</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">FreeWebsiteLicense</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos" data-line="850"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Permission</span><span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos" data-line="851"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos" data-line="852"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos" data-line="853"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos" data-line="854"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldAuthorLifetime</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos" data-line="855"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Publication</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos" data-line="856"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nb">Date</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos" data-line="857"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos" data-line="858"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldOptions</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
</span><span id="L-859"><a href="#L-859"><span class="linenos" data-line="859"></span></a><span class="w">           </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldOther</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldPermission</span><span class="p">)))</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos" data-line="860"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos" data-line="861"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos" data-line="862"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos" data-line="863"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos" data-line="864"></span></a><span class="w">           </span><span class="p">((</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherUSGov</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">USGovLicense</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos" data-line="865"></span></a><span class="w">            </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOfficial</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOfficialPermission</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos" data-line="866"></span></a><span class="w">            </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherSimple</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">IneligibleLicense</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos" data-line="867"></span></a><span class="w">            </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOther</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherPermission</span><span class="p">)))</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos" data-line="868"></span></a><span class="w">        </span><span class="p">)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos" data-line="869"></span></a><span class="w">       </span><span class="p">)</span><span class="w"> </span><span class="c1">// end of free options</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos" data-line="870"></span></a><span class="w">       </span><span class="o">||</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos" data-line="871"></span></a><span class="w">       </span><span class="p">(</span><span class="w"> </span><span class="c1">// non-free options</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos" data-line="872"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">hasValidCommonNFInput</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos" data-line="873"></span></a><span class="w">         </span><span class="p">(</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos" data-line="874"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos" data-line="875"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectLicense</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos" data-line="876"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos" data-line="877"></span></a><span class="w">           </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectCheckDedicated</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos" data-line="878"></span></a><span class="w">           </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectCheckDiscussed</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectPurpose</span><span class="p">)))</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos" data-line="879"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos" data-line="880"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos" data-line="881"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DLicense</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos" data-line="882"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DCreator</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos" data-line="883"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos" data-line="884"></span></a><span class="w">           </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DOptionSame</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos" data-line="885"></span></a><span class="w">           </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DOptionFree</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DPermission</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
</span><span id="L-886"><a href="#L-886"><span class="linenos" data-line="886"></span></a><span class="w">           </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DCheckDedicated</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos" data-line="887"></span></a><span class="w">            </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DCheckDiscussed</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DPurpose</span><span class="p">)))</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos" data-line="888"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos" data-line="889"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos" data-line="890"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFExcerptLicense</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos" data-line="891"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos" data-line="892"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFPurpose</span><span class="p">)</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos" data-line="893"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos" data-line="894"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos" data-line="895"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFCoverLicense</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos" data-line="896"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos" data-line="897"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFCoverCheckDedicated</span><span class="w"> </span>
</span><span id="L-898"><a href="#L-898"><span class="linenos" data-line="898"></span></a><span class="w">          </span><span class="p">)</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos" data-line="899"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos" data-line="900"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos" data-line="901"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFLogoLicense</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos" data-line="902"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFLogoCheckDedicated</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos" data-line="903"></span></a><span class="w">          </span><span class="p">)</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos" data-line="904"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos" data-line="905"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos" data-line="906"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Publication</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos" data-line="907"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFPortraitDeceased</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos" data-line="908"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos" data-line="909"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFPortraitCheckDedicated</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos" data-line="910"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFReplaceable</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos" data-line="911"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFCommercial</span><span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos" data-line="912"></span></a><span class="w">          </span><span class="o">||</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos" data-line="913"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos" data-line="914"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFMiscLicense</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos" data-line="915"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos" data-line="916"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Publication</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos" data-line="917"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFPurpose</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos" data-line="918"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFReplaceableText</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos" data-line="919"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFReplaceable</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos" data-line="920"></span></a><span class="w">           </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFCommercial</span><span class="p">)</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos" data-line="921"></span></a><span class="w">         </span><span class="p">)</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos" data-line="922"></span></a><span class="w">       </span><span class="p">)</span><span class="w"> </span><span class="c1">// end of non-free options</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos" data-line="923"></span></a><span class="w">      </span><span class="p">)</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos" data-line="924"></span></a><span class="w">   </span><span class="p">);</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos" data-line="925"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">valid</span><span class="p">;</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos" data-line="926"></span></a><span class="p">};</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos" data-line="927"></span></a>
</span><span id="L-928"><a href="#L-928"><span class="linenos" data-line="928"></span></a><span class="c1">// =============================================================</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos" data-line="929"></span></a><span class="c1">// return which template name will be used as the main</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos" data-line="930"></span></a><span class="c1">// description template</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos" data-line="931"></span></a><span class="c1">// =============================================================</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos" data-line="932"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getDescriptionTemplateName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos" data-line="933"></span></a><span class="w">   </span><span class="c1">// standard &quot;Information&quot; template for free files:</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos" data-line="934"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFree</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;Information&quot;</span><span class="p">;</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos" data-line="935"></span></a><span class="w">   </span><span class="c1">// experimental new version of fair-use rationale template,</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos" data-line="936"></span></a><span class="w">   </span><span class="c1">// designed to fit the fields used in the wizard</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos" data-line="937"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNonFree</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;Non-free use rationale 2&quot;</span><span class="p">;</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos" data-line="938"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="kc">undefined</span><span class="p">;</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos" data-line="939"></span></a><span class="p">};</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos" data-line="940"></span></a>
</span><span id="L-941"><a href="#L-941"><span class="linenos" data-line="941"></span></a><span class="c1">// =============================================================</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos" data-line="942"></span></a><span class="c1">// get the license tag code from the appropriate input element</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos" data-line="943"></span></a><span class="c1">// =============================================================</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos" data-line="944"></span></a>
</span><span id="L-945"><a href="#L-945"><span class="linenos" data-line="945"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getStandardLicense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos" data-line="946"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos" data-line="947"></span></a><span class="w">   </span>
</span><span id="L-948"><a href="#L-948"><span class="linenos" data-line="948"></span></a><span class="p">}</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos" data-line="949"></span></a>
</span><span id="L-950"><a href="#L-950"><span class="linenos" data-line="950"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getLicense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos" data-line="951"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos" data-line="952"></span></a><span class="w">      </span><span class="c1">// ThirdParty and FreeWebsite have alternative input fields</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos" data-line="953"></span></a><span class="w">      </span><span class="c1">// for manual entry of other licenses:</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos" data-line="954"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">license</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos" data-line="955"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOther</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldOther</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos" data-line="956"></span></a><span class="w">      </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOther</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherPermission</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldPermission</span><span class="p">;</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos" data-line="957"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\s*\{\{.+\}\}\s*$/</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos" data-line="958"></span></a><span class="w">         </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;{{PD-because|&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;}}&#39;</span><span class="p">;</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos" data-line="959"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos" data-line="960"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos" data-line="961"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos" data-line="962"></span></a><span class="w">      </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="L-963"><a href="#L-963"><span class="linenos" data-line="963"></span></a><span class="w">         </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyOtherLicense</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>
</span><span id="L-964"><a href="#L-964"><span class="linenos" data-line="964"></span></a><span class="w">         </span><span class="nx">opts</span><span class="p">.</span><span class="nx">FreeWebsiteOtherLicense</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos" data-line="965"></span></a><span class="w">         </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOfficial</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;{{PD-because|official item legally exempt from copyright in its country of origin}}&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos" data-line="966"></span></a><span class="w">         </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;{{Non-free biog-pic|&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFArticle</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;}}&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos" data-line="967"></span></a><span class="w">   </span><span class="p">}</span><span class="w">   </span>
</span><span id="L-968"><a href="#L-968"><span class="linenos" data-line="968"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos" data-line="969"></span></a><span class="w">      </span><span class="c1">// standard, non-parametrized tag licenses from dropdownbox.</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos" data-line="970"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">simpleLicense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionOwnWork</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OwnWorkLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos" data-line="971"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos" data-line="972"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">FreeWebsiteLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos" data-line="973"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos" data-line="974"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos" data-line="975"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFExcerptLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos" data-line="976"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFCoverLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos" data-line="977"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFLogoLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos" data-line="978"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFMiscLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos" data-line="979"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherUSGov</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">USGovLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos" data-line="980"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherSimple</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">IneligibleLicense</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos" data-line="981"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDUSExpired</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;PD-US-expired&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos" data-line="982"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDURAA</span><span class="w">   </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;PD-URAA&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos" data-line="983"></span></a><span class="w">          </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDFormality</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;PD-US&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos" data-line="984"></span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos" data-line="985"></span></a><span class="w">       </span><span class="c1">// &quot;PD-author&quot; needs parameter, at least on Commons</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos" data-line="986"></span></a><span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">simpleLicense</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;PD-author&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos" data-line="987"></span></a><span class="w">          </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;{{PD-author|&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;}}&#39;</span><span class="p">;</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos" data-line="988"></span></a><span class="w">       </span><span class="p">}</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos" data-line="989"></span></a><span class="w">       </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">knownCommonsLicenses</span><span class="p">[</span><span class="nx">simpleLicense</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos" data-line="990"></span></a><span class="w">       </span><span class="c1">// make sure we send only those licenses as &quot;standard&quot; licenses</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos" data-line="991"></span></a><span class="w">       </span><span class="c1">// that exist in the Commons license dropdown box</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos" data-line="992"></span></a><span class="w">          </span><span class="nx">license</span><span class="p">.</span><span class="nx">standard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">simpleLicense</span><span class="p">;</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos" data-line="993"></span></a><span class="w">       </span><span class="p">}</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos" data-line="994"></span></a><span class="w">       </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos" data-line="995"></span></a><span class="w">          </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;\{\{&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">simpleLicense</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;\}\}&#39;</span><span class="p">;</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos" data-line="996"></span></a><span class="w">       </span><span class="p">}</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos" data-line="997"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos" data-line="998"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">license</span><span class="p">;</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos" data-line="999"></span></a><span class="p">};</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos" data-line="1000"></span></a>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos" data-line="1001"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="nx">template</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos" data-line="1002"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;{{subst:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">template</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;}}&#39;</span><span class="p">;</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos" data-line="1003"></span></a><span class="p">}</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos" data-line="1004"></span></a>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos" data-line="1005"></span></a><span class="c1">// ===================================================================</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos" data-line="1006"></span></a><span class="c1">// Produce code for local tracking categories</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos" data-line="1007"></span></a><span class="c1">// ===================================================================</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos" data-line="1008"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getTrackingCategory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos" data-line="1009"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos" data-line="1010"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos" data-line="1011"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Files from freely licensed external sources&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos" data-line="1012"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Files licensed by third parties&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos" data-line="1013"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOther</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldOther</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Files with non-standard public domain statements&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos" data-line="1014"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Non-free files uploaded as object of commentary&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos" data-line="1015"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">cat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos" data-line="1016"></span></a><span class="w">      </span><span class="nx">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;\n\{\{Category ordered by date|&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;|&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos" data-line="1017"></span></a><span class="w">      </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTYEAR&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;|&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTMONTH&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;|&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTDAY2&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\}\}&quot;</span><span class="p">;</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos" data-line="1018"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos" data-line="1019"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">cat</span><span class="p">;</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos" data-line="1020"></span></a><span class="p">};</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos" data-line="1021"></span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos" data-line="1022"></span></a><span class="c1">// ===================================================================</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos" data-line="1023"></span></a><span class="c1">// Get or create an edit summary for the upload</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos" data-line="1024"></span></a><span class="c1">// ===================================================================</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos" data-line="1025"></span></a><span class="c1">// Note: if we work with the api.php interface, we can have separate</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos" data-line="1026"></span></a><span class="c1">// data for the edit summary and the description page, which is far</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos" data-line="1027"></span></a><span class="c1">// better than the way the index.php interface does it.</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos" data-line="1028"></span></a><span class="c1">// TO DO: need to actually define an input element for a manually</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos" data-line="1029"></span></a><span class="c1">// entered edit summary. Must be obligatory when overwriting files.</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos" data-line="1030"></span></a><span class="c1">// In other cases we&#39;ll use an automatic edit summary.</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos" data-line="1031"></span></a><span class="c1">// ===================================================================</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos" data-line="1032"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getEditSummary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos" data-line="1033"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos" data-line="1034"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos" data-line="1035"></span></a><span class="w">      </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">EditSummary</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">EditSummary</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; ([[&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgPageName&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;|File Upload Wizard]])&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="o">||</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos" data-line="1036"></span></a><span class="w">      </span><span class="p">(</span><span class="s2">&quot;Uploading &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos" data-line="1037"></span></a><span class="w">       </span><span class="p">(</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos" data-line="1038"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionOwnWork</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a self-made file &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos" data-line="1039"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionThirdParty</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a free file from somebody else &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos" data-line="1040"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionFreeWebsite</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a file from a free published source &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos" data-line="1041"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOld</span><span class="w">       </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;an old public-domain work &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos" data-line="1042"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionPDOther</span><span class="w">     </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a public-domain item &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos" data-line="1043"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFSubject</span><span class="w">   </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a non-free work, as object of commentary &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos" data-line="1044"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNF3D</span><span class="w">        </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a depiction of a non-free 3D artwork &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos" data-line="1045"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFExcerpt</span><span class="w">   </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;an excerpt from a non-free work &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos" data-line="1046"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFCover</span><span class="w">     </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a piece of non-free cover art &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos" data-line="1047"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFLogo</span><span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a non-free logo &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos" data-line="1048"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFPortrait</span><span class="w">    </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a non-free historic portrait &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos" data-line="1049"></span></a><span class="w">        </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNFMisc</span><span class="w">      </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;a non-free file &#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos" data-line="1050"></span></a><span class="w">       </span><span class="p">)</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos" data-line="1051"></span></a><span class="w">       </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos" data-line="1052"></span></a><span class="w">       </span><span class="p">(</span><span class="s2">&quot;using [[&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgPageName&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;|File Upload Wizard]]&quot;</span><span class="p">)</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos" data-line="1053"></span></a><span class="w">      </span><span class="p">));</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos" data-line="1054"></span></a><span class="p">};</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos" data-line="1055"></span></a>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos" data-line="1056"></span></a>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos" data-line="1057"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwPackInfo</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="nx">forCommons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos" data-line="1058"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">forCommons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos" data-line="1059"></span></a><span class="w">      </span><span class="c1">// reformat wikilinks embedded in description fields to adapt them for Commons</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos" data-line="1060"></span></a><span class="w">      </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\[\[([^\]]+)\]\]/g</span><span class="p">,</span><span class="w"> </span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos" data-line="1061"></span></a><span class="w">         </span><span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span><span class="w"> </span><span class="nx">p1</span><span class="p">,</span><span class="w"> </span><span class="nx">offset</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos" data-line="1062"></span></a>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos" data-line="1063"></span></a><span class="w">            </span><span class="c1">// mark File links as local</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos" data-line="1064"></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">p1</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^:(File|Image):/</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos" data-line="1065"></span></a><span class="w">               </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;[[:en&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;]]&quot;</span><span class="p">;</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos" data-line="1066"></span></a><span class="w">            </span><span class="p">}</span><span class="w">      </span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos" data-line="1067"></span></a><span class="w">            </span><span class="c1">// leave prefixed links unchanged:</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos" data-line="1068"></span></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">p1</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^:[\w\-]+:/</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos" data-line="1069"></span></a><span class="w">               </span><span class="k">return</span><span class="w"> </span><span class="nx">str</span><span class="p">;</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos" data-line="1070"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos" data-line="1071"></span></a><span class="w">            </span><span class="c1">// if the link is piped, add a prefix only</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos" data-line="1072"></span></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">p1</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/.+\|/</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos" data-line="1073"></span></a><span class="w">               </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;[[:en:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;]]&quot;</span><span class="p">;</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos" data-line="1074"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos" data-line="1075"></span></a><span class="w">            </span><span class="c1">// introduce a pipe</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos" data-line="1076"></span></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos" data-line="1077"></span></a><span class="w">               </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;[[:en:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;|&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;]]&quot;</span><span class="p">;</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos" data-line="1078"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos" data-line="1079"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos" data-line="1080"></span></a><span class="w">      </span><span class="p">);</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos" data-line="1081"></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;{{en|&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;}}&quot;</span><span class="p">;</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos" data-line="1082"></span></a><span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos" data-line="1083"></span></a><span class="p">}</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos" data-line="1084"></span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos" data-line="1085"></span></a><span class="c1">// ================================================================</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos" data-line="1086"></span></a><span class="c1">// This is the main method called by the event handler for the </span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos" data-line="1087"></span></a><span class="c1">// (experimental) submit button. Its main task is to collect the </span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos" data-line="1088"></span></a><span class="c1">// input into a single string of wikitext for the description page.</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos" data-line="1089"></span></a><span class="c1">// ================================================================</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos" data-line="1090"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">collectInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos" data-line="1091"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos" data-line="1092"></span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos" data-line="1093"></span></a><span class="w">   </span><span class="c1">// object representing template fields for filling in</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos" data-line="1094"></span></a><span class="w">   </span><span class="c1">// the description template. Pre-loaded with some</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos" data-line="1095"></span></a><span class="w">   </span><span class="c1">// standard settings:</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos" data-line="1096"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">descFields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">descFields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos" data-line="1097"></span></a><span class="w">      </span><span class="s1">&#39;Description&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputDesc</span><span class="p">,</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos" data-line="1098"></span></a><span class="w">      </span><span class="s1">&#39;Author&#39;</span><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="p">,</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos" data-line="1099"></span></a><span class="w">      </span><span class="s1">&#39;Date&#39;</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nb">Date</span><span class="p">,</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos" data-line="1100"></span></a><span class="w">      </span><span class="s1">&#39;Source&#39;</span><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos" data-line="1101"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos" data-line="1102"></span></a><span class="w">   </span><span class="c1">// &quot;other information&quot; (outside the template)</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos" data-line="1103"></span></a><span class="w">   </span><span class="k">this</span><span class="p">.</span><span class="nx">otherInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos" data-line="1104"></span></a><span class="w">   </span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos" data-line="1105"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNonFree</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos" data-line="1106"></span></a><span class="w">      </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Article</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFArticle</span><span class="p">;</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos" data-line="1107"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos" data-line="1108"></span></a><span class="w">   </span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos" data-line="1109"></span></a><span class="w">   </span><span class="c1">// add/modify option-specific fields:</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos" data-line="1110"></span></a><span class="w">   </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">MainOption</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos" data-line="1111"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionOwnWork&#39;</span><span class="o">:</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos" data-line="1112"></span></a><span class="w">      </span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos" data-line="1113"></span></a><span class="w">         </span><span class="c1">// use standard &quot;source&quot; field for optional &quot;how created?&quot; and </span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos" data-line="1114"></span></a><span class="w">         </span><span class="c1">// &quot;previously published&quot; input fields.</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos" data-line="1115"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos" data-line="1116"></span></a><span class="w">            </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OwnWorkCreation</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;{{own}}&quot;</span><span class="p">),</span><span class="w"> </span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos" data-line="1117"></span></a><span class="w">            </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span><span class="w"> </span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos" data-line="1118"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Previously published:&#39;&#39;&#39; &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">OwnWorkPublication</span><span class="p">)]);</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos" data-line="1119"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos" data-line="1120"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;[[User:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">username</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">username</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;]]&#39;</span><span class="p">;</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos" data-line="1121"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos" data-line="1122"></span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos" data-line="1123"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionThirdParty&#39;</span><span class="o">:</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos" data-line="1124"></span></a><span class="w">      </span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos" data-line="1125"></span></a><span class="w">         </span><span class="c1">// use standard &quot;permission&quot; field for a compilation of the</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos" data-line="1126"></span></a><span class="w">         </span><span class="c1">// &quot;permission&quot; input field and the various &quot;evidence&quot; options</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos" data-line="1127"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">evidence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos" data-line="1128"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionLink</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos" data-line="1129"></span></a><span class="w">               </span><span class="p">(</span><span class="s2">&quot;The license statement can be found online at: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceLink</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos" data-line="1130"></span></a><span class="w">               </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionOTRS</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos" data-line="1131"></span></a><span class="w">               </span><span class="p">(</span><span class="s2">&quot;The license agreement has been forwarded to OTRS.&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos" data-line="1132"></span></a><span class="w">                  </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot; Ticket: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyOTRSTicket</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\{\{OTRS pending|year=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTYEAR&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos" data-line="1133"></span></a><span class="w">                                                                              </span><span class="s2">&quot;|month=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTMONTH&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos" data-line="1134"></span></a><span class="w">                                                                              </span><span class="s2">&quot;|day=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTDAY2&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\}\}&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos" data-line="1135"></span></a><span class="w">               </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionOTRSForthcoming</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos" data-line="1136"></span></a><span class="w">               </span><span class="s2">&quot;The license agreement will be forwarded to OTRS shortly. \{\{OTRS pending|year=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTYEAR&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos" data-line="1137"></span></a><span class="w">                                                                              </span><span class="s2">&quot;|month=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTMONTH&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos" data-line="1138"></span></a><span class="w">                                                                              </span><span class="s2">&quot;|day=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;CURRENTDAY2&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\}\}&quot;</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos" data-line="1139"></span></a><span class="w">               </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyEvidenceOptionNone</span><span class="w"> </span><span class="o">?</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos" data-line="1140"></span></a><span class="w">               </span><span class="s2">&quot;Will be provided on request.&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">))));</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos" data-line="1141"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Permission</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos" data-line="1142"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">ThirdPartyPermission</span><span class="p">,</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos" data-line="1143"></span></a><span class="w">            </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos" data-line="1144"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Evidence:&#39;&#39;&#39; &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">evidence</span><span class="p">)]);</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos" data-line="1145"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos" data-line="1146"></span></a><span class="w">         </span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos" data-line="1147"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionFreeWebsite&#39;</span><span class="o">:</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos" data-line="1148"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Permission</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Permission</span><span class="p">;</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos" data-line="1149"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos" data-line="1150"></span></a><span class="w">         </span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos" data-line="1151"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionPDOld&#39;</span><span class="o">:</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos" data-line="1152"></span></a><span class="w">         </span><span class="c1">// add &quot;lifetime&quot; input to &quot;author&quot; field</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos" data-line="1153"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos" data-line="1154"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="p">,</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos" data-line="1155"></span></a><span class="w">            </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos" data-line="1156"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;(Life time: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldAuthorLifetime</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos" data-line="1157"></span></a><span class="w">         </span><span class="p">]);</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos" data-line="1158"></span></a><span class="w">         </span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos" data-line="1159"></span></a><span class="w">         </span><span class="c1">// combine original and direct source into standard &quot;source&quot; field: </span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos" data-line="1160"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos" data-line="1161"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Original publication&#39;&#39;&#39;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Publication</span><span class="p">),</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos" data-line="1162"></span></a><span class="w">            </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos" data-line="1163"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Immediate source&#39;&#39;&#39;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span><span class="p">)</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos" data-line="1164"></span></a><span class="w">         </span><span class="p">]);</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos" data-line="1165"></span></a><span class="w">         </span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos" data-line="1166"></span></a><span class="w">         </span><span class="c1">// no standard tag available for &quot;lack-of-registration&quot; PD-US. Need</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos" data-line="1167"></span></a><span class="w">         </span><span class="c1">// to put this into the &quot;permission&quot; field</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos" data-line="1168"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDFormality</span><span class="p">)</span><span class="w"> </span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos" data-line="1169"></span></a><span class="w">            </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Permission</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos" data-line="1170"></span></a><span class="w">               </span><span class="s2">&quot;Copyright expired because the work was published without a copyright &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos" data-line="1171"></span></a><span class="w">               </span><span class="s2">&quot;notice and/or without the necessary copyright registration.&quot;</span><span class="p">;</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos" data-line="1172"></span></a><span class="w">      </span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos" data-line="1173"></span></a><span class="w">         </span><span class="c1">// add optional &quot;explanation&quot; input to &quot;permission&quot; field</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos" data-line="1174"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldPermission</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos" data-line="1175"></span></a><span class="w">            </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Permission</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos" data-line="1176"></span></a><span class="w">               </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Permission</span><span class="p">,</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos" data-line="1177"></span></a><span class="w">               </span><span class="s2">&quot;\n\n&quot;</span><span class="p">,</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos" data-line="1178"></span></a><span class="w">               </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOldPermission</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos" data-line="1179"></span></a><span class="w">            </span><span class="p">]);</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos" data-line="1180"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos" data-line="1181"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos" data-line="1182"></span></a><span class="w">         </span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos" data-line="1183"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionPDOther&#39;</span><span class="o">:</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos" data-line="1184"></span></a><span class="w">         </span><span class="c1">// Need &quot;permission&quot; field in case of &quot;official item&quot; option</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos" data-line="1185"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOtherOfficial</span><span class="p">)</span><span class="w"> </span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos" data-line="1186"></span></a><span class="w">            </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Permission</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">PDOfficialPermission</span><span class="p">;</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos" data-line="1187"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span><span class="w"> </span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos" data-line="1188"></span></a>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos" data-line="1189"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionNFSubject&#39;</span><span class="o">:</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos" data-line="1190"></span></a><span class="w">         </span><span class="c1">// most FUR elements can be automatically provided:</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos" data-line="1191"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Purpose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos" data-line="1192"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectCheckDedicated</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos" data-line="1193"></span></a><span class="w">             </span><span class="p">(</span><span class="s2">&quot;For visual identification of the object of the article. &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos" data-line="1194"></span></a><span class="w">              </span><span class="s2">&quot;The article as a whole is dedicated specifically to a discussion of this work.&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos" data-line="1195"></span></a><span class="w">            </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectCheckDiscussed</span><span class="w"> </span><span class="o">?</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos" data-line="1196"></span></a><span class="w">             </span><span class="p">(</span><span class="s2">&quot;To support encyclopedic discussion of this work in this article. &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos" data-line="1197"></span></a><span class="w">              </span><span class="s2">&quot;The illustration is specifically needed to support the following point(s): &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos" data-line="1198"></span></a><span class="w">              </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFSubjectPurpose</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos" data-line="1199"></span></a><span class="w">         </span><span class="p">);</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos" data-line="1200"></span></a><span class="w">         </span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos" data-line="1201"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Any derivative work based upon the artwork would be a copyright violation, so creation of a free image is not possible.&quot;</span><span class="p">;</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos" data-line="1202"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Commercial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;The use of a low resolution image of the artwork will not impact the commercial viability of the art.&quot;</span><span class="p">;</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos" data-line="1203"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos" data-line="1204"></span></a>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos" data-line="1205"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionNF3D&#39;</span><span class="o">:</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos" data-line="1206"></span></a><span class="w">         </span><span class="c1">// complex case: we need to assemble attribution and FUR both for the </span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos" data-line="1207"></span></a><span class="w">         </span><span class="c1">// original 3D work and for the photographic depiction. Both might be </span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos" data-line="1208"></span></a><span class="w">         </span><span class="c1">// non-free.</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos" data-line="1209"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos" data-line="1210"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Original work:&#39;&#39;&#39; &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DCreator</span><span class="p">),</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos" data-line="1211"></span></a><span class="w">            </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos" data-line="1212"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Depiction:&#39;&#39;&#39; &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Author</span><span class="p">)</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos" data-line="1213"></span></a><span class="w">         </span><span class="p">]);</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos" data-line="1214"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nb">Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos" data-line="1215"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Original work:&#39;&#39;&#39; &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DOrigDate</span><span class="p">),</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos" data-line="1216"></span></a><span class="w">            </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos" data-line="1217"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Depiction:&#39;&#39;&#39; &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nb">Date</span><span class="p">)</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos" data-line="1218"></span></a><span class="w">         </span><span class="p">]);</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos" data-line="1219"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Purpose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos" data-line="1220"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DCheckDedicated</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos" data-line="1221"></span></a><span class="w">             </span><span class="p">(</span><span class="s2">&quot;For visual identification of the object of the article. &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos" data-line="1222"></span></a><span class="w">              </span><span class="s2">&quot;The article as a whole is dedicated specifically to a discussion of this work.&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos" data-line="1223"></span></a><span class="w">            </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DCheckDiscussed</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos" data-line="1224"></span></a><span class="w">             </span><span class="p">(</span><span class="s2">&quot;To support encyclopedic discussion of this work in this article. &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos" data-line="1225"></span></a><span class="w">              </span><span class="s2">&quot;The illustration is specifically needed to support the following point(s): &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos" data-line="1226"></span></a><span class="w">              </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DPurpose</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos" data-line="1227"></span></a><span class="w">         </span><span class="p">);</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos" data-line="1228"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Any derivative work based upon the artwork would be a copyright violation, so creation of a free image is not possible.&quot;</span><span class="p">;</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos" data-line="1229"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Commercial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;The use of a low resolution image of the artwork will not impact the commercial viability of the art.&quot;</span><span class="p">;</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos" data-line="1230"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">[</span><span class="s2">&quot;Other information&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos" data-line="1231"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DOptionSame</span><span class="w"> </span><span class="o">?</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos" data-line="1232"></span></a><span class="w">            </span><span class="p">(</span><span class="s2">&quot;The image was created and published by the same author who also &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos" data-line="1233"></span></a><span class="w">             </span><span class="s2">&quot;holds the rights to the original object, and no alternative depiction &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos" data-line="1234"></span></a><span class="w">             </span><span class="s2">&quot;could be suitably created.&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos" data-line="1235"></span></a><span class="w">            </span><span class="p">(</span><span class="s2">&quot;The author of the image has released the photographic work under a &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos" data-line="1236"></span></a><span class="w">             </span><span class="s2">&quot;free license, or it is in the public domain: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NF3DPermission</span><span class="p">)</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos" data-line="1237"></span></a><span class="w">         </span><span class="p">);</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos" data-line="1238"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span><span class="w"> </span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos" data-line="1239"></span></a><span class="w">         </span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos" data-line="1240"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionNFExcerpt&#39;</span><span class="o">:</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos" data-line="1241"></span></a><span class="w">         </span><span class="c1">// FURs for screenshots etc. don&#39;t normally need to bother</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos" data-line="1242"></span></a><span class="w">         </span><span class="c1">// about replaceability (with free images) and with commercial role,</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos" data-line="1243"></span></a><span class="w">         </span><span class="c1">// but do need to bother about purpose and about replaceability with text.</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos" data-line="1244"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Purpose</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFPurpose</span><span class="p">;</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos" data-line="1245"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFReplaceableText</span><span class="p">;</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos" data-line="1246"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;The software or website from which the screenshot is taken is copyrighted and not released under a free license, so creation of a free image is not possible.&quot;</span><span class="p">;</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos" data-line="1247"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Commercial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;The use of a low resolution screenshot from software or a website will not impact the commercial viability of the software or site.&quot;</span><span class="p">;</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos" data-line="1248"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos" data-line="1249"></span></a><span class="w">         </span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos" data-line="1250"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionNFCover&#39;</span><span class="o">:</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos" data-line="1251"></span></a><span class="w">         </span><span class="c1">// cover art gets standard rationales.</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos" data-line="1252"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Purpose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos" data-line="1253"></span></a><span class="w">            </span><span class="s2">&quot;to serve as the primary means of visual identification &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos" data-line="1254"></span></a><span class="w">            </span><span class="s2">&quot;at the top of the article dedicated to the work in question.&quot;</span><span class="p">;</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos" data-line="1255"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Any derivative work based upon the cover art would be a copyright violation, so creation of a free image is not possible.&quot;</span><span class="p">;</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos" data-line="1256"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Commercial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;The use of a low resolution image of a work&#39;s cover will not impact the commercial viability of the work.&quot;</span><span class="p">;</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos" data-line="1257"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos" data-line="1258"></span></a><span class="w"> </span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos" data-line="1259"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionNFLogo&#39;</span><span class="o">:</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos" data-line="1260"></span></a><span class="w">         </span><span class="c1">// logos get standard rationales.</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos" data-line="1261"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Purpose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos" data-line="1262"></span></a><span class="w">            </span><span class="s2">&quot;to serve as the primary means of visual identification &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos" data-line="1263"></span></a><span class="w">            </span><span class="s2">&quot;at the top of the article dedicated to the entity in question.&quot;</span><span class="p">;</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos" data-line="1264"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Any derivative work based upon the logo would be a copyright violation, so creation of a free image is not possible.&quot;</span><span class="p">;</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos" data-line="1265"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Commercial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;The use of a low resolution image of an organization&#39;s logo in the article about that organization will not impact the commercial viability of the logo.&quot;</span><span class="p">;</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos" data-line="1266"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos" data-line="1267"></span></a>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos" data-line="1268"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionNFPortrait&#39;</span><span class="o">:</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos" data-line="1269"></span></a><span class="w">         </span><span class="c1">// as with other historic photographs, it is useful to have both</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos" data-line="1270"></span></a><span class="w">         </span><span class="c1">// original publication and direct source</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos" data-line="1271"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos" data-line="1272"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Original publication&#39;&#39;&#39;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Publication</span><span class="p">),</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos" data-line="1273"></span></a><span class="w">            </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos" data-line="1274"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&#39;Immediate source&#39;&#39;&#39;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span><span class="p">)</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos" data-line="1275"></span></a><span class="w">         </span><span class="p">]);</span><span class="w">   </span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos" data-line="1276"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Purpose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos" data-line="1277"></span></a><span class="w">            </span><span class="s2">&quot;for visual identification of the person in question, &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos" data-line="1278"></span></a><span class="w">            </span><span class="s2">&quot;at the top of their biographical article&quot;</span><span class="p">;</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos" data-line="1279"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFReplaceable</span><span class="p">;</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos" data-line="1280"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Commercial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFCommercial</span><span class="p">;</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos" data-line="1281"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">[</span><span class="s1">&#39;Other information&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos" data-line="1282"></span></a><span class="w">            </span><span class="s2">&quot;The subject of the photograph has been deceased since: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFPortraitDeceased</span><span class="p">;</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos" data-line="1283"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos" data-line="1284"></span></a><span class="w">         </span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos" data-line="1285"></span></a><span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="s1">&#39;OptionNFMisc&#39;</span><span class="o">:</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos" data-line="1286"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos" data-line="1287"></span></a><span class="w">            </span><span class="nx">fuwSurroundString</span><span class="p">(</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos" data-line="1288"></span></a><span class="w">               </span><span class="s2">&quot;&#39;&#39;&#39;Original publication&#39;&#39;&#39;: &quot;</span><span class="p">,</span><span class="w"> </span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos" data-line="1289"></span></a><span class="w">               </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Publication</span><span class="p">,</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos" data-line="1290"></span></a><span class="w">               </span><span class="s2">&quot;&lt;br/&gt;\n&#39;&#39;&#39;Immediate source:&#39;&#39;&#39; &quot;</span><span class="p">),</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos" data-line="1291"></span></a><span class="w">            </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos" data-line="1292"></span></a><span class="w">            </span><span class="nx">opts</span><span class="p">.</span><span class="nx">Source</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos" data-line="1293"></span></a><span class="w">         </span><span class="p">]);</span><span class="w">   </span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos" data-line="1294"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Purpose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFPurpose</span><span class="p">;</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos" data-line="1295"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFReplaceable</span><span class="p">;</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos" data-line="1296"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Replaceability_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFReplaceable_text</span><span class="p">;</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos" data-line="1297"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Commercial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFCommercial</span><span class="p">;</span><span class="w"> </span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos" data-line="1298"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span><span class="w">     </span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos" data-line="1299"></span></a><span class="w">   </span><span class="p">};</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos" data-line="1300"></span></a>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos" data-line="1301"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OptionNonFree</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos" data-line="1302"></span></a><span class="w">      </span><span class="c1">// common stuff for all non-free files:</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos" data-line="1303"></span></a><span class="w">      </span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos" data-line="1304"></span></a><span class="w">      </span><span class="c1">// Minimality field (same for all NF options):</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos" data-line="1305"></span></a><span class="w">      </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Minimality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFMinimality</span><span class="p">;</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos" data-line="1306"></span></a><span class="w">      </span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos" data-line="1307"></span></a><span class="w">      </span><span class="c1">// append optional &quot;extra license&quot; selector and &quot;AnyOther&quot; fields</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos" data-line="1308"></span></a><span class="w">      </span><span class="c1">// to &quot;Other information&quot; field:</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos" data-line="1309"></span></a><span class="w">      </span><span class="nx">descFields</span><span class="p">[</span><span class="s1">&#39;Other information&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos" data-line="1310"></span></a><span class="w">         </span><span class="nx">descFields</span><span class="p">[</span><span class="s1">&#39;Other information&#39;</span><span class="p">],</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos" data-line="1311"></span></a><span class="w">         </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos" data-line="1312"></span></a><span class="w">         </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="s1">&#39;\{\{&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">NFExtraLicense</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\}\}&#39;</span><span class="p">),</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos" data-line="1313"></span></a><span class="w">         </span><span class="s2">&quot;&lt;br/&gt;\n&quot;</span><span class="p">,</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos" data-line="1314"></span></a><span class="w">         </span><span class="nx">opts</span><span class="p">.</span><span class="nx">AnyOther</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos" data-line="1315"></span></a><span class="w">      </span><span class="p">]);</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos" data-line="1316"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos" data-line="1317"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos" data-line="1318"></span></a><span class="w">      </span><span class="c1">// common stuff for all free files:</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos" data-line="1319"></span></a><span class="w">      </span><span class="nx">descFields</span><span class="p">.</span><span class="nx">Other_versions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos" data-line="1320"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">otherInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">([</span><span class="k">this</span><span class="p">.</span><span class="nx">otherInfo</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">AnyOther</span><span class="p">]);</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos" data-line="1321"></span></a><span class="w">   </span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos" data-line="1322"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos" data-line="1323"></span></a>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos" data-line="1324"></span></a><span class="p">};</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos" data-line="1325"></span></a>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos" data-line="1326"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">formatOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">forCommons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos" data-line="1327"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">baseForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">;</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos" data-line="1328"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">targetForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">TargetForm</span><span class="p">;</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos" data-line="1329"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos" data-line="1330"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">testForm</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">TestForm</span><span class="p">;</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos" data-line="1331"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos" data-line="1332"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos" data-line="1333"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">otherInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">otherInfo</span><span class="p">;</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos" data-line="1334"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">descFields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">descFields</span><span class="p">;</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos" data-line="1335"></span></a>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos" data-line="1336"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;{{&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getDescriptionTemplateName</span><span class="p">();</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos" data-line="1337"></span></a>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos" data-line="1338"></span></a><span class="w">   </span><span class="c1">// assemble all fields into the wikitext of the description page:</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos" data-line="1339"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">fieldOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos" data-line="1340"></span></a><span class="w">      </span><span class="s1">&#39;Source&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Author&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Permission&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Other_versions&#39;</span><span class="p">,</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos" data-line="1341"></span></a><span class="w">      </span><span class="s1">&#39;Article&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Purpose&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Replaceability&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Replaceability_text&#39;</span><span class="p">,</span><span class="w"> </span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos" data-line="1342"></span></a><span class="w">      </span><span class="s1">&#39;Minimality&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Commercial&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Other information&#39;</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos" data-line="1343"></span></a><span class="w">   </span><span class="p">];</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos" data-line="1344"></span></a><span class="w">   </span><span class="nx">summary</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;\n|Description = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwPackInfo</span><span class="p">(</span><span class="nx">descFields</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">],</span><span class="w"> </span><span class="nx">forCommons</span><span class="p">);</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos" data-line="1345"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">fieldOrder</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos" data-line="1346"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">descFields</span><span class="p">[</span><span class="nx">fieldOrder</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos" data-line="1347"></span></a><span class="w">         </span><span class="nx">summary</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;\n|&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fieldOrder</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">descFields</span><span class="p">[</span><span class="nx">fieldOrder</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos" data-line="1348"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos" data-line="1349"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos" data-line="1350"></span></a><span class="w">   </span><span class="nx">summary</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;\n}}\n&quot;</span><span class="p">;</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos" data-line="1351"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">otherInfo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos" data-line="1352"></span></a><span class="w">      </span><span class="nx">summary</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;\n;Other information:\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuwPackInfo</span><span class="p">(</span><span class="nx">otherInfo</span><span class="p">,</span><span class="w"> </span><span class="nx">forCommons</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n&quot;</span><span class="p">;</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos" data-line="1353"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos" data-line="1354"></span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos" data-line="1355"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">editSummary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getEditSummary</span><span class="p">();</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos" data-line="1356"></span></a><span class="w">   </span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos" data-line="1357"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">license</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getLicense</span><span class="p">();</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos" data-line="1358"></span></a><span class="w">   </span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos" data-line="1359"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">forCommons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos" data-line="1360"></span></a><span class="w">      </span><span class="c1">// pack our description info into an url pointing to the </span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos" data-line="1361"></span></a><span class="w">      </span><span class="c1">// standard Commons Special:Upload</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos" data-line="1362"></span></a><span class="w">      </span><span class="c1">// with pre-loaded description fields</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos" data-line="1363"></span></a>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos" data-line="1364"></span></a><span class="w">      </span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;Upload marker added by en.wp UW&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">summary</span><span class="p">;</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos" data-line="1365"></span></a><span class="w">      </span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">summary</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\{\{OTRS pending\}\}/g</span><span class="p">,</span><span class="w"> </span><span class="nx">fuwSubst</span><span class="p">(</span><span class="s2">&quot;OP&quot;</span><span class="p">));</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos" data-line="1366"></span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos" data-line="1367"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos" data-line="1368"></span></a><span class="w">         </span><span class="c1">// manually format the whole description page including the license tag, if it</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos" data-line="1369"></span></a><span class="w">         </span><span class="c1">// isn&#39;t one of the bare standard licenses in the dropdown box. Otherwise,</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos" data-line="1370"></span></a><span class="w">         </span><span class="c1">// submit description summary and license as two separate url parameters.</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos" data-line="1371"></span></a><span class="w">         </span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">summary</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\n\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="p">;</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos" data-line="1372"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos" data-line="1373"></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwGetCommonsURL</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos" data-line="1374"></span></a><span class="w">         </span><span class="s2">&quot;?title=Special:Upload&quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos" data-line="1375"></span></a><span class="w">         </span><span class="s2">&quot;&amp;wpUploadDescription=&quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos" data-line="1376"></span></a><span class="w">         </span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">summary</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos" data-line="1377"></span></a><span class="w">         </span><span class="p">(</span><span class="nx">license</span><span class="p">.</span><span class="nx">standard</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos" data-line="1378"></span></a><span class="w">          </span><span class="p">(</span><span class="s2">&quot;&amp;wpLicense=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">license</span><span class="p">.</span><span class="nx">standard</span><span class="p">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos" data-line="1379"></span></a><span class="w">         </span><span class="s2">&quot;&amp;wpDestFile=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos" data-line="1380"></span></a><span class="w">         </span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputName</span><span class="p">));</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos" data-line="1381"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos" data-line="1382"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos" data-line="1383"></span></a><span class="w">      </span><span class="c1">// pack all description into a single &quot;text&quot; parameter to be submitted</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos" data-line="1384"></span></a><span class="w">      </span><span class="c1">// to the local api.php upload.</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos" data-line="1385"></span></a><span class="w">      </span><span class="nx">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;==Summary==\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos" data-line="1386"></span></a><span class="w">         </span><span class="nx">summary</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos" data-line="1387"></span></a><span class="w">         </span><span class="s2">&quot;\n==Licensing==\n&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos" data-line="1388"></span></a><span class="w">         </span><span class="p">(</span><span class="nx">license</span><span class="p">.</span><span class="nx">standard</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;\{\{&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">license</span><span class="p">.</span><span class="nx">standard</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;\}\}&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">license</span><span class="p">.</span><span class="nx">special</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos" data-line="1389"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">getTrackingCategory</span><span class="p">();</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos" data-line="1390"></span></a><span class="w">         </span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos" data-line="1391"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos" data-line="1392"></span></a><span class="w">         </span><span class="c1">// Testing mode: show our data in the dummy form</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos" data-line="1393"></span></a><span class="w">         </span><span class="c1">// at the bottom of the page.</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos" data-line="1394"></span></a><span class="w">         </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;placeholderSandboxFilename&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos" data-line="1395"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">TestForm</span><span class="p">.</span><span class="nx">SandboxSummary</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">editSummary</span><span class="p">;</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos" data-line="1396"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">TestForm</span><span class="p">.</span><span class="nx">SandboxText</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">summary</span><span class="p">;</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos" data-line="1397"></span></a><span class="w">         </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;placeholderTestForm&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos" data-line="1398"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos" data-line="1399"></span></a><span class="w">      </span><span class="c1">// Set up API call parameters</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos" data-line="1400"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">UploadOptions</span><span class="p">.</span><span class="nx">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos" data-line="1401"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">UploadOptions</span><span class="p">.</span><span class="nx">text</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nx">summary</span><span class="p">;</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos" data-line="1402"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">UploadOptions</span><span class="p">.</span><span class="nx">comment</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">editSummary</span><span class="p">;</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos" data-line="1403"></span></a>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos" data-line="1404"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos" data-line="1405"></span></a><span class="w">   </span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos" data-line="1406"></span></a><span class="p">};</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos" data-line="1407"></span></a>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos" data-line="1408"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwHasUserGroup</span><span class="p">(</span><span class="nx">group</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos" data-line="1409"></span></a><span class="w">   </span><span class="c1">// workaround because old IE versions don&#39;t have array.indexOf :-(</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos" data-line="1410"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgUserGroups&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos" data-line="1411"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgUserGroups&#39;</span><span class="p">)[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">group</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos" data-line="1412"></span></a><span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos" data-line="1413"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos" data-line="1414"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos" data-line="1415"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos" data-line="1416"></span></a><span class="p">}</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos" data-line="1417"></span></a>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos" data-line="1418"></span></a><span class="nx">fuwGlobal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getUserStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos" data-line="1419"></span></a><span class="w">   </span><span class="c1">// function to determine the experience status and userrights of the current user:</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos" data-line="1420"></span></a><span class="w">   </span><span class="c1">// &#39;anon&#39;: not logged in; can&#39;t use script.</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos" data-line="1421"></span></a><span class="w">   </span><span class="c1">// &#39;notAutoconfirmed&#39;: can&#39;t use local upload, but may use script to prepare upload for Commons</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos" data-line="1422"></span></a><span class="w">   </span><span class="c1">// &#39;newbie&#39;: autoconfirmed but editcount &lt; 100 </span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos" data-line="1423"></span></a><span class="w">   </span><span class="c1">//    (may be used in future to adapt instructions more to newbie needs)</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos" data-line="1424"></span></a><span class="w">   </span><span class="c1">// &#39;problem&#39;: autoconfirmed but has 3 or more image-related warnings or deletion notifications among recent user talk entries</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos" data-line="1425"></span></a><span class="w">   </span><span class="c1">//    (may be used in future to produce more strongly worded instructions)</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos" data-line="1426"></span></a><span class="w">   </span><span class="c1">// &#39;autoconfirmed&#39;: regular user</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos" data-line="1427"></span></a><span class="w">   </span><span class="c1">// &#39;sysop&#39;</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos" data-line="1428"></span></a>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos" data-line="1429"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgUserName&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos" data-line="1430"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwHasUserGroup</span><span class="p">(</span><span class="s1">&#39;sysop&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos" data-line="1431"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;sysop&#39;</span><span class="p">;</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos" data-line="1432"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos" data-line="1433"></span></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwHasUserGroup</span><span class="p">(</span><span class="s1">&#39;autoconfirmed&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fuwHasUserGroup</span><span class="p">(</span><span class="s1">&#39;confirmed&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos" data-line="1434"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;autoconfirmed&#39;</span><span class="p">;</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos" data-line="1435"></span></a><span class="w">         </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos" data-line="1436"></span></a><span class="w">            </span><span class="nx">url</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">wikiScript</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;api&#39;</span><span class="w"> </span><span class="p">),</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos" data-line="1437"></span></a><span class="w">            </span><span class="nx">type</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos" data-line="1438"></span></a><span class="w">            </span><span class="nx">dataType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos" data-line="1439"></span></a><span class="w">            </span><span class="nx">traditional</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos" data-line="1440"></span></a><span class="w">            </span><span class="nx">data</span><span class="o">:</span><span class="w">   </span><span class="p">{</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos" data-line="1441"></span></a><span class="w">                     </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos" data-line="1442"></span></a><span class="w">                     </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">,</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos" data-line="1443"></span></a><span class="w">                     </span><span class="nx">meta</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;userinfo&#39;</span><span class="p">,</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos" data-line="1444"></span></a><span class="w">                     </span><span class="nx">uiprop</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;editcount&#39;</span><span class="p">,</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos" data-line="1445"></span></a><span class="w">                     </span><span class="nx">prop</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;revisions&#39;</span><span class="p">,</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos" data-line="1446"></span></a><span class="w">                     </span><span class="nx">titles</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;User talk&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgUserName&#39;</span><span class="p">),</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos" data-line="1447"></span></a><span class="w">                     </span><span class="nx">rvprop</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;comment|user&#39;</span><span class="p">,</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos" data-line="1448"></span></a><span class="w">                     </span><span class="nx">rvlimit</span><span class="o">:</span><span class="w"> </span><span class="mf">30</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos" data-line="1449"></span></a><span class="w">                    </span><span class="p">},</span><span class="w">      </span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos" data-line="1450"></span></a><span class="w">            </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos" data-line="1451"></span></a><span class="w">            </span><span class="c1">// callback func     </span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos" data-line="1452"></span></a><span class="w">               </span><span class="kd">var</span><span class="w"> </span><span class="nx">fuw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">;</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos" data-line="1453"></span></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos" data-line="1454"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">ui</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;userinfo&#39;</span><span class="p">);</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos" data-line="1455"></span></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">ui</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos" data-line="1456"></span></a><span class="w">                     </span><span class="kd">var</span><span class="w"> </span><span class="nx">editcount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ui</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;editcount&#39;</span><span class="p">);</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos" data-line="1457"></span></a><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">editcount</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos" data-line="1458"></span></a><span class="w">                        </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;newbie&#39;</span><span class="p">;</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos" data-line="1459"></span></a><span class="w">                     </span><span class="p">}</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos" data-line="1460"></span></a><span class="w">                  </span><span class="p">}</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos" data-line="1461"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">revs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;rev&#39;</span><span class="p">);</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos" data-line="1462"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">countWarn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos" data-line="1463"></span></a><span class="w">                  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">revs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos" data-line="1464"></span></a><span class="w">                     </span><span class="kd">var</span><span class="w"> </span><span class="nx">rev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">revs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos" data-line="1465"></span></a><span class="w">                     </span><span class="kd">var</span><span class="w"> </span><span class="nx">usr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rev</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">);</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos" data-line="1466"></span></a><span class="w">                     </span><span class="kd">var</span><span class="w"> </span><span class="nx">cmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rev</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">);</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos" data-line="1467"></span></a><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="nx">usr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;ImageTaggingBot&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos" data-line="1468"></span></a><span class="w">                         </span><span class="p">(</span><span class="nx">cmt</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="sr">/(tagging for deletion of \[\[File)|(Uploading files missing)|(File (source and )?copyright licensing problem)|(Speedy deletion nomination of \[\[File)|(Notification: listing at \[\[possibly unfree files)/</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos" data-line="1469"></span></a><span class="w">                        </span><span class="nx">countWarn</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w">   </span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos" data-line="1470"></span></a><span class="w">                     </span><span class="p">}</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos" data-line="1471"></span></a><span class="w">                  </span><span class="p">}</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos" data-line="1472"></span></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">countWarn</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos" data-line="1473"></span></a><span class="w">                     </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;problem&#39;</span><span class="p">;</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos" data-line="1474"></span></a><span class="w">                  </span><span class="p">}</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos" data-line="1475"></span></a><span class="w">               </span><span class="p">}</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos" data-line="1476"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos" data-line="1477"></span></a><span class="w">         </span><span class="p">});</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos" data-line="1478"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos" data-line="1479"></span></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos" data-line="1480"></span></a><span class="w">         </span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;notAutoconfirmed&#39;</span><span class="p">;</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos" data-line="1481"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos" data-line="1482"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos" data-line="1483"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos" data-line="1484"></span></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">userStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;anon&#39;</span><span class="p">;</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos" data-line="1485"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos" data-line="1486"></span></a><span class="p">};</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos" data-line="1487"></span></a>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos" data-line="1488"></span></a><span class="c1">// =================================================================</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos" data-line="1489"></span></a><span class="c1">// Convenience function for getting the regular index.php</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos" data-line="1490"></span></a><span class="c1">// interface of Commons. Not very elegant.</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos" data-line="1491"></span></a><span class="c1">// =================================================================</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos" data-line="1492"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwGetCommonsURL</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos" data-line="1493"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^https:/</span><span class="p">))</span><span class="w"> </span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos" data-line="1494"></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;https://commons.wikimedia.org/w/index.php&quot;</span><span class="p">;</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos" data-line="1495"></span></a><span class="w">   </span><span class="k">else</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos" data-line="1496"></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;http://commons.wikimedia.org/w/index.php&quot;</span><span class="p">;</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos" data-line="1497"></span></a><span class="p">}</span><span class="w">  </span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos" data-line="1498"></span></a>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos" data-line="1499"></span></a><span class="c1">// ==================================================================</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos" data-line="1500"></span></a><span class="c1">// functions for building form elements</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos" data-line="1501"></span></a><span class="c1">// ==================================================================</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos" data-line="1502"></span></a><span class="nx">fuwMakeRadiobutton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">group</span><span class="p">,</span><span class="w"> </span><span class="nx">option</span><span class="p">,</span><span class="w"> </span><span class="nx">checked</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos" data-line="1503"></span></a><span class="w">   </span><span class="c1">// Stupid IE7 doesn&#39;t get &quot;value&quot; attribute unless it&#39;s created in this convoluted way.</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos" data-line="1504"></span></a><span class="w">   </span><span class="c1">// Annoying.   </span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos" data-line="1505"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;input type=&quot;radio&quot; id=&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">option</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; name=&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; value=&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">option</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;&gt;&lt;/input&gt;&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos" data-line="1506"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">checked</span><span class="p">)</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">checked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos" data-line="1507"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fuwRadioClick</span><span class="p">;</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos" data-line="1508"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fuwRadioClick</span><span class="p">;</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos" data-line="1509"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="nx">option</span><span class="p">,</span><span class="w"> </span><span class="nx">node</span><span class="p">);</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos" data-line="1510"></span></a><span class="p">};</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos" data-line="1511"></span></a><span class="nx">fuwMakeTextfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos" data-line="1512"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos" data-line="1513"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;text&#39;</span><span class="p">;</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos" data-line="1514"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">;</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos" data-line="1515"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwDefaultTextboxLength</span><span class="p">;</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos" data-line="1516"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fuwUpdateOptions</span><span class="p">;</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos" data-line="1517"></span></a><span class="w">   </span><span class="c1">// only for testing:</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos" data-line="1518"></span></a><span class="w">   </span><span class="c1">//node.value = label;</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos" data-line="1519"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">node</span><span class="p">);</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos" data-line="1520"></span></a><span class="p">};</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos" data-line="1521"></span></a><span class="nx">fuwMakeTextarea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos" data-line="1522"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;textarea&#39;</span><span class="p">);</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos" data-line="1523"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">;</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos" data-line="1524"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwDefaultTextareaLines</span><span class="p">;</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos" data-line="1525"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwDefaultTextareaWidth</span><span class="p">;</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos" data-line="1526"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fuwUpdateOptions</span><span class="p">;</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos" data-line="1527"></span></a><span class="w">   </span><span class="c1">//only for testing:</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos" data-line="1528"></span></a><span class="w">   </span><span class="c1">//node.innerHTML = label;</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos" data-line="1529"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">node</span><span class="p">);</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos" data-line="1530"></span></a><span class="p">};</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos" data-line="1531"></span></a><span class="nx">fuwMakeCheckbox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">checked</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos" data-line="1532"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos" data-line="1533"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">;</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos" data-line="1534"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;checkbox&#39;</span><span class="p">;</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos" data-line="1535"></span></a><span class="w">   </span><span class="c1">//only for testing:</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos" data-line="1536"></span></a><span class="w">   </span><span class="c1">//node.title= label;</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos" data-line="1537"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">checked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">checked</span><span class="p">;</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos" data-line="1538"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">fuwUpdateOptions</span><span class="p">;</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos" data-line="1539"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">node</span><span class="p">);</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos" data-line="1540"></span></a><span class="p">}</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos" data-line="1541"></span></a><span class="nx">fuwMakeHiddenfield</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos" data-line="1542"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos" data-line="1543"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos" data-line="1544"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos" data-line="1545"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos" data-line="1546"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">((</span><span class="nx">id</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">name</span><span class="p">),</span><span class="w"> </span><span class="nx">node</span><span class="p">);</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos" data-line="1547"></span></a><span class="p">};</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos" data-line="1548"></span></a><span class="nx">fuwMakeAnchor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">href</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos" data-line="1549"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos" data-line="1550"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">;</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos" data-line="1551"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">target</span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;_blank&quot;</span><span class="p">;</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos" data-line="1552"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">href</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">href</span><span class="p">;</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos" data-line="1553"></span></a><span class="w">   </span><span class="nx">node</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">content</span><span class="p">;</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos" data-line="1554"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">node</span><span class="p">);</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos" data-line="1555"></span></a><span class="p">};</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos" data-line="1556"></span></a><span class="nx">fuwMakeSelection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">values</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos" data-line="1557"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">);</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos" data-line="1558"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">root</span><span class="p">;</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos" data-line="1559"></span></a><span class="w">   </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos" data-line="1560"></span></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos" data-line="1561"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos" data-line="1562"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">entry</span><span class="p">;</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos" data-line="1563"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">line</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos" data-line="1564"></span></a><span class="w">            </span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">root</span><span class="p">;</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos" data-line="1565"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos" data-line="1566"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">line</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos" data-line="1567"></span></a><span class="w">            </span><span class="nx">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;optgroup&#39;</span><span class="p">);</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos" data-line="1568"></span></a><span class="w">            </span><span class="nx">entry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">line</span><span class="p">[</span><span class="mf">0</span><span class="p">]);</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos" data-line="1569"></span></a><span class="w">            </span><span class="nx">root</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos" data-line="1570"></span></a><span class="w">            </span><span class="nx">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">entry</span><span class="p">;</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos" data-line="1571"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos" data-line="1572"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos" data-line="1573"></span></a><span class="w">            </span><span class="nx">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;option&#39;</span><span class="p">);</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos" data-line="1574"></span></a><span class="w">            </span><span class="nx">entry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">line</span><span class="p">[</span><span class="mf">0</span><span class="p">]);</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos" data-line="1575"></span></a><span class="w">            </span><span class="nx">entry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;{{&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">line</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;}}&#39;</span><span class="p">);</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos" data-line="1576"></span></a><span class="w">            </span><span class="nx">entry</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">line</span><span class="p">[</span><span class="mf">1</span><span class="p">];</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos" data-line="1577"></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">line</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos" data-line="1578"></span></a><span class="w">               </span><span class="nx">entry</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;selected&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;selected&#39;</span><span class="p">);</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos" data-line="1579"></span></a><span class="w">            </span><span class="p">}</span><span class="w"> </span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos" data-line="1580"></span></a><span class="w">            </span><span class="nx">current</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos" data-line="1581"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos" data-line="1582"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos" data-line="1583"></span></a><span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Name: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;, i=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos" data-line="1584"></span></a><span class="w">   </span><span class="nx">root</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos" data-line="1585"></span></a><span class="w">   </span><span class="nx">root</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwUpdateOptions</span><span class="p">;</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos" data-line="1586"></span></a><span class="w">   </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">root</span><span class="p">);</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos" data-line="1587"></span></a><span class="p">};</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos" data-line="1588"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwMakeWikilink</span><span class="p">(</span><span class="nx">place</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="nx">redlink</span><span class="p">,</span><span class="w"> </span><span class="nx">display</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos" data-line="1589"></span></a><span class="w">   </span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos" data-line="1590"></span></a><span class="w">   </span><span class="nx">place</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">place</span><span class="p">);</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos" data-line="1591"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">place</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos" data-line="1592"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">anchor</span><span class="p">;</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos" data-line="1593"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">place</span><span class="p">.</span><span class="nx">tagName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos" data-line="1594"></span></a><span class="w">      </span><span class="nx">anchor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">place</span><span class="p">;</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos" data-line="1595"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos" data-line="1596"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos" data-line="1597"></span></a><span class="w">      </span><span class="nx">anchor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos" data-line="1598"></span></a><span class="w">      </span><span class="nx">place</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">anchor</span><span class="p">);</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos" data-line="1599"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos" data-line="1600"></span></a><span class="w">   </span><span class="nx">anchor</span><span class="p">.</span><span class="nx">href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">getUrl</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos" data-line="1601"></span></a><span class="w">   </span><span class="nx">anchor</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">target</span><span class="p">;</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos" data-line="1602"></span></a><span class="w">   </span><span class="nx">anchor</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">target</span><span class="p">;</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos" data-line="1603"></span></a><span class="w">   </span><span class="nx">anchor</span><span class="p">.</span><span class="nx">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">redlink</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;new&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos" data-line="1604"></span></a><span class="p">}</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos" data-line="1605"></span></a>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos" data-line="1606"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwAppendInput</span><span class="p">(</span><span class="nx">label</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos" data-line="1607"></span></a><span class="w">   </span><span class="c1">// append a newly created input element to an existing</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos" data-line="1608"></span></a><span class="w">   </span><span class="c1">// span element marked as id=&quot;placeholderXYZ&quot;</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos" data-line="1609"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;placeholder&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">label</span><span class="p">);</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos" data-line="1610"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">old</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">label</span><span class="p">);</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos" data-line="1611"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">old</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos" data-line="1612"></span></a><span class="w">      </span><span class="nx">old</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">old</span><span class="p">);</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos" data-line="1613"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos" data-line="1614"></span></a><span class="w">   </span><span class="nx">content</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">content</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">label</span><span class="p">;</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos" data-line="1615"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos" data-line="1616"></span></a><span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">hasChildNodes</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos" data-line="1617"></span></a><span class="w">         </span><span class="nx">node</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos" data-line="1618"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos" data-line="1619"></span></a><span class="w">      </span><span class="nx">node</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos" data-line="1620"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos" data-line="1621"></span></a><span class="p">}</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos" data-line="1622"></span></a>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos" data-line="1623"></span></a><span class="c1">// ======================================================</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos" data-line="1624"></span></a><span class="c1">// move an element away from its current position</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos" data-line="1625"></span></a><span class="c1">// and append it to a target element if condition is true</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos" data-line="1626"></span></a><span class="c1">// ======================================================</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos" data-line="1627"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwMove</span><span class="p">(</span><span class="nx">mv</span><span class="p">,</span><span class="w"> </span><span class="nx">tg</span><span class="p">,</span><span class="w"> </span><span class="nx">condition</span><span class="p">,</span><span class="w"> </span><span class="nx">toStart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos" data-line="1628"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">condition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos" data-line="1629"></span></a><span class="w">      </span><span class="nx">move</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">mv</span><span class="p">);</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos" data-line="1630"></span></a><span class="w">      </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">tg</span><span class="p">);</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos" data-line="1631"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">move</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos" data-line="1632"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">move</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos" data-line="1633"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="nx">target</span><span class="o">===</span><span class="nx">parent</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos" data-line="1634"></span></a><span class="w">            </span><span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">move</span><span class="p">);</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos" data-line="1635"></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">toStart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos" data-line="1636"></span></a><span class="w">               </span><span class="nx">target</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">move</span><span class="p">,</span><span class="w"> </span><span class="nx">target</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos" data-line="1637"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos" data-line="1638"></span></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos" data-line="1639"></span></a><span class="w">               </span><span class="nx">target</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">move</span><span class="p">);</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos" data-line="1640"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos" data-line="1641"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos" data-line="1642"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos" data-line="1643"></span></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos" data-line="1644"></span></a><span class="w">         </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find elements: move=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;(&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">move</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;), target=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;(&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;)&quot;</span><span class="p">);</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos" data-line="1645"></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos" data-line="1646"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos" data-line="1647"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">condition</span><span class="p">;</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos" data-line="1648"></span></a><span class="p">}</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos" data-line="1649"></span></a>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos" data-line="1650"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos" data-line="1651"></span></a><span class="c1">// make an element visible/invisible</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos" data-line="1652"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos" data-line="1653"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="nx">tg</span><span class="p">,</span><span class="w"> </span><span class="nx">condition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos" data-line="1654"></span></a><span class="w">   </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">tg</span><span class="p">);</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos" data-line="1655"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos" data-line="1656"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">condition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos" data-line="1657"></span></a><span class="w">         </span><span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos" data-line="1658"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos" data-line="1659"></span></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos" data-line="1660"></span></a><span class="w">         </span><span class="nx">$</span><span class="p">(</span><span class="nx">target</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos" data-line="1661"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos" data-line="1662"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos" data-line="1663"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos" data-line="1664"></span></a><span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Element not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="p">(</span><span class="nx">tg</span><span class="p">.</span><span class="nx">nodeType</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">tg</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">tg</span><span class="p">));</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos" data-line="1665"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos" data-line="1666"></span></a><span class="p">}</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos" data-line="1667"></span></a>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos" data-line="1668"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos" data-line="1669"></span></a><span class="c1">// set enabled/disabled status for an element and/or</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos" data-line="1670"></span></a><span class="c1">// all input controls contained in it.</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos" data-line="1671"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos" data-line="1672"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwSetEnabled</span><span class="p">(</span><span class="nx">tg</span><span class="p">,</span><span class="w"> </span><span class="nx">condition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos" data-line="1673"></span></a><span class="w">   </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">tg</span><span class="p">);</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos" data-line="1674"></span></a><span class="w">   </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos" data-line="1675"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^(input|textarea|select|button|a)$/i</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos" data-line="1676"></span></a><span class="w">         </span><span class="p">[</span><span class="nx">target</span><span class="p">]</span><span class="w"> </span><span class="o">:</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos" data-line="1677"></span></a><span class="w">         </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; *&#39;</span><span class="p">));</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos" data-line="1678"></span></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos" data-line="1679"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">tagName</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^(input|textarea|select|button|a)$/i</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos" data-line="1680"></span></a><span class="w">            </span><span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">disabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">condition</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;disabled&quot;</span><span class="p">);</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos" data-line="1681"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos" data-line="1682"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos" data-line="1683"></span></a><span class="w">   </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Element not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="p">(</span><span class="nx">tg</span><span class="p">.</span><span class="nx">nodeType</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">tg</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">tg</span><span class="p">));</span><span class="w"> </span><span class="p">}</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos" data-line="1684"></span></a><span class="p">}</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos" data-line="1685"></span></a>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos" data-line="1686"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos" data-line="1687"></span></a><span class="c1">// convenience function to check whether a given</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos" data-line="1688"></span></a><span class="c1">// element is currenly visible. Needs to check display</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos" data-line="1689"></span></a><span class="c1">// property of the element and its ancestors</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos" data-line="1690"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos" data-line="1691"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwIsVisible</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos" data-line="1692"></span></a><span class="w">   </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos" data-line="1693"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">element</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos" data-line="1694"></span></a><span class="w">   </span><span class="nx">el</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">element</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos" data-line="1695"></span></a><span class="w">   </span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos" data-line="1696"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos" data-line="1697"></span></a><span class="w">   </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos" data-line="1698"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos" data-line="1699"></span></a><span class="w">         </span><span class="nx">visible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos" data-line="1700"></span></a><span class="w">         </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos" data-line="1701"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos" data-line="1702"></span></a><span class="w">      </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos" data-line="1703"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos" data-line="1704"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">visible</span><span class="p">;</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos" data-line="1705"></span></a><span class="p">}</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos" data-line="1706"></span></a>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos" data-line="1707"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos" data-line="1708"></span></a><span class="c1">// cleanup filename</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos" data-line="1709"></span></a><span class="c1">// ===================================================</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos" data-line="1710"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwCleanFilename</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos" data-line="1711"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">nameBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos" data-line="1712"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">oldname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos" data-line="1713"></span></a>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos" data-line="1714"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos" data-line="1715"></span></a><span class="w">      </span><span class="c1">// strip accidentally added [[   ]] or [[:  ]] brackets</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos" data-line="1716"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(^\[\[:?)|(\]\]$)/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos" data-line="1717"></span></a><span class="w">      </span><span class="c1">// strip accidentally added &quot;File:&quot; prefix</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos" data-line="1718"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^(File|Image):/</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos" data-line="1719"></span></a><span class="w">      </span><span class="c1">// replace underscores with spaces</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos" data-line="1720"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/_/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">);</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos" data-line="1721"></span></a><span class="w">      </span><span class="c1">// uppercase first letter</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos" data-line="1722"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">toUpperCase</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos" data-line="1723"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos" data-line="1724"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">oldname</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos" data-line="1725"></span></a><span class="w">      </span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos" data-line="1726"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos" data-line="1727"></span></a><span class="w">   </span><span class="c1">// always return true so the next validation step will proceed:</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos" data-line="1728"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos" data-line="1729"></span></a><span class="p">}</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos" data-line="1730"></span></a>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos" data-line="1731"></span></a>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos" data-line="1732"></span></a><span class="c1">// ==================================================</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos" data-line="1733"></span></a><span class="c1">// check filename for technically illegal </span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos" data-line="1734"></span></a><span class="c1">// characters, trying to fix them automatically</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos" data-line="1735"></span></a><span class="c1">// ==================================================</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos" data-line="1736"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwCheckLegalFilename</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos" data-line="1737"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">nameBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos" data-line="1738"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">oldname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos" data-line="1739"></span></a>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos" data-line="1740"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos" data-line="1741"></span></a><span class="w">      </span><span class="c1">// resolve accidentally entered html entities and URI-encoded %XX character codes</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos" data-line="1742"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\&amp;[a-z]+;/g</span><span class="p">,</span><span class="w"> </span><span class="nx">fuwHtmlEntityDecode</span><span class="p">);</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos" data-line="1743"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(\%[A-F0-9]{2,2})/g</span><span class="p">,</span><span class="w"> </span><span class="nb">decodeURI</span><span class="p">);</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos" data-line="1744"></span></a><span class="w">      </span><span class="c1">// remove illegal characters # &lt; &gt; [ ] | { } /:</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos" data-line="1745"></span></a><span class="w">      </span><span class="c1">// using a best guess for an acceptable replacement</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos" data-line="1746"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[&lt;\[\{]/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(&quot;</span><span class="p">);</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos" data-line="1747"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[&gt;\]\}]/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;)&quot;</span><span class="p">);</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos" data-line="1748"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[#:\|]/g</span><span class="p">,</span><span class="w">  </span><span class="s2">&quot;,&quot;</span><span class="p">);</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos" data-line="1749"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">);</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos" data-line="1750"></span></a><span class="w">      </span><span class="c1">// remove sequences of tildes</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos" data-line="1751"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\~{3,}/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;---&quot;</span><span class="p">);</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos" data-line="1752"></span></a><span class="w">      </span><span class="c1">// remove initial slash</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos" data-line="1753"></span></a><span class="w">      </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\//</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos" data-line="1754"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos" data-line="1755"></span></a><span class="w">   </span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos" data-line="1756"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">oldname</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos" data-line="1757"></span></a><span class="w">      </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">warn</span><span class="p">.</span><span class="nx">IllegalChars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos" data-line="1758"></span></a><span class="w">      </span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos" data-line="1759"></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos" data-line="1760"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos" data-line="1761"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos" data-line="1762"></span></a><span class="w">      </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">warn</span><span class="p">.</span><span class="nx">IllegalChars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos" data-line="1763"></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos" data-line="1764"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos" data-line="1765"></span></a><span class="p">}</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos" data-line="1766"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwHtmlEntityDecode</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos" data-line="1767"></span></a><span class="w">   </span><span class="c1">// hack to translate accidentally entered html entity code</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos" data-line="1768"></span></a><span class="w">   </span><span class="c1">// into actual characters</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos" data-line="1769"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">ta</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;textarea&#39;</span><span class="p">);</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos" data-line="1770"></span></a><span class="w">   </span><span class="nx">ta</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span><span class="s1">&#39;&amp;lt;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span><span class="s1">&#39;&amp;gt;&#39;</span><span class="p">);</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos" data-line="1771"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">ta</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos" data-line="1772"></span></a><span class="p">}</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos" data-line="1773"></span></a>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos" data-line="1774"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos" data-line="1775"></span></a><span class="c1">// Check against various common patterns of poorly chosen</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos" data-line="1776"></span></a><span class="c1">// filenames (too short / too generic)</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos" data-line="1777"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos" data-line="1778"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwCheckPoorFilename</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos" data-line="1779"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">nameBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos" data-line="1780"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos" data-line="1781"></span></a><span class="w">	</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\.(png|gif|jpg|jpeg|xcf|pdf|mid|ogg|ogv|svg|djvu|tiff|tif|oga|mp3|webp|webm|opus|mpg|mpeg|wav|wave|flac)$/i</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos" data-line="1782"></span></a>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos" data-line="1783"></span></a><span class="w">   </span><span class="c1">// name should be at least 10 characters long, excluding file type extension</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos" data-line="1784"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">tooShort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos" data-line="1785"></span></a><span class="w">   </span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos" data-line="1786"></span></a><span class="w">   </span><span class="c1">// common generic filename patterns: </span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos" data-line="1787"></span></a><span class="w">   </span><span class="c1">// IMG......jpg</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos" data-line="1788"></span></a><span class="w">   </span><span class="c1">// Image....jpg</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos" data-line="1789"></span></a><span class="w">   </span><span class="c1">// DSC......jpg</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos" data-line="1790"></span></a><span class="w">   </span><span class="c1">// Picture......jpg</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos" data-line="1791"></span></a><span class="w">   </span><span class="c1">// Pic..........jpg</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos" data-line="1792"></span></a><span class="w">   </span><span class="c1">// anything that has fewer than 3 alphabetic letters and then just numbers</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos" data-line="1793"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^(img|image|dsc|picture|pic)?(\\s*|\\_*|[a-z]{,3})?\\d+$/i</span><span class="p">;</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos" data-line="1794"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">auto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">pattern</span><span class="p">);</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos" data-line="1795"></span></a>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos" data-line="1796"></span></a><span class="w">   </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">warn</span><span class="p">.</span><span class="nx">BadFilename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">tooShort</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">auto</span><span class="p">);</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos" data-line="1797"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="nx">tooShort</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nx">auto</span><span class="p">;</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos" data-line="1798"></span></a><span class="p">}</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos" data-line="1799"></span></a>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos" data-line="1800"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos" data-line="1801"></span></a><span class="c1">// check if file extensions match between local filename</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos" data-line="1802"></span></a><span class="c1">// and target filename input box. Automatically append </span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos" data-line="1803"></span></a><span class="c1">// appropriate extension to target filename if they don&#39;t.</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos" data-line="1804"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos" data-line="1805"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwCheckFileExtension</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos" data-line="1806"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">nameBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos" data-line="1807"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos" data-line="1808"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">fileBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">TargetForm</span><span class="p">.</span><span class="nx">file</span><span class="p">;</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos" data-line="1809"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fileBox</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos" data-line="1810"></span></a><span class="w">   </span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos" data-line="1811"></span></a><span class="w">   </span><span class="c1">// cancel check if no filename has been provided yet</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos" data-line="1812"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">file</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos" data-line="1813"></span></a><span class="w">   </span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos" data-line="1814"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">extensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/.+\.(png|gif|jpg|jpeg|xcf|pdf|mid|ogg|ogv|svg|djvu|tiff|tif|oga|mp3|webp|webm|opus|mpg|mpeg|wav|wave|flac)$/i</span><span class="p">;</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos" data-line="1815"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">mimetypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos" data-line="1816"></span></a><span class="w">      </span><span class="s2">&quot;png&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos" data-line="1817"></span></a><span class="w">      </span><span class="s2">&quot;gif&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/gif&quot;</span><span class="p">,</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos" data-line="1818"></span></a><span class="w">      </span><span class="s2">&quot;jpg&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/jpeg&quot;</span><span class="p">,</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos" data-line="1819"></span></a><span class="w">      </span><span class="s2">&quot;jpeg&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/jpeg&quot;</span><span class="p">,</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos" data-line="1820"></span></a><span class="w">      </span><span class="s2">&quot;xcf&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/x-xcf&quot;</span><span class="p">,</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos" data-line="1821"></span></a><span class="w">      </span><span class="s2">&quot;webp&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/webp&quot;</span><span class="p">,</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos" data-line="1822"></span></a><span class="w">      </span><span class="s2">&quot;pdf&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/pdf&quot;</span><span class="p">,</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos" data-line="1823"></span></a><span class="w">      </span><span class="s2">&quot;mid&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;audio/rtp-midi&quot;</span><span class="p">,</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos" data-line="1824"></span></a><span class="w">      </span><span class="s2">&quot;ogg&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;audio/ogg&quot;</span><span class="p">,</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos" data-line="1825"></span></a><span class="w">      </span><span class="s2">&quot;mp3&quot;</span><span class="w">	 </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;audio/mp3&quot;</span><span class="p">,</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos" data-line="1826"></span></a><span class="w">      </span><span class="s2">&quot;opus&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;audio/opus&quot;</span><span class="p">,</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos" data-line="1827"></span></a><span class="w">      </span><span class="s2">&quot;wav&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;audio/wav&quot;</span><span class="p">,</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos" data-line="1828"></span></a><span class="w">      </span><span class="s2">&quot;wave&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;audio/wav&quot;</span><span class="p">,</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos" data-line="1829"></span></a><span class="w">      </span><span class="s2">&quot;flac&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;audio/flac&quot;</span><span class="p">,</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos" data-line="1830"></span></a><span class="w">      </span><span class="s2">&quot;ogv&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;video/ogg&quot;</span><span class="p">,</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos" data-line="1831"></span></a><span class="w">      </span><span class="s2">&quot;svg&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/svg+xml&quot;</span><span class="p">,</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos" data-line="1832"></span></a><span class="w">      </span><span class="s2">&quot;djvu&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/vnd.djvu&quot;</span><span class="p">,</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos" data-line="1833"></span></a><span class="w">      </span><span class="s2">&quot;tiff&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/tiff&quot;</span><span class="p">,</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos" data-line="1834"></span></a><span class="w">      </span><span class="s2">&quot;tif&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;image/tiff&quot;</span><span class="p">,</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos" data-line="1835"></span></a><span class="w">      </span><span class="s2">&quot;oga&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;video/ogg&quot;</span><span class="p">,</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos" data-line="1836"></span></a><span class="w">      </span><span class="s2">&quot;webm&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;video/webm&quot;</span><span class="p">,</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos" data-line="1837"></span></a><span class="w">      </span><span class="s2">&quot;mpg&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;video/mpeg&quot;</span><span class="p">,</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos" data-line="1838"></span></a><span class="w">      </span><span class="s2">&quot;mpeg&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;video/mpeg&quot;</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos" data-line="1839"></span></a><span class="w">   </span><span class="p">};</span><span class="w">   </span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos" data-line="1840"></span></a>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos" data-line="1841"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extensions</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos" data-line="1842"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">fileExt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">found</span><span class="p">[</span><span class="mf">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos" data-line="1843"></span></a><span class="w">   </span><span class="nx">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">extensions</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos" data-line="1844"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">nameExt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">found</span><span class="p">[</span><span class="mf">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos" data-line="1845"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">mime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mimetypes</span><span class="p">[</span><span class="nx">fileExt</span><span class="p">];</span><span class="w"> </span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos" data-line="1846"></span></a><span class="w">   </span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos" data-line="1847"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fileExt</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">mime</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">mimetypes</span><span class="p">[</span><span class="nx">nameExt</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">mime</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos" data-line="1848"></span></a><span class="w">      </span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\.?$/</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fileExt</span><span class="p">));</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos" data-line="1849"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos" data-line="1850"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos" data-line="1851"></span></a><span class="p">}</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos" data-line="1852"></span></a>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos" data-line="1853"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos" data-line="1854"></span></a><span class="c1">// Check if a file under the chosen name already exists,</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos" data-line="1855"></span></a><span class="c1">// either locally or on Commons.</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos" data-line="1856"></span></a><span class="c1">// Store results in the fuw.warn object, so warnings will</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos" data-line="1857"></span></a><span class="c1">// be displayed on the next fuwUpdateOptions() call</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos" data-line="1858"></span></a><span class="c1">// ============================================================</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos" data-line="1859"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwCheckFileExists</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos" data-line="1860"></span></a><span class="w">   </span><span class="c1">// this is an asynchronous AJAX function.</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos" data-line="1861"></span></a><span class="w">   </span><span class="c1">// results won&#39;t yet be present when this function returns.</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos" data-line="1862"></span></a>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos" data-line="1863"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">nameBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos" data-line="1864"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos" data-line="1865"></span></a>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos" data-line="1866"></span></a><span class="w">   </span><span class="c1">// using the jQuery wrapper for the Ajax functionality:</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos" data-line="1867"></span></a><span class="w">   </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos" data-line="1868"></span></a><span class="w">      </span><span class="nx">url</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">wikiScript</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;api&#39;</span><span class="w"> </span><span class="p">),</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos" data-line="1869"></span></a><span class="w">      </span><span class="nx">type</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos" data-line="1870"></span></a><span class="w">      </span><span class="nx">dataType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos" data-line="1871"></span></a><span class="w">      </span><span class="nx">traditional</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos" data-line="1872"></span></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w">   </span><span class="p">{</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos" data-line="1873"></span></a><span class="w">               </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos" data-line="1874"></span></a><span class="w">               </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">,</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos" data-line="1875"></span></a><span class="w">               </span><span class="nx">titles</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;File:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos" data-line="1876"></span></a><span class="w">               </span><span class="nx">prop</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;imageinfo&#39;</span><span class="p">,</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos" data-line="1877"></span></a><span class="w">               </span><span class="nx">iiprop</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;url|user&#39;</span><span class="p">,</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos" data-line="1878"></span></a><span class="w">               </span><span class="nx">iiurlwidth</span><span class="o">:</span><span class="w"> </span><span class="mf">120</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos" data-line="1879"></span></a><span class="w">              </span><span class="p">},</span><span class="w">      </span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos" data-line="1880"></span></a><span class="w">      </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos" data-line="1881"></span></a><span class="w">      </span><span class="c1">// callback function, called when API query has succeeded:</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos" data-line="1882"></span></a><span class="w">         </span><span class="c1">// see if the request has returned info from an existing image:</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos" data-line="1883"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">foundlist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">resp</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">);</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos" data-line="1884"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">foundlist</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos" data-line="1885"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">isCommons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos" data-line="1886"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">exists</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos" data-line="1887"></span></a>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos" data-line="1888"></span></a><span class="w">            </span><span class="c1">// extract description data from http response.</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos" data-line="1889"></span></a><span class="w">            </span><span class="c1">// see https://www.mediawiki.org/wiki/API:Properties#imageinfo_.2F_ii </span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos" data-line="1890"></span></a><span class="w">            </span><span class="c1">// for structure of API response</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos" data-line="1891"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">foundImg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundlist</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos" data-line="1892"></span></a><span class="w">            </span><span class="nx">isCommons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;imagerepository&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;shared&#39;</span><span class="p">);</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos" data-line="1893"></span></a>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos" data-line="1894"></span></a><span class="w">            </span><span class="c1">// need this data for creating our own image thumb link</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos" data-line="1895"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;thumbwidth&#39;</span><span class="p">);</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos" data-line="1896"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;thumbheight&#39;</span><span class="p">);</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos" data-line="1897"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">thumbURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;thumburl&#39;</span><span class="p">);</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos" data-line="1898"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">lastUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">);</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos" data-line="1899"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">descURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;descriptionurl&#39;</span><span class="p">);</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos" data-line="1900"></span></a>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos" data-line="1901"></span></a><span class="w">            </span><span class="c1">// API returns link to local description page even for Commons images.</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos" data-line="1902"></span></a><span class="w">            </span><span class="c1">// However, we want a direct link to Commons.</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos" data-line="1903"></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isCommons</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos" data-line="1904"></span></a><span class="w">               </span><span class="nx">descURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">descURL</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/en\.wikipedia\.org/</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;commons.wikimedia.org&quot;</span><span class="p">);</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos" data-line="1905"></span></a><span class="w">               </span><span class="nx">descURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">descURL</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\/\/secure\.wikimedia\.org\/wikipedia\/en/</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;commons.wikimedia.org&quot;</span><span class="p">);</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos" data-line="1906"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos" data-line="1907"></span></a>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos" data-line="1908"></span></a><span class="w">            </span><span class="c1">// build the image info into the warning section of our page:</span>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos" data-line="1909"></span></a><span class="w">            </span><span class="nx">thumbDiv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;warningImageThumb&#39;</span><span class="p">);</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos" data-line="1910"></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">thumbDiv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos" data-line="1911"></span></a><span class="w">            </span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos" data-line="1912"></span></a><span class="w">               </span><span class="c1">// make all links point to description page:</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos" data-line="1913"></span></a><span class="w">               </span><span class="kd">var</span><span class="w"> </span><span class="nx">thumbA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">thumbDiv</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos" data-line="1914"></span></a><span class="w">               </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">thumbA</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos" data-line="1915"></span></a><span class="w">                  </span><span class="nx">thumbA</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">descURL</span><span class="p">);</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos" data-line="1916"></span></a><span class="w">               </span><span class="p">}</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos" data-line="1917"></span></a><span class="w">               </span><span class="c1">// insert the image itself:</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos" data-line="1918"></span></a><span class="w">               </span><span class="kd">var</span><span class="w"> </span><span class="nx">thumbImg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">thumbDiv</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">);</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos" data-line="1919"></span></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">thumbImg</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos" data-line="1920"></span></a><span class="w">                  </span><span class="nx">thumbImg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">thumbImg</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos" data-line="1921"></span></a><span class="w">                  </span><span class="nx">thumbImg</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">thumbURL</span><span class="p">);</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos" data-line="1922"></span></a><span class="w">                  </span><span class="nx">thumbImg</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="p">);</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos" data-line="1923"></span></a><span class="w">                  </span><span class="nx">thumbImg</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">);</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos" data-line="1924"></span></a><span class="w">               </span><span class="p">}</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos" data-line="1925"></span></a><span class="w">               </span><span class="c1">// insert the name of the last uploader:</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos" data-line="1926"></span></a><span class="w">               </span><span class="kd">var</span><span class="w"> </span><span class="nx">thumbSpan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;existingImageUploader&#39;</span><span class="p">);</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos" data-line="1927"></span></a><span class="w">               </span><span class="c1">// TO DO: turn this into a proper link</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos" data-line="1928"></span></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">thumbSpan</span><span class="p">)</span><span class="w"> </span><span class="nx">thumbSpan</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lastUser</span><span class="p">;</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos" data-line="1929"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos" data-line="1930"></span></a>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos" data-line="1931"></span></a><span class="w">            </span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos" data-line="1932"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos" data-line="1933"></span></a><span class="w">         </span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">warn</span><span class="p">;</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos" data-line="1934"></span></a><span class="w">         </span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageOnCommons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">isCommons</span><span class="p">;</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos" data-line="1935"></span></a><span class="w">         </span><span class="nx">warn</span><span class="p">.</span><span class="nx">ImageExists</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nx">isCommons</span><span class="p">;</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos" data-line="1936"></span></a>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos" data-line="1937"></span></a><span class="w">         </span><span class="nx">fuwUpdateOptions</span><span class="p">();</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos" data-line="1938"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos" data-line="1939"></span></a><span class="w">   </span><span class="p">});</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos" data-line="1940"></span></a><span class="p">}</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos" data-line="1941"></span></a>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos" data-line="1942"></span></a><span class="c1">// ===========================================================</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos" data-line="1943"></span></a><span class="c1">// onchange event handler for the local filename box</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos" data-line="1944"></span></a><span class="c1">// ===========================================================</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos" data-line="1945"></span></a><span class="nx">fuwValidateFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos" data-line="1946"></span></a><span class="w">   </span><span class="nx">fuwCheckFileExtension</span><span class="p">();</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos" data-line="1947"></span></a><span class="w">   </span><span class="nx">fuwUpdateOptions</span><span class="p">();</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos" data-line="1948"></span></a><span class="p">}</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos" data-line="1949"></span></a>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos" data-line="1950"></span></a><span class="c1">// ===========================================================</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos" data-line="1951"></span></a><span class="c1">// onchange event handler for the name input box</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos" data-line="1952"></span></a><span class="c1">// ===========================================================</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos" data-line="1953"></span></a><span class="nx">fuwValidateFilename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos" data-line="1954"></span></a><span class="w">   </span><span class="nx">fuwCleanFilename</span><span class="p">();</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos" data-line="1955"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos" data-line="1956"></span></a><span class="w">      </span><span class="nx">fuwCheckLegalFilename</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos" data-line="1957"></span></a><span class="w">      </span><span class="nx">fuwCheckPoorFilename</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos" data-line="1958"></span></a><span class="w">      </span><span class="nx">fuwCheckFileExtension</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos" data-line="1959"></span></a><span class="w">      </span><span class="c1">// after fuwCheckFileExists(),</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos" data-line="1960"></span></a><span class="w">      </span><span class="c1">// fuwUpdateOptions will be triggered</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos" data-line="1961"></span></a><span class="w">      </span><span class="c1">// by the callback function after Ajax completion</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos" data-line="1962"></span></a><span class="w">      </span><span class="nx">fuwCheckFileExists</span><span class="p">();</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos" data-line="1963"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos" data-line="1964"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos" data-line="1965"></span></a><span class="w">      </span><span class="c1">// if there&#39;s been no Ajax call.</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos" data-line="1966"></span></a><span class="w">      </span><span class="nx">fuwUpdateOptions</span><span class="p">();</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos" data-line="1967"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos" data-line="1968"></span></a><span class="p">};</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos" data-line="1969"></span></a>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos" data-line="1970"></span></a><span class="c1">// ==========================================================</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos" data-line="1971"></span></a><span class="c1">// function fuwValidateNFArticle()</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos" data-line="1972"></span></a><span class="c1">// ==========================================================</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos" data-line="1973"></span></a><span class="c1">// This is the validation routine for the obligatory</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos" data-line="1974"></span></a><span class="c1">// article-to-be-used-in field for non-free files. It queries</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos" data-line="1975"></span></a><span class="c1">// api.php about the target article through an Ajax call.</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos" data-line="1976"></span></a><span class="c1">// It will store error info in the fuw.warn object,</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos" data-line="1977"></span></a><span class="c1">// triggering the following error on the next updateOptions():</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos" data-line="1978"></span></a><span class="c1">// * warningNFArticleNotFound : target page doesn&#39;t exist.</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos" data-line="1979"></span></a><span class="c1">// * warningNFArticleNotMainspace : target is not an article. </span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos" data-line="1980"></span></a><span class="c1">// * warningNFArticleDab : target is a disambiguation page.</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos" data-line="1981"></span></a><span class="c1">// Redirects will automatically be substituted.</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos" data-line="1982"></span></a><span class="c1">// ==========================================================</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos" data-line="1983"></span></a><span class="nx">fuwValidateNFArticle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos" data-line="1984"></span></a><span class="w">   </span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos" data-line="1985"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">nameBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">NFArticle</span><span class="p">;</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos" data-line="1986"></span></a><span class="w">   </span><span class="nx">oldname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos" data-line="1987"></span></a><span class="w">   </span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos" data-line="1988"></span></a><span class="w">   </span><span class="c1">// cleanup article name:</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos" data-line="1989"></span></a><span class="w">   </span><span class="c1">// automatically fix accidentally added [[ ... ]] and</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos" data-line="1990"></span></a><span class="w">   </span><span class="c1">// regularize underscores</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos" data-line="1991"></span></a><span class="w">   </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos" data-line="1992"></span></a><span class="w">   </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(^\[\[)|(\]\]$)/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos" data-line="1993"></span></a><span class="w">   </span><span class="c1">// automatically fix article names entered as full urls:</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos" data-line="1994"></span></a><span class="w">   </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^https?:\/\/en\.wikipedia\.org\/wiki\//</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos" data-line="1995"></span></a><span class="w">   </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^https?:\/\/en\.wikipedia\.org\/w\/index\.php\?title=/</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos" data-line="1996"></span></a><span class="w">   </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/_/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">);</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos" data-line="1997"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">name</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">oldname</span><span class="p">)</span><span class="w"> </span><span class="nx">nameBox</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos" data-line="1998"></span></a><span class="w">   </span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos" data-line="1999"></span></a><span class="w">   </span><span class="c1">// do nothing more if field was blank</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos" data-line="2000"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos" data-line="2001"></span></a>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos" data-line="2002"></span></a><span class="w">   </span><span class="c1">// using the jQuery wrapper for the Ajax functionality:</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos" data-line="2003"></span></a><span class="w">   </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos" data-line="2004"></span></a><span class="w">      </span><span class="nx">url</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">wikiScript</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;api&#39;</span><span class="w"> </span><span class="p">),</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos" data-line="2005"></span></a><span class="w">      </span><span class="nx">type</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos" data-line="2006"></span></a><span class="w">      </span><span class="nx">dataType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos" data-line="2007"></span></a><span class="w">      </span><span class="nx">traditional</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos" data-line="2008"></span></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w">   </span><span class="p">{</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos" data-line="2009"></span></a><span class="w">               </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos" data-line="2010"></span></a><span class="w">               </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">,</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos" data-line="2011"></span></a><span class="w">               </span><span class="nx">titles</span><span class="o">:</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos" data-line="2012"></span></a><span class="w">               </span><span class="nx">prop</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;info|categories|links&#39;</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos" data-line="2013"></span></a><span class="w">              </span><span class="p">},</span><span class="w">      </span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos" data-line="2014"></span></a><span class="w">      </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos" data-line="2015"></span></a><span class="w">      </span><span class="c1">// callback function, called when API query has succeeded:</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos" data-line="2016"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos" data-line="2017"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">pg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">resp</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;page&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos" data-line="2018"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos" data-line="2019"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">title</span><span class="p">;</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos" data-line="2020"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">pg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;missing&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos" data-line="2021"></span></a><span class="w">            </span><span class="c1">// no page found under this title.</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos" data-line="2022"></span></a><span class="w">            </span><span class="nx">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos" data-line="2023"></span></a><span class="w">         </span><span class="p">}</span><span class="w">           </span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos" data-line="2024"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos" data-line="2025"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">userspace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos" data-line="2026"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">ns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;ns&#39;</span><span class="p">);</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos" data-line="2027"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;redirect&#39;</span><span class="p">);</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos" data-line="2028"></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">ns</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos" data-line="2029"></span></a><span class="w">               </span><span class="c1">// not a mainspace page!</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos" data-line="2030"></span></a><span class="w">               </span><span class="nx">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos" data-line="2031"></span></a>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos" data-line="2032"></span></a><span class="w">               </span><span class="c1">// try to detect if the target might be a user space draft:               </span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos" data-line="2033"></span></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;User( talk)?:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgUserName&#39;</span><span class="p">))))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos" data-line="2034"></span></a><span class="w">                  </span><span class="nx">userspace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos" data-line="2035"></span></a><span class="w">               </span><span class="p">}</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos" data-line="2036"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos" data-line="2037"></span></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">rd</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos" data-line="2038"></span></a><span class="w">               </span><span class="c1">// redirect page</span>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos" data-line="2039"></span></a><span class="w">               </span><span class="c1">// API returns an empty redirect=&quot;&quot; attribute if</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos" data-line="2040"></span></a><span class="w">               </span><span class="c1">// the page is a redirect</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos" data-line="2041"></span></a><span class="w">               </span><span class="kd">var</span><span class="w"> </span><span class="nx">targets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pg</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;pl&#39;</span><span class="p">);</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos" data-line="2042"></span></a><span class="w">               </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">targets</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos" data-line="2043"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">targets</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos" data-line="2044"></span></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">link</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;ns&#39;</span><span class="p">)</span><span class="o">==</span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos" data-line="2045"></span></a><span class="w">                     </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">link</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos" data-line="2046"></span></a><span class="w">                     </span><span class="nx">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos" data-line="2047"></span></a><span class="w">                     </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos" data-line="2048"></span></a><span class="w">                  </span><span class="p">}</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos" data-line="2049"></span></a><span class="w">               </span><span class="p">}</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos" data-line="2050"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos" data-line="2051"></span></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos" data-line="2052"></span></a><span class="w">               </span><span class="c1">// check for disambiguation categories</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos" data-line="2053"></span></a><span class="w">               </span><span class="kd">var</span><span class="w"> </span><span class="nx">cats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pg</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;cl&#39;</span><span class="p">);</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos" data-line="2054"></span></a><span class="w">               </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">cats</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos" data-line="2055"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cats</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos" data-line="2056"></span></a><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">cat</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Category:All disambiguation pages&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos" data-line="2057"></span></a><span class="w">                     </span><span class="nx">errorType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4</span><span class="p">;</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos" data-line="2058"></span></a><span class="w">                     </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos" data-line="2059"></span></a><span class="w">                  </span><span class="p">}</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos" data-line="2060"></span></a><span class="w">               </span><span class="p">}</span><span class="w">  </span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos" data-line="2061"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos" data-line="2062"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos" data-line="2063"></span></a><span class="w">         </span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">warn</span><span class="p">;</span>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos" data-line="2064"></span></a><span class="w">         </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotFound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">errorType</span><span class="o">==</span><span class="mf">1</span><span class="p">);</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos" data-line="2065"></span></a><span class="w">         </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotMainspace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">errorType</span><span class="o">==</span><span class="mf">2</span><span class="p">);</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos" data-line="2066"></span></a><span class="w">         </span><span class="nx">warn</span><span class="p">.</span><span class="nx">UserspaceDraft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="nx">errorType</span><span class="o">==</span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">userspace</span><span class="p">);</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos" data-line="2067"></span></a><span class="w">         </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleDab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">errorType</span><span class="o">==</span><span class="mf">4</span><span class="p">);</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos" data-line="2068"></span></a><span class="w">         </span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleOK</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">errorType</span><span class="o">==</span><span class="mf">0</span><span class="p">);</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos" data-line="2069"></span></a>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos" data-line="2070"></span></a><span class="w">         </span><span class="c1">// fix links in error messages:</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos" data-line="2071"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotFound</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos" data-line="2072"></span></a><span class="w">            </span><span class="nx">fuwMakeWikilink</span><span class="p">(</span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;warningNFArticleNotFound&#39;</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos" data-line="2073"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos" data-line="2074"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleNotMainspace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos" data-line="2075"></span></a><span class="w">            </span><span class="nx">fuwMakeWikilink</span><span class="p">(</span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;warningNFArticleNotMainspace&#39;</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="nx">target</span><span class="p">);</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos" data-line="2076"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos" data-line="2077"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleDab</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos" data-line="2078"></span></a><span class="w">            </span><span class="nx">fuwMakeWikilink</span><span class="p">(</span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;warningNFArticleDab&#39;</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="nx">target</span><span class="p">);</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos" data-line="2079"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos" data-line="2080"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">warn</span><span class="p">.</span><span class="nx">NFArticleOK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos" data-line="2081"></span></a><span class="w">            </span><span class="nx">fuwMakeWikilink</span><span class="p">(</span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;NFArticleOK&#39;</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="nx">target</span><span class="p">);</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos" data-line="2082"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos" data-line="2083"></span></a><span class="w">                       </span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos" data-line="2084"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">errorType</span><span class="o">==</span><span class="mf">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos" data-line="2085"></span></a><span class="w">            </span><span class="c1">// automatically replace title with redirect target</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos" data-line="2086"></span></a><span class="w">            </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">ScriptForm</span><span class="p">.</span><span class="nx">NFArticle</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">target</span><span class="p">;</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos" data-line="2087"></span></a><span class="w">            </span><span class="c1">// need to recursively call validation again now</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos" data-line="2088"></span></a><span class="w">            </span><span class="c1">//if (confirm(name + &quot; is a redirect. Follow it to &quot; + target + &quot;?&quot;)) {</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos" data-line="2089"></span></a><span class="w">               </span><span class="nx">fuwValidateNFArticle</span><span class="p">();</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos" data-line="2090"></span></a><span class="w">            </span><span class="c1">//}</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos" data-line="2091"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos" data-line="2092"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos" data-line="2093"></span></a><span class="w">            </span><span class="nx">fuwUpdateOptions</span><span class="p">();</span>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos" data-line="2094"></span></a><span class="w">         </span><span class="p">}</span><span class="w">          </span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos" data-line="2095"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos" data-line="2096"></span></a><span class="w">   </span><span class="p">});</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos" data-line="2097"></span></a><span class="p">};</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos" data-line="2098"></span></a>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos" data-line="2099"></span></a><span class="c1">// ================================================</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos" data-line="2100"></span></a><span class="c1">// manually reload script (just for testing)</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos" data-line="2101"></span></a><span class="c1">// ================================================</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos" data-line="2102"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwReload</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos" data-line="2103"></span></a><span class="w">   </span><span class="nx">mw</span><span class="p">.</span><span class="nx">loader</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;http://localhost/script/uploadscript.js&#39;</span><span class="w"> </span><span class="p">);</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos" data-line="2104"></span></a><span class="w">   </span><span class="nx">fuwReset</span><span class="p">();</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos" data-line="2105"></span></a><span class="p">}</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos" data-line="2106"></span></a>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos" data-line="2107"></span></a><span class="c1">// ================================================</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos" data-line="2108"></span></a><span class="c1">// reset forms</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos" data-line="2109"></span></a><span class="c1">// TO DO: add a button that actually triggers this.</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos" data-line="2110"></span></a><span class="c1">// ================================================</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos" data-line="2111"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwReset</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos" data-line="2112"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">forms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">$content</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">);</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos" data-line="2113"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">forms</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos" data-line="2114"></span></a><span class="w">      </span><span class="nx">forms</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">reset</span><span class="p">();</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos" data-line="2115"></span></a><span class="w">      </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">warn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos" data-line="2116"></span></a><span class="w">      </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos" data-line="2117"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos" data-line="2118"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;UploadScriptArea&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos" data-line="2119"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;fuwSuccess&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos" data-line="2120"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;fuwWaiting&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos" data-line="2121"></span></a><span class="w">   </span><span class="nx">fuwUpdateOptions</span><span class="p">();</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos" data-line="2122"></span></a><span class="p">}</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos" data-line="2123"></span></a>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos" data-line="2124"></span></a><span class="c1">// ===============================================</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos" data-line="2125"></span></a><span class="c1">// convenience functions for string handling</span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos" data-line="2126"></span></a><span class="c1">// ===============================================</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos" data-line="2127"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwAppendLines</span><span class="p">(</span><span class="nx">parts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos" data-line="2128"></span></a><span class="w">   </span><span class="c1">// assemble a string from an array of strings.</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos" data-line="2129"></span></a><span class="w">   </span><span class="c1">// treat every second element as a conditional</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos" data-line="2130"></span></a><span class="w">   </span><span class="c1">// separator that will be included only if </span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos" data-line="2131"></span></a><span class="w">   </span><span class="c1">// surrounding elements are non-empty.</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos" data-line="2132"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos" data-line="2133"></span></a><span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos" data-line="2134"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos" data-line="2135"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">build</span><span class="p">)</span><span class="w"> </span><span class="nx">build</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">];</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos" data-line="2136"></span></a><span class="w">         </span><span class="nx">build</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">parts</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos" data-line="2137"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos" data-line="2138"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos" data-line="2139"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">build</span><span class="p">;</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos" data-line="2140"></span></a><span class="p">}</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos" data-line="2141"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwSurroundString</span><span class="p">(</span><span class="nx">prefix</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="p">,</span><span class="w"> </span><span class="nx">suffix</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos" data-line="2142"></span></a><span class="w">   </span><span class="c1">// put a prefix and a suffix on a string, </span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos" data-line="2143"></span></a><span class="w">   </span><span class="c1">// if the input string is non-empty.</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos" data-line="2144"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">content</span><span class="p">)</span><span class="w"> </span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos" data-line="2145"></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="nx">prefix</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">prefix</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">suffix</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">suffix</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="w"> </span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos" data-line="2146"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos" data-line="2147"></span></a><span class="p">}</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos" data-line="2148"></span></a>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos" data-line="2149"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos" data-line="2150"></span></a><span class="c1">// handler for the API response.</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos" data-line="2151"></span></a><span class="c1">// TO DO: expand stub to add real notification of success,</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos" data-line="2152"></span></a><span class="c1">// link to new file page, instructions about how to include</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos" data-line="2153"></span></a><span class="c1">// file in articles, etc.</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos" data-line="2154"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos" data-line="2155"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwUploadCompleted</span><span class="p">(</span><span class="nx">doc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos" data-line="2156"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">doc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos" data-line="2157"></span></a><span class="w">      </span><span class="c1">//alert(doc);</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos" data-line="2158"></span></a><span class="w">      </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;successThumb&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos" data-line="2159"></span></a>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos" data-line="2160"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">fuw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">;</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos" data-line="2161"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputName</span><span class="p">;</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos" data-line="2162"></span></a>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos" data-line="2163"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">uploads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;upload&#39;</span><span class="p">);</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos" data-line="2164"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos" data-line="2165"></span></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uploads</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&gt;=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos" data-line="2166"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">uploads</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;Success&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos" data-line="2167"></span></a><span class="w">            </span><span class="nx">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos" data-line="2168"></span></a><span class="w">            </span><span class="c1">// need to get the real resulting filename here; might be different from the requested one in some cases.</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos" data-line="2169"></span></a><span class="w">            </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uploads</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">);</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos" data-line="2170"></span></a><span class="w">            </span><span class="k">break</span><span class="p">;</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos" data-line="2171"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos" data-line="2172"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos" data-line="2173"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos" data-line="2174"></span></a>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos" data-line="2175"></span></a><span class="w">         </span><span class="c1">// need another ajax call to check the file is actually there,</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos" data-line="2176"></span></a><span class="w">         </span><span class="c1">// and to retrieve its direct thumb img url:</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos" data-line="2177"></span></a><span class="w">         </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos" data-line="2178"></span></a><span class="w">            </span><span class="nx">url</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">wikiScript</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;api&#39;</span><span class="w"> </span><span class="p">),</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos" data-line="2179"></span></a><span class="w">            </span><span class="nx">type</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos" data-line="2180"></span></a><span class="w">            </span><span class="nx">dataType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos" data-line="2181"></span></a><span class="w">            </span><span class="nx">traditional</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos" data-line="2182"></span></a><span class="w">            </span><span class="nx">data</span><span class="o">:</span><span class="w">   </span><span class="p">{</span>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos" data-line="2183"></span></a><span class="w">                     </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos" data-line="2184"></span></a><span class="w">                     </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">,</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos" data-line="2185"></span></a><span class="w">                     </span><span class="nx">titles</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;File:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos" data-line="2186"></span></a><span class="w">                     </span><span class="nx">prop</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;imageinfo&#39;</span><span class="p">,</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos" data-line="2187"></span></a><span class="w">                     </span><span class="nx">iiprop</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;url&#39;</span><span class="p">,</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos" data-line="2188"></span></a><span class="w">                     </span><span class="nx">iiurlwidth</span><span class="o">:</span><span class="w"> </span><span class="mf">120</span>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos" data-line="2189"></span></a><span class="w">                    </span><span class="p">},</span><span class="w">      </span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos" data-line="2190"></span></a><span class="w">            </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos" data-line="2191"></span></a><span class="w">               </span><span class="c1">// callback function, called when API query has succeeded:</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos" data-line="2192"></span></a><span class="w">               </span><span class="c1">// see if the request has returned info from an existing image:</span>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos" data-line="2193"></span></a>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos" data-line="2194"></span></a><span class="w">               </span><span class="kd">var</span><span class="w"> </span><span class="nx">foundImg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">resp</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos" data-line="2195"></span></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">foundImg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos" data-line="2196"></span></a>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos" data-line="2197"></span></a><span class="w">                  </span><span class="c1">// need this data for creating our own image thumb link</span>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos" data-line="2198"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;thumbwidth&#39;</span><span class="p">);</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos" data-line="2199"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;thumbheight&#39;</span><span class="p">);</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos" data-line="2200"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">thumbURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;thumburl&#39;</span><span class="p">);</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos" data-line="2201"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">lastUser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">);</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos" data-line="2202"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">descURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">foundImg</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;descriptionurl&#39;</span><span class="p">);</span>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos" data-line="2203"></span></a>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos" data-line="2204"></span></a><span class="w">                  </span><span class="c1">// build the thumbnail in the success message:</span>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos" data-line="2205"></span></a><span class="w">                  </span><span class="nx">thumbDiv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;successThumb&#39;</span><span class="p">);</span>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos" data-line="2206"></span></a><span class="w">                  </span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos" data-line="2207"></span></a><span class="w">                  </span><span class="c1">// make link point to description page:</span>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos" data-line="2208"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">thumbA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">thumbDiv</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos" data-line="2209"></span></a><span class="w">                  </span><span class="nx">thumbA</span><span class="p">.</span><span class="nx">href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">descURL</span><span class="p">;</span>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos" data-line="2210"></span></a>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos" data-line="2211"></span></a><span class="w">                  </span><span class="c1">// insert the image itself:</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos" data-line="2212"></span></a><span class="w">                  </span><span class="kd">var</span><span class="w"> </span><span class="nx">thumbImg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">thumbDiv</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos" data-line="2213"></span></a><span class="w">                  </span><span class="nx">thumbImg</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">thumbURL</span><span class="p">);</span>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos" data-line="2214"></span></a><span class="w">                  </span><span class="nx">thumbImg</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="p">);</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos" data-line="2215"></span></a><span class="w">                  </span><span class="nx">thumbImg</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">);</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos" data-line="2216"></span></a><span class="w">                  </span>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos" data-line="2217"></span></a><span class="w">                  </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="nx">thumbDiv</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos" data-line="2218"></span></a><span class="w">               </span><span class="p">}</span>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos" data-line="2219"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos" data-line="2220"></span></a><span class="w">         </span><span class="p">});</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos" data-line="2221"></span></a><span class="w">         </span><span class="nx">fuwMakeWikilink</span><span class="p">(</span>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos" data-line="2222"></span></a><span class="w">            </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;fuwSuccessLink2&#39;</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">],</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos" data-line="2223"></span></a><span class="w">            </span><span class="s1">&#39;File:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">name</span><span class="p">);</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos" data-line="2224"></span></a><span class="w">         </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;placeholderExFilename1&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos" data-line="2225"></span></a><span class="w">         </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;placeholderExFilename2&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos" data-line="2226"></span></a><span class="w">         </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;fuwSuccess&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos" data-line="2227"></span></a><span class="w">         </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;fuwWaiting&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos" data-line="2228"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos" data-line="2229"></span></a><span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos" data-line="2230"></span></a><span class="w">         </span><span class="kd">var</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">);</span>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos" data-line="2231"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos" data-line="2232"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">err</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">);</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos" data-line="2233"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">err</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;detail&#39;</span><span class="p">);</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos" data-line="2234"></span></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos" data-line="2235"></span></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">details</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos" data-line="2236"></span></a><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;, &quot;</span><span class="p">;</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos" data-line="2237"></span></a><span class="w">               </span><span class="nx">add</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">details</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">textContent</span><span class="p">;</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos" data-line="2238"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos" data-line="2239"></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">add</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos" data-line="2240"></span></a><span class="w">               </span><span class="nx">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; (&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;)&quot;</span><span class="p">;</span>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos" data-line="2241"></span></a><span class="w">            </span><span class="p">}</span>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos" data-line="2242"></span></a><span class="w">            </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Upload failed: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">info</span><span class="p">);</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos" data-line="2243"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos" data-line="2244"></span></a><span class="w">         </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos" data-line="2245"></span></a><span class="w">            </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Unknown error: upload may have failed.&quot;</span><span class="p">);</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos" data-line="2246"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos" data-line="2247"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos" data-line="2248"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos" data-line="2249"></span></a><span class="p">}</span>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos" data-line="2250"></span></a>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos" data-line="2251"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos" data-line="2252"></span></a><span class="c1">// Event handler for the real submit button</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos" data-line="2253"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos" data-line="2254"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwSubmitUpload</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos" data-line="2255"></span></a><span class="w">   </span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos" data-line="2256"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">fuw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">;</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos" data-line="2257"></span></a>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos" data-line="2258"></span></a><span class="w">   </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">collectInput</span><span class="p">();</span>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos" data-line="2259"></span></a><span class="w">   </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">formatOutput</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos" data-line="2260"></span></a>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos" data-line="2261"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwTesting</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos" data-line="2262"></span></a><span class="w">      </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;placeholderTestForm&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos" data-line="2263"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos" data-line="2264"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;UploadScriptArea&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos" data-line="2265"></span></a>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos" data-line="2266"></span></a><span class="w">   </span><span class="nx">fuwMakeWikilink</span><span class="p">(</span>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos" data-line="2267"></span></a><span class="w">     </span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;fuwSuccessLink&#39;</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;File:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputName</span><span class="p">);</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos" data-line="2268"></span></a><span class="w">   </span><span class="nx">fuwSetVisible</span><span class="p">(</span><span class="s1">&#39;fuwWaiting&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos" data-line="2269"></span></a>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos" data-line="2270"></span></a><span class="w">   </span><span class="c1">// Upload the file, then add success notification etc.</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos" data-line="2271"></span></a><span class="w">   </span><span class="c1">// Note that mw.Api doesn&#39;t have special support for the XML format, so even when the API</span>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos" data-line="2272"></span></a><span class="w">   </span><span class="c1">// returns an error, this won&#39;t be detected and it will call the success handler.</span>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos" data-line="2273"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">api</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">Api</span><span class="p">({</span>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos" data-line="2274"></span></a><span class="w">      </span><span class="nx">parameters</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">format</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="w"> </span><span class="p">},</span>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos" data-line="2275"></span></a><span class="w">      </span><span class="nx">ajax</span><span class="w">       </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">dataType</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="w"> </span><span class="p">}</span>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos" data-line="2276"></span></a><span class="w">   </span><span class="p">});</span>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos" data-line="2277"></span></a><span class="w">   </span><span class="nx">api</span><span class="p">.</span><span class="nx">upload</span><span class="p">(</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">TargetForm</span><span class="p">.</span><span class="nx">file</span><span class="p">,</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">UploadOptions</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">fuwUploadCompleted</span><span class="p">);</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos" data-line="2278"></span></a>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos" data-line="2279"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">opts</span><span class="p">;</span>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos" data-line="2280"></span></a><span class="w">   </span><span class="c1">// the API won&#39;t overwrite the description page text while overwriting</span>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos" data-line="2281"></span></a><span class="w">   </span><span class="c1">// a file, which is really, really, really annoying and stupid.</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos" data-line="2282"></span></a><span class="w">   </span><span class="c1">// So in the opts.OverwriteDifferent scenario, we need to edit</span>
</span><span id="L-2283"><a href="#L-2283"><span class="linenos" data-line="2283"></span></a><span class="w">   </span><span class="c1">// the description page through a separate ajax call. Dang.</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos" data-line="2284"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opts</span><span class="p">.</span><span class="nx">OverwriteDifferent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos" data-line="2285"></span></a><span class="w">      </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span id="L-2286"><a href="#L-2286"><span class="linenos" data-line="2286"></span></a><span class="w">         </span><span class="nx">url</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">wikiScript</span><span class="p">(</span><span class="s1">&#39;api&#39;</span><span class="p">),</span>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos" data-line="2287"></span></a><span class="w">         </span><span class="nx">type</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos" data-line="2288"></span></a><span class="w">         </span><span class="nx">dataType</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2289"><a href="#L-2289"><span class="linenos" data-line="2289"></span></a><span class="w">         </span><span class="nx">data</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos" data-line="2290"></span></a><span class="w">                  </span><span class="nx">format</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos" data-line="2291"></span></a><span class="w">                  </span><span class="nx">action</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;edit&#39;</span><span class="p">,</span>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos" data-line="2292"></span></a><span class="w">                  </span><span class="nx">title</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;File:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">InputName</span><span class="p">,</span>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos" data-line="2293"></span></a><span class="w">                  </span><span class="nx">token</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;csrfToken&#39;</span><span class="p">),</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos" data-line="2294"></span></a><span class="w">                  </span><span class="nx">summary</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">opts</span><span class="p">.</span><span class="nx">EditSummary</span><span class="p">,</span>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos" data-line="2295"></span></a><span class="w">                  </span><span class="nx">text</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">UploadOptions</span><span class="p">.</span><span class="nx">text</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos" data-line="2296"></span></a>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos" data-line="2297"></span></a><span class="w">                 </span><span class="p">}</span>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos" data-line="2298"></span></a><span class="w">      </span><span class="p">});</span>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos" data-line="2299"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos" data-line="2300"></span></a><span class="p">}</span>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos" data-line="2301"></span></a>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos" data-line="2302"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-2303"><a href="#L-2303"><span class="linenos" data-line="2303"></span></a><span class="c1">// Event handler for the Commons submit button</span>
</span><span id="L-2304"><a href="#L-2304"><span class="linenos" data-line="2304"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-2305"><a href="#L-2305"><span class="linenos" data-line="2305"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwSubmitCommons</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2306"><a href="#L-2306"><span class="linenos" data-line="2306"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">fuw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">;</span>
</span><span id="L-2307"><a href="#L-2307"><span class="linenos" data-line="2307"></span></a><span class="w">   </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">collectInput</span><span class="p">();</span>
</span><span id="L-2308"><a href="#L-2308"><span class="linenos" data-line="2308"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuw</span><span class="p">.</span><span class="nx">formatOutput</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span><span id="L-2309"><a href="#L-2309"><span class="linenos" data-line="2309"></span></a><span class="w">   </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;You will now be redirected to Commons. \nPlease use the Commons upload form to add categories to your file description, and then complete the upload.&quot;</span><span class="p">);</span>
</span><span id="L-2310"><a href="#L-2310"><span class="linenos" data-line="2310"></span></a><span class="w">   </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">url</span><span class="p">;</span>
</span><span id="L-2311"><a href="#L-2311"><span class="linenos" data-line="2311"></span></a><span class="p">}</span>
</span><span id="L-2312"><a href="#L-2312"><span class="linenos" data-line="2312"></span></a>
</span><span id="L-2313"><a href="#L-2313"><span class="linenos" data-line="2313"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-2314"><a href="#L-2314"><span class="linenos" data-line="2314"></span></a><span class="c1">// Event handler for the test submit button</span>
</span><span id="L-2315"><a href="#L-2315"><span class="linenos" data-line="2315"></span></a><span class="c1">// (write description string to sandbox only)</span>
</span><span id="L-2316"><a href="#L-2316"><span class="linenos" data-line="2316"></span></a><span class="c1">// =======================================================</span>
</span><span id="L-2317"><a href="#L-2317"><span class="linenos" data-line="2317"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwSubmitSandbox</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2318"><a href="#L-2318"><span class="linenos" data-line="2318"></span></a><span class="w">   </span><span class="kd">var</span><span class="w"> </span><span class="nx">frm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">TestForm</span><span class="p">;</span>
</span><span id="L-2319"><a href="#L-2319"><span class="linenos" data-line="2319"></span></a><span class="w">   </span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
</span><span id="L-2320"><a href="#L-2320"><span class="linenos" data-line="2320"></span></a><span class="w">      </span><span class="nx">url</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">wikiScript</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;api&#39;</span><span class="w"> </span><span class="p">),</span>
</span><span id="L-2321"><a href="#L-2321"><span class="linenos" data-line="2321"></span></a><span class="w">      </span><span class="nx">type</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span><span id="L-2322"><a href="#L-2322"><span class="linenos" data-line="2322"></span></a><span class="w">      </span><span class="nx">dataType</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2323"><a href="#L-2323"><span class="linenos" data-line="2323"></span></a><span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w">   </span><span class="p">{</span>
</span><span id="L-2324"><a href="#L-2324"><span class="linenos" data-line="2324"></span></a><span class="w">               </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;xml&#39;</span><span class="p">,</span>
</span><span id="L-2325"><a href="#L-2325"><span class="linenos" data-line="2325"></span></a><span class="w">               </span><span class="nx">action</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;edit&#39;</span><span class="p">,</span>
</span><span id="L-2326"><a href="#L-2326"><span class="linenos" data-line="2326"></span></a><span class="w">               </span><span class="nx">title</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wgPageName&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/sandbox&quot;</span><span class="p">,</span>
</span><span id="L-2327"><a href="#L-2327"><span class="linenos" data-line="2327"></span></a><span class="w">               </span><span class="nx">token</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;csrfToken&#39;</span><span class="p">),</span>
</span><span id="L-2328"><a href="#L-2328"><span class="linenos" data-line="2328"></span></a><span class="w">               </span><span class="nx">recreate</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
</span><span id="L-2329"><a href="#L-2329"><span class="linenos" data-line="2329"></span></a><span class="w">               </span><span class="nx">summary</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="nx">frm</span><span class="p">.</span><span class="nx">SandboxSummary</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
</span><span id="L-2330"><a href="#L-2330"><span class="linenos" data-line="2330"></span></a><span class="w">               </span><span class="nx">text</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="nx">frm</span><span class="p">.</span><span class="nx">SandboxText</span><span class="p">.</span><span class="nx">value</span>
</span><span id="L-2331"><a href="#L-2331"><span class="linenos" data-line="2331"></span></a><span class="w">              </span><span class="p">},</span><span class="w">      </span>
</span><span id="L-2332"><a href="#L-2332"><span class="linenos" data-line="2332"></span></a><span class="w">      </span><span class="nx">success</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2333"><a href="#L-2333"><span class="linenos" data-line="2333"></span></a><span class="w">         </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Sandbox page edited!&quot;</span><span class="p">);</span>
</span><span id="L-2334"><a href="#L-2334"><span class="linenos" data-line="2334"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-2335"><a href="#L-2335"><span class="linenos" data-line="2335"></span></a><span class="w">   </span><span class="p">});</span>
</span><span id="L-2336"><a href="#L-2336"><span class="linenos" data-line="2336"></span></a><span class="p">}</span>
</span><span id="L-2337"><a href="#L-2337"><span class="linenos" data-line="2337"></span></a>
</span><span id="L-2338"><a href="#L-2338"><span class="linenos" data-line="2338"></span></a>
</span><span id="L-2339"><a href="#L-2339"><span class="linenos" data-line="2339"></span></a>
</span><span id="L-2340"><a href="#L-2340"><span class="linenos" data-line="2340"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2341"><a href="#L-2341"><span class="linenos" data-line="2341"></span></a><span class="c1">// convenience wrapper function to replace calls to</span>
</span><span id="L-2342"><a href="#L-2342"><span class="linenos" data-line="2342"></span></a><span class="c1">// document.getElementById() </span>
</span><span id="L-2343"><a href="#L-2343"><span class="linenos" data-line="2343"></span></a><span class="c1">// to avoid browser incompatibility</span>
</span><span id="L-2344"><a href="#L-2344"><span class="linenos" data-line="2344"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2345"><a href="#L-2345"><span class="linenos" data-line="2345"></span></a><span class="kd">function</span><span class="w"> </span><span class="nx">fuwGet</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2346"><a href="#L-2346"><span class="linenos" data-line="2346"></span></a><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">target</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">target</span><span class="p">.</span><span class="nx">nodeType</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">target</span><span class="p">;</span>
</span><span id="L-2347"><a href="#L-2347"><span class="linenos" data-line="2347"></span></a><span class="w">   </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2348"><a href="#L-2348"><span class="linenos" data-line="2348"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">target</span><span class="p">);</span>
</span><span id="L-2349"><a href="#L-2349"><span class="linenos" data-line="2349"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">found</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">found</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-2350"><a href="#L-2350"><span class="linenos" data-line="2350"></span></a><span class="w">   </span><span class="p">}</span>
</span><span id="L-2351"><a href="#L-2351"><span class="linenos" data-line="2351"></span></a><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="kc">undefined</span><span class="p">;</span>
</span><span id="L-2352"><a href="#L-2352"><span class="linenos" data-line="2352"></span></a><span class="p">}</span>
</span><span id="L-2353"><a href="#L-2353"><span class="linenos" data-line="2353"></span></a>
</span><span id="L-2354"><a href="#L-2354"><span class="linenos" data-line="2354"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2355"><a href="#L-2355"><span class="linenos" data-line="2355"></span></a><span class="c1">// onload hook function, loading this script</span>
</span><span id="L-2356"><a href="#L-2356"><span class="linenos" data-line="2356"></span></a><span class="c1">// ========================================================</span>
</span><span id="L-2357"><a href="#L-2357"><span class="linenos" data-line="2357"></span></a><span class="nx">mw</span><span class="p">.</span><span class="nx">loader</span><span class="p">.</span><span class="nx">using</span><span class="p">([</span><span class="s1">&#39;mediawiki.api&#39;</span><span class="p">]).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2358"><a href="#L-2358"><span class="linenos" data-line="2358"></span></a><span class="w">   </span><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2359"><a href="#L-2359"><span class="linenos" data-line="2359"></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fuwGet</span><span class="p">(</span><span class="s1">&#39;UploadScriptArea&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2360"><a href="#L-2360"><span class="linenos" data-line="2360"></span></a><span class="w">         </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">fuwGlobal</span><span class="p">();</span>
</span><span id="L-2361"><a href="#L-2361"><span class="linenos" data-line="2361"></span></a><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">fuw</span><span class="p">.</span><span class="nx">disabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-2362"><a href="#L-2362"><span class="linenos" data-line="2362"></span></a><span class="w">            </span><span class="nx">fuwUpdateOptions</span><span class="p">();</span>
</span><span id="L-2363"><a href="#L-2363"><span class="linenos" data-line="2363"></span></a><span class="w">         </span><span class="p">}</span>
</span><span id="L-2364"><a href="#L-2364"><span class="linenos" data-line="2364"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-2365"><a href="#L-2365"><span class="linenos" data-line="2365"></span></a><span class="w">   </span><span class="p">});</span>
</span><span id="L-2366"><a href="#L-2366"><span class="linenos" data-line="2366"></span></a><span class="p">});</span>
</span></pre></div>
<!-- 
NewPP limit report
Parsed by mwâ€web.eqiad.mainâ€79d5875b8câ€dc6pc
Cached time: 20251206030826
Cache expiry: 2235106
Reduced expiry: true
Complications: [noâ€toc]
CPU time usage: 0.084 seconds
Real time usage: 0.117 seconds
Preprocessor visited node count: 426/1000000
Revision size: 95005/2097152 bytes
Postâ€expand include size: 22586/2097152 bytes
Template argument size: 614/2097152 bytes
Highest expansion depth: 12/100
Expensive parser function count: 0/500
Unstrip recursion depth: 0/20
Unstrip postâ€expand size: 8090/5000000 bytes
Lua time usage: 0.022/10.000 seconds
Lua memory usage: 1029625/52428800 bytes
Number of Wikibase entities loaded: 0/500
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   72.347      1 -total
 52.76%   38.167      4 Template:Imbox
 50.56%   36.580      2 Template:PD-because
 17.22%   12.461      1 Template:En
 16.58%   11.996      1 Template:Non-free_biog-pic
  7.67%    5.548      1 Template:Uploader_information
  6.80%    4.923      1 Template:Own
  6.05%    4.377      1 Template:Str_endswith
  4.19%    3.032      1 Template:Tl
  4.11%    2.975      1 Template:PD-author
-->
<noscript><img src="https://en.wikipedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&amp;type=1x1&amp;usesul3=1" alt="" width="1" height="1" style="border: none; position: absolute;"></noscript>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://en.wikipedia.org/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;oldid=1237294272">https://en.wikipedia.org/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;oldid=1237294272</a>"</div></div>
					<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 29 July 2024, at 02:34<span class="anonymous-show">&#160;(UTC)</span>.</li>
	<li id="footer-info-copyright">Text is available under the <a href="/wiki/Wikipedia:Text_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License" title="Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License">Creative Commons Attribution-ShareAlike 4.0 License</a>;
additional terms may apply. By using this site, you agree to the <a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Terms_of_Use" class="extiw" title="foundation:Special:MyLanguage/Policy:Terms of Use">Terms of Use</a> and <a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy" class="extiw" title="foundation:Special:MyLanguage/Policy:Privacy policy">Privacy Policy</a>. WikipediaÂ® is a registered trademark of the <a rel="nofollow" class="external text" href="https://wikimediafoundation.org/">Wikimedia Foundation, Inc.</a>, a non-profit organization.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/Wikipedia:About">About Wikipedia</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/Wikipedia:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-contact"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us">Contact Wikipedia</a></li>
	<li id="footer-places-wm-codeofconduct"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Universal_Code_of_Conduct">Code of Conduct</a></li>
	<li id="footer-places-developers"><a href="https://developer.wikimedia.org">Developers</a></li>
	<li id="footer-places-statslink"><a href="https://stats.wikimedia.org/#/en.wikipedia.org">Statistics</a></li>
	<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Cookie_statement">Cookie statement</a></li>
	<li id="footer-places-mobileview"><a href="//en.wikipedia.org/w/index.php?title=MediaWiki:FileUploadWizard.js&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.wikimedia.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><picture><source media="(min-width: 500px)" srcset="/static/images/footer/wikimedia-button.svg" width="84" height="29"><img src="/static/images/footer/wikimedia.svg" width="25" height="25" alt="Wikimedia Foundation" lang="en" loading="lazy"></picture></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><picture><source media="(min-width: 500px)" srcset="/w/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/w/resources/assets/mediawiki_compact.svg" alt="Powered by MediaWiki" lang="en" width="25" height="25" loading="lazy"></picture></a></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/w/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div  class="cdx-search-input__input-wrapper"  data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input
									class="cdx-text-input__input mw-searchInput" autocomplete="off"
									
									type="search" name="search" placeholder="Search Wikipedia">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true" ><span class="mw-page-title-namespace">MediaWiki</span><span class="mw-page-title-separator">:</span><span class="mw-page-title-main">FileUploadWizard.js</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<button class="cdx-button cdx-button--weight-quiet mw-interlanguage-selector" id="p-lang-btn-sticky-header" tabindex="-1" data-event-name="ui.dropdown-p-lang-btn-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-language mw-ui-icon-wikimedia-wikimedia-language"></span>

<span>Add languages</span>
			</button>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgHostname":"mw-web.eqiad.main-79d5875b8c-dc6pc","wgBackendResponseTime":282,"wgPageParseReport":{"limitreport":{"cputime":"0.084","walltime":"0.117","ppvisitednodes":{"value":426,"limit":1000000},"revisionsize":{"value":95005,"limit":2097152},"postexpandincludesize":{"value":22586,"limit":2097152},"templateargumentsize":{"value":614,"limit":2097152},"expansiondepth":{"value":12,"limit":100},"expensivefunctioncount":{"value":0,"limit":500},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":8090,"limit":5000000},"entityaccesscount":{"value":0,"limit":500},"timingprofile":["100.00%   72.347      1 -total"," 52.76%   38.167      4 Template:Imbox"," 50.56%   36.580      2 Template:PD-because"," 17.22%   12.461      1 Template:En"," 16.58%   11.996      1 Template:Non-free_biog-pic","  7.67%    5.548      1 Template:Uploader_information","  6.80%    4.923      1 Template:Own","  6.05%    4.377      1 Template:Str_endswith","  4.19%    3.032      1 Template:Tl","  4.11%    2.975      1 Template:PD-author"]},"scribunto":{"limitreport-timeusage":{"value":"0.022","limit":"10.000"},"limitreport-memusage":{"value":1029625,"limit":52428800}},"cachereport":{"origin":"mw-web.eqiad.main-79d5875b8c-dc6pc","timestamp":"20251206030826","ttl":2235106,"transientcontent":true}}});});</script>
</body>
</html>